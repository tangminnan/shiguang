<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.shiguang.stock.dao.StockDao">

    <select id="get" resultType="com.shiguang.stock.domain.StockDO">
    select `id`,`goods_num`,`goods_code`,`goods_name`,`goods_count`,`goods_type`,`mfrsid`,`brandname`,`retail_price`,
    `price_sum`,`cost_price`,`cost_sum`,`whole_price`,`whole_sum`,`position_id`,`position_name`,`create_time`,`danju_number`,
    `order_number`,`yundan_number`,`zhidan_people`,`danju_day`,`tuihuo_number`,`factory_number`,`beizhu`,`unit`,
     `batch`,`zhuce_number`,`produce_day`,`useday`,`classtype`,`factory` ,`status`,`username`,`returnzt`
      from stock where id = #{value}
</select>

    <select id="list" resultType="com.shiguang.stock.domain.StockDO">
        select
        s.`id`,s.`goods_num`,s.`goods_code`,s.`goods_name`,s.`goods_count`,s.`goods_type`,s.`mfrsid`,s.`brandname`,s.`retail_price`,
        s.`price_sum`, s.`cost_price`, s.`cost_sum`, s.`whole_price`, s.`whole_sum`,s.`position_id`, s.`position_name`, s.`create_time`,
        s.`danju_number`, s.`order_number`, s.`yundan_number`, s.`zhidan_people`, s.`danju_day`, s.`tuihuo_number`,
        s.`factory_number`, s.`beizhu`, s.`unit`,m.mfrsname,s.`batch`,s.`zhuce_number`,s.`produce_day`,s.`useday`,s.`classtype`,
        s.`factory`,s.`status`,s.`username`,s.`returnzt`
        from stock s left join c_mfrs m on s.mfrsid=m.mfrsid
        <where>
            <if test="id != null and id != ''">and s.id = #{id}</if>
            <if test="goodsNum != null and goodsNum != ''">and s.goods_num = #{goodsNum}</if>
            <if test="goodsCode != null and goodsCode != ''">and s.goods_code = #{goodsCode}</if>
            <if test="goodsName != null and goodsName != ''">and s.goods_name = #{goodsName}</if>
            <if test="goodsCount != null and goodsCount != ''">and s.goods_count = #{goodsCount}</if>
            <if test="goodsType != null and goodsType != ''">and s.goods_type = #{goodsType}</if>
            <if test="mfrsid != null and mfrsid != ''">and s.mfrsid = #{mfrsid}</if>
            <if test="brandname != null and brandname != ''">and s.brandname = #{brandname}</if>
            <if test="retailPrice != null and retailPrice != ''">and s.retail_price = #{retailPrice}</if>
            <if test="priceSum != null and priceSum != ''">and s.price_sum = #{priceSum}</if>
            <if test="costPrice != null and costPrice != ''">and s.cost_price = #{costPrice}</if>
            <if test="costSum != null and costSum != ''">and s.cost_sum = #{costSum}</if>
            <if test="wholePrice != null and wholePrice != ''">and s.whole_price = #{wholePrice}</if>
            <if test="wholeSum != null and wholeSum != ''">and s.whole_sum = #{wholeSum}</if>
            <if test="positionId != null and positionId != ''">and s.position_id = #{positionId}</if>
            <if test="positionName != null and positionName != ''">and s.position_name = #{positionName}</if>
            <if test="createTime != null and createTime != ''">and s.create_time = #{createTime}</if>
            <if test="danjuNumber != null and danjuNumber != ''">and s.danju_number = #{danjuNumber}</if>
            <if test="orderNumber != null and orderNumber != ''">and s.order_number = #{orderNumber}</if>
            <if test="yundanNumber != null and yundanNumber != ''">and s.yundan_number = #{yundanNumber}</if>
            <if test="zhidanPeople != null and zhidanPeople != ''">and s.zhidan_people = #{zhidanPeople}</if>
            <if test="danjuDay != null and danjuDay != ''">and s.danju_day = #{danjuDay}</if>
            <if test="tuihuoNumber != null and tuihuoNumber != ''">and s.tuihuo_number = #{tuihuoNumber}</if>
            <if test="factoryNumber != null and factoryNumber != ''">and s.factory_number = #{factoryNumber}</if>
            <if test="beizhu != null and beizhu != ''">and s.beizhu = #{beizhu}</if>
            <if test="batch != null and batch != ''"> and s.batch = #{batch} </if>
            <if test="zhuceNumber != null and zhuceNumber != ''"> and s.zhuce_number = #{zhuceNumber} </if>
            <if test="produceDay != null and produceDay != ''"> and s.produce_day = #{produceDay} </if>
            <if test="useday != null and useday != ''"> and s.useday = #{useday} </if>
            <if test="classtype != null and classtype != ''"> and s.classtype = #{classtype} </if>
            <if test="factory != null and factory != ''"> and s.factory = #{factory} </if>
            <if test="status != null and status != ''"> and s.status = #{status} </if>
            <if test="username != null and username != ''"> and s.username = #{username} </if>
            <if test="returnzt != null and returnzt != ''"> and s.returnzt = #{returnzt} </if>


            <if test="num != null and num != ''">and s.goods_num LIKE concat(concat('%', #{num}),'%')</if>
            <if test="oldMoney != null and oldMoney != ''">and s.retail_price = #{oldMoney}</if>
            <if test="producNum != null and producNum != ''">and s.goods_num = #{producNum}</if>
        </where>
        <choose>
            <when test="sort != null and sort.trim() != ''">
                order by ${sort} ${order}
            </when>
            <otherwise>
                order by id desc
            </otherwise>
        </choose>
        <if test="offset != null and limit != null">
            limit #{offset}, #{limit}
        </if>
    </select>

    <select id="count" resultType="int">
        select count(*)  from stock s left join c_mfrs m on s.mfrsid=m.mfrsid
        <where>
            <if test="id != null and id != ''">and id = #{id}</if>
            <if test="goodsNum != null and goodsNum != ''">and goods_num = #{goodsNum}</if>
            <if test="goodsCode != null and goodsCode != ''">and goods_code = #{goodsCode}</if>
            <if test="goodsName != null and goodsName != ''">and goods_name = #{goodsName}</if>
            <if test="goodsCount != null and goodsCount != ''">and goods_count = #{goodsCount}</if>
            <if test="goodsType != null and goodsType != ''">and goods_type = #{goodsType}</if>
            <if test="mfrsid != null and mfrsid != ''">and mfrsid = #{mfrsid}</if>
            <if test="brandname != null and brandname != ''">and brandname = #{brandname}</if>
            <if test="retailPrice != null and retailPrice != ''">and retail_price = #{retailPrice}</if>
            <if test="priceSum != null and priceSum != ''">and price_sum = #{priceSum}</if>
            <if test="costPrice != null and costPrice != ''">and cost_price = #{costPrice}</if>
            <if test="costSum != null and costSum != ''">and cost_sum = #{costSum}</if>
            <if test="wholePrice != null and wholePrice != ''">and whole_price = #{wholePrice}</if>
            <if test="wholeSum != null and wholeSum != ''">and whole_sum = #{wholeSum}</if>
            <if test="positionId != null and positionId != ''">and position_id = #{positionId}</if>
            <if test="positionName != null and positionName != ''">and position_name = #{positionName}</if>
            <if test="createTime != null and createTime != ''">and create_time = #{createTime}</if>
            <if test="danjuNumber != null and danjuNumber != ''">and danju_number = #{danjuNumber}</if>
            <if test="orderNumber != null and orderNumber != ''">and order_number = #{orderNumber}</if>
            <if test="yundanNumber != null and yundanNumber != ''">and yundan_number = #{yundanNumber}</if>
            <if test="zhidanPeople != null and zhidanPeople != ''">and zhidan_people = #{zhidanPeople}</if>
            <if test="danjuDay != null and danjuDay != ''">and danju_day = #{danjuDay}</if>
            <if test="tuihuoNumber != null and tuihuoNumber != ''">and tuihuo_number = #{tuihuoNumber}</if>
            <if test="factoryNumber != null and factoryNumber != ''">and factory_number = #{factoryNumber}</if>
            <if test="beizhu != null and beizhu != ''">and beizhu = #{beizhu}</if>
            <if test="batch != null and batch != ''"> and batch = #{batch} </if>
            <if test="zhuceNumber != null and zhuceNumber != ''"> and zhuce_number = #{zhuceNumber} </if>
            <if test="produceDay != null and produceDay != ''"> and produce_day = #{produceDay} </if>
            <if test="useday != null and useday != ''"> and useday = #{useday} </if>
            <if test="classtype != null and classtype != ''"> and classtype = #{classtype} </if>
            <if test="factory != null and factory != ''"> and factory = #{factory} </if>
            <if test="status != null and status != ''"> and status = #{status} </if>
            <if test="username != null and username != ''"> and username = #{username} </if>
            <if test="returnzt != null and returnzt != ''"> and returnzt = #{returnzt} </if>

            <if test="num != null and num != ''">and s.goods_num LIKE concat(concat('%', #{num}),'%')</if>
            <if test="oldMoney != null and oldMoney != ''">and s.retail_price = #{oldMoney}</if>
            <if test="producNum != null and producNum != ''">and s.goods_num = #{producNum}</if>
        </where>
    </select>

    <insert id="save" parameterType="com.shiguang.stock.domain.StockDO" useGeneratedKeys="true" keyProperty="id">
    insert into stock
    (
        `goods_num`,
        `goods_code`,
        `goods_name`,
        `goods_count`,
        `goods_type`,
        `mfrsid`,
        `brandname`,
        `retail_price`,
        `price_sum`,
        `cost_price`,
        `cost_sum`,
        `whole_price`,
        `whole_sum`,
        `position_id`,
        `position_name`,
        `create_time`,
        `danju_number`,
        `order_number`,
        `yundan_number`,
        `zhidan_people`,
        `danju_day`,
        `tuihuo_number`,
        `factory_number`,
        `beizhu`,
        `unit`,
        `batch`,
		`zhuce_number`,
		`produce_day`,
		`useday`,
		`classtype`,
		`factory`,
		`status`,
		`username`,
		`returnzt`,
		`goodsxinxiid`
    )
    values
    (
        #{goodsNum},
        #{goodsCode},
        #{goodsName},
        #{goodsCount},
        #{goodsType},
        #{mfrsid},
        #{brandname},
        #{retailPrice},
        #{priceSum},
        #{costPrice},
        #{costSum},
        #{wholePrice},
        #{wholeSum},
        #{positionId},
        #{positionName},
        #{createTime},
        #{danjuNumber},
        #{orderNumber},
        #{yundanNumber},
        #{zhidanPeople},
        #{danjuDay},
        #{tuihuoNumber},
        #{factoryNumber},
        #{beizhu},
        #{unit},
        #{batch},
		#{zhuceNumber},
		#{produceDay},
		#{useday},
		#{classtype},
		#{factory},
		#{status},
		#{username},
		#{returnzt},
		#{goodsxinxiid}
    )
</insert>

    <update id="update" parameterType="com.shiguang.stock.domain.StockDO">
        update stock
        <set>
            <if test="goodsNum != null">`goods_num` = #{goodsNum},</if>
            <if test="goodsCode != null">`goods_code` = #{goodsCode},</if>
            <if test="goodsName != null">`goods_name` = #{goodsName},</if>
            <if test="goodsCount != null">`goods_count` = #{goodsCount},</if>
            <if test="goodsType != null">`goods_type` = #{goodsType},</if>
            <if test="mfrsid != null">`mfrsid` = #{mfrsid},</if>
            <if test="brandname != null">`brandname` = #{brandname},</if>
            <if test="retailPrice != null">`retail_price` = #{retailPrice},</if>
            <if test="priceSum != null">`price_sum` = #{priceSum},</if>
            <if test="costPrice != null">`cost_price` = #{costPrice},</if>
            <if test="costSum != null">`cost_sum` = #{costSum},</if>
            <if test="wholePrice != null">`whole_price` = #{wholePrice},</if>
            <if test="wholeSum != null">`whole_sum` = #{wholeSum},</if>
            <if test="positionId != null">`position_id` = #{positionId},</if>
            <if test="positionName != null">`position_name` = #{positionName},</if>
            <if test="createTime != null">`create_time` = #{createTime},</if>
            <if test="danjuNumber != null">`danju_number` = #{danjuNumber},</if>
            <if test="orderNumber != null">`order_number` = #{orderNumber},</if>
            <if test="yundanNumber != null">`yundan_number` = #{yundanNumber},</if>
            <if test="zhidanPeople != null">`zhidan_people` = #{zhidanPeople},</if>
            <if test="danjuDay != null">`danju_day` = #{danjuDay},</if>
            <if test="tuihuoNumber != null">`tuihuo_number` = #{tuihuoNumber},</if>
            <if test="factoryNumber != null">`factory_number` = #{factoryNumber},</if>
            <if test="beizhu != null">`beizhu` = #{beizhu},</if>
            <if test="batch != null">`batch` = #{batch}, </if>
            <if test="zhuceNumber != null">`zhuce_number` = #{zhuceNumber}, </if>
            <if test="produceDay != null">`produce_day` = #{produceDay}, </if>
            <if test="useday != null">`useday` = #{useday}, </if>
            <if test="classtype != null">`classtype` = #{classtype},</if>
            <if test="factory != null">`factory` = #{factory}, </if>
            <if test="status != null">`status` = #{status}, </if>
            <if test="username != null">`username` = #{username}, </if>
            <if test="returnzt != null">`returnzt` = #{returnzt} </if>
        </set>
        where goods_num = #{goodsNum}
    </update>
    <update id="updateGoodsCount" parameterType="com.shiguang.stock.domain.StockDO">
        update stock
        <set>
            <if test="goodsCount != null">`goods_count` = #{goodsCount},</if>
            <if test="returnzt != null">`returnzt` = #{returnzt},</if>
            <if test="tuihuoNumber != null">`tuihuo_number` = #{tuihuoNumber},</if>
            <if test="username != null">`username` = #{username} </if>
        </set>
        <where>
            <if test="goodsNum != null and goodsNum != ''">and goods_num = #{goodsNum}</if>
            <if test="positionId != null and positionId != ''">and position_id = #{positionId}</if>
            <if test="goodsCode != null and goodsCode != ''">and goods_code = #{goodsCode}</if>
        </where>
    </update>

    <delete id="remove">
    delete from stock where id = #{value}
    </delete>

    <delete id="batchRemove">
        delete from stock where id in
        <foreach item="id" collection="array" open="(" separator="," close=")">
            #{id}
        </foreach>
    </delete>

    <!-- 查询该条码的库存数量 盘点用 -->
    <select id="getProduceCode" resultType="com.shiguang.stock.domain.StockDO">
    select `id`,`goodsxinxiid`,`goods_num`,`goods_code`,`goods_name`,`goods_count`,`goods_type`,`mfrsid`,`brandname`,`retail_price`,
    `price_sum`,`cost_price`,`cost_sum`,`whole_price`,`whole_sum`,`position_id`,`position_name`,`create_time`,`danju_number`,
    `order_number`,`yundan_number`,`zhidan_people`,`danju_day`,`tuihuo_number`,`factory_number`,`beizhu`,`unit`,
     `batch`,`zhuce_number`,`produce_day`,`useday`,`classtype`,`factory` ,`status`,`username`,`returnzt` from stock
     <where>
         goods_code = #{goodsCode}
         <if test="positionId != null and positionId != ''">and position_id = #{positionId}</if>
         <if test="useday != null and useday != ''">and useday = #{useday}</if>
         and `status` = '0' and goods_count > 0
     </where>
</select>

    <!-- 退款或者删除订单用 -->
    <select id="getProduceCodeCount" resultType="com.shiguang.stock.domain.StockDO">
        select `id`,`goodsxinxiid`,`goods_num`,`goods_code`,`goods_name`,`goods_count`,`goods_type`,`mfrsid`,`brandname`,`retail_price`,
        `price_sum`,`cost_price`,`cost_sum`,`whole_price`,`whole_sum`,`position_id`,`position_name`,`create_time`,`danju_number`,
        `order_number`,`yundan_number`,`zhidan_people`,`danju_day`,`tuihuo_number`,`factory_number`,`beizhu`,`unit`,
        `batch`,`zhuce_number`,`produce_day`,`useday`,`classtype`,`factory` ,`status`,`username`,`returnzt` from stock
        <where>
            goods_code = #{goodsCode}
            <if test="positionId != null and positionId != ''">and position_id = #{positionId}</if>
            and `status` = '0'
        </where>
    </select>

    <!-- 查询该代码的库存数量 -->
    <select id="getProduceNum" resultType="com.shiguang.stock.domain.StockDO">
        select `id`,`goodsxinxiid`,`goods_num`,`goods_code`,`goods_name`,`goods_count`,`goods_type`,`mfrsid`,`brandname`,`retail_price`,
        `price_sum`,`cost_price`,`cost_sum`,`whole_price`,`whole_sum`,`position_id`,`position_name`,`create_time`,`danju_number`,
        `order_number`,`yundan_number`,`zhidan_people`,`danju_day`,`tuihuo_number`,`factory_number`,`beizhu`,`unit`,
        `batch`,`zhuce_number`,`produce_day`,`useday`,`classtype`,`factory` ,`status`,`username`,`returnzt` from stock
        <where>
            goods_num = #{goodsNum}
            <if test="positionId != null and positionId != ''">and position_id = #{positionId}</if>
            and `status` = '0' and goods_count > 0
        </where>
    </select>

    <!-- 镜架查询 -->
    <select id="listJiajia" resultType="com.shiguang.stock.domain.StockDO">
        select
        st.`id`,st.`goods_num`,st.`goods_code`,st.`goods_name`,st.`goods_count`,st.`goods_type`,st.`mfrsid`,st.`brandname`,st.`retail_price`,st.`price_sum`,st.`cost_price`,st.`cost_sum`,st.`whole_price`,
        st.`whole_sum`,st.`position_name`,st.`unit`,st.`batch`,st.`useday`,pr.`produc_factory`,pr.`produc_color`,ac.`materialname`,pr.`size`
        from stock st left join aa_produca pr on pr.produc_num = st.goods_num left join c_material ac on ac.materialid =
        pr.materialid
        <where>
            <if test="id != null and id != ''">and st.id = #{id}</if>
            <if test="goodsNum != null and goodsNum != ''">and st.goods_num like concat('%', #{goodsNum},'%')</if>
            <if test="goodsCode != null and goodsCode != ''">and st.goods_code = #{goodsCode}</if>
            <if test="goodsName != null and goodsName != ''">and st.goods_name like concat('%', #{goodsName},'%')</if>
            <if test="goodsCount != null and goodsCount != ''">and st.goods_count = #{goodsCount}</if>
            <if test="goodsType != null and goodsType != ''">and st.goods_type = #{goodsType}</if>
            <if test="mfrsid != null and mfrsid != ''">and st.mfrsid = #{mfrsid}</if>
            <if test="retailPriceStart != null and retailPriceStart != ''">and ABS(st.retail_price) >= ABS(#{retailPriceStart})</if>
            <if test="retailPriceEnd != null and retailPriceEnd != ''">and ABS(st.retail_price) &lt;= ABS(#{retailPriceEnd})</if>
            <if test="priceSum != null and priceSum != ''">and st.price_sum = #{priceSum}</if>
            <if test="costPrice != null and costPrice != ''">and st.cost_price = #{costPrice}</if>
            <if test="costSum != null and costSum != ''">and st.cost_sum = #{costSum}</if>
            <if test="wholePrice != null and wholePrice != ''">and st.whole_price = #{wholePrice}</if>
            <if test="wholeSum != null and wholeSum != ''">and st.whole_sum = #{wholeSum}</if>
            <if test="positionId != null and positionId != ''">and st.position_id = #{positionId}</if>
            and st.goods_count > 0
        </where>
        <choose>
            <when test="sort != null and sort.trim() != ''">
                order by ${sort} ${order}
            </when>
            <otherwise>
                GROUP BY st.goods_num
                order by st.id desc
            </otherwise>
        </choose>
        <if test="offset != null and limit != null">
            limit #{offset}, #{limit}
        </if>
    </select>

    <select id="countJiajia" resultType="int">
        select count(*) from stock st left join aa_produca pr on pr.produc_num = st.goods_num left join a_caizhi ac on
        ac.caizhi_id = pr.materialid
        <where>
            <if test="id != null and id != ''">and st.id = #{id}</if>
            <if test="goodsNum != null and goodsNum != ''">and st.goods_num like concat('%', #{goodsNum},'%')</if>
            <if test="goodsCode != null and goodsCode != ''">and st.goods_code = #{goodsCode}</if>
            <if test="goodsName != null and goodsName != ''">and st.goods_name like concat('%', #{goodsName},'%')</if>
            <if test="goodsCount != null and goodsCount != ''">and st.goods_count = #{goodsCount}</if>
            <if test="goodsType != null and goodsType != ''">and st.goods_type = #{goodsType}</if>
            <if test="mfrsid != null and mfrsid != ''">and st.mfrsid = #{mfrsid}</if>
            <if test="retailPriceStart != null and retailPriceStart != ''">and ABS(st.retail_price) >= ABS(#{retailPriceStart})</if>
            <if test="retailPriceEnd != null and retailPriceEnd != ''">and ABS(st.retail_price) &lt;= ABS(#{retailPriceEnd})</if>
            <if test="priceSum != null and priceSum != ''">and st.price_sum = #{priceSum}</if>
            <if test="costPrice != null and costPrice != ''">and st.cost_price = #{costPrice}</if>
            <if test="costSum != null and costSum != ''">and st.cost_sum = #{costSum}</if>
            <if test="wholePrice != null and wholePrice != ''">and st.whole_price = #{wholePrice}</if>
            <if test="wholeSum != null and wholeSum != ''">and st.whole_sum = #{wholeSum}</if>
            <if test="positionId != null and positionId != ''">and st.position_id = #{positionId}</if>
            and st.goods_count > 0
        </where>
    </select>

    <!-- 镜片(成品)查询 -->
    <select id="listJpcp" resultType="com.shiguang.stock.domain.StockDO">
        select
        st.`id`,st.`goods_num`,st.`goods_code`,st.`goods_name`,st.`goods_count`,st.`goods_type`,st.`mfrsid`,st.`brandname`,st.`retail_price`,st.`price_sum`,st.`cost_price`,st.`cost_sum`,st.`whole_price`,
        st.`whole_sum`,st.`position_name`,st.`unit`,st.`batch`,st.`classtype`,st.`useday`,	j.sph_id as sph,
        j.cyl_id as cyl,l.`lightbelow`,r.`refractivityvalue`,pl.`light_name`,le.`lens_name`
        from stock st left join aa_jpcp j on j.produc_num = st.goods_num
        left join a_lightbelow l on l.lightbelow_id = j.lightbelow_id left join c_refractivity r on r.refractivityid =
        j.refractivityid
        left join p_light pl on pl.light_id = j.light_id left join p_lens le on le.lens_id = j.lens_id
        <where>
            <if test="id != null and id != ''">and st.id = #{id}</if>
            <if test="goodsNum != null and goodsNum != ''">and st.goods_num like concat('%', #{goodsNum},'%')</if>
            <if test="goodsCode != null and goodsCode != ''">and st.goods_code = #{goodsCode}</if>
            <if test="goodsName != null and goodsName != ''">and st.goods_name like concat('%', #{goodsName},'%')</if>
            <if test="goodsCount != null and goodsCount != ''">and st.goods_count = #{goodsCount}</if>
            <if test="goodsType != null and goodsType != ''">and st.goods_type = #{goodsType}</if>
            <if test="mfrsid != null and mfrsid != ''">and st.mfrsid = #{mfrsid}</if>
            <if test="brandName != null and brandName != ''">and st.brandname = #{brandName}</if>
            <if test="retailPriceStart != null and retailPriceStart != ''">and ABS(st.retail_price) >= ABS(#{retailPriceStart})</if>
            <if test="retailPriceEnd != null and retailPriceEnd != ''">and ABS(st.retail_price) &lt;= ABS(#{retailPriceEnd})</if>
            <if test="priceSum != null and priceSum != ''">and st.price_sum = #{priceSum}</if>
            <if test="costPrice != null and costPrice != ''">and st.cost_price = #{costPrice}</if>
            <if test="costSum != null and costSum != ''">and st.cost_sum = #{costSum}</if>
            <if test="wholePrice != null and wholePrice != ''">and st.whole_price = #{wholePrice}</if>
            <if test="wholeSum != null and wholeSum != ''">and st.whole_sum = #{wholeSum}</if>
            <if test="positionId != null and positionId != ''">and st.position_id = #{positionId}</if>
            <if test="rightYuanYongQJ != null and rightYuanYongQJ != ''">and j.sph_id =  #{rightYuanYongQJ}</if>
            <if test="rightYuanYongZJ != null and rightYuanYongZJ != ''">and j.cyl_id = #{rightYuanYongZJ}</if>
            <if test="leftYuanYongQJ != null and leftYuanYongQJ != ''">and j.sph_id = #{leftYuanYongQJ}</if>
            <if test="leftYuanYongZJ != null and leftYuanYongZJ != ''">and j.cyl_id = #{leftYuanYongZJ}</if>
            <!--<if test="rightYuanYongQJ != null and rightYuanYongQJ != ''">and s.sph like concat('%',-->
                <!--#{rightYuanYongQJ},'%')-->
            <!--</if>-->
            <!--<if test="rightYuanYongZJ != null and rightYuanYongZJ != ''">and c.cyl like concat('%',-->
                <!--#{rightYuanYongZJ},'%')-->
            <!--</if>-->
            <!--<if test="leftYuanYongQJ != null and leftYuanYongQJ != ''">and s.sph like concat('%',-->
                <!--#{leftYuanYongQJ},'%')-->
            <!--</if>-->
            <!--<if test="leftYuanYongZJ != null and leftYuanYongZJ != ''">and c.cyl like concat('%',-->
                <!--#{leftYuanYongZJ},'%')-->
            <!--</if>-->
            and st.goods_count > 0
        </where>
        <choose>
            <when test="sort != null and sort.trim() != ''">
                order by ${sort} ${order}
            </when>
            <otherwise>
                GROUP BY st.goods_name
                order by st.id desc
            </otherwise>
        </choose>
        <if test="offset != null and limit != null">
            limit #{offset}, #{limit}
        </if>
    </select>

    <select id="countJpcp" resultType="int">
        select count(*)
        from stock st left join aa_jpcp j on j.produc_num = st.goods_num
        left join a_lightbelow l on l.lightbelow_id = j.lightbelow_id left join c_refractivity r on r.refractivityid =
        j.refractivityid
        left join p_light pl on pl.light_id = j.light_id left join p_lens le on le.lens_id = j.lens_id
        <where>
            <if test="id != null and id != ''">and st.id = #{id}</if>
            <if test="goodsNum != null and goodsNum != ''">and st.goods_num like concat('%', #{goodsNum},'%')</if>
            <if test="goodsCode != null and goodsCode != ''">and st.goods_code = #{goodsCode}</if>
            <if test="goodsName != null and goodsName != ''">and st.goods_name like concat('%', #{goodsName},'%')</if>
            <if test="goodsCount != null and goodsCount != ''">and st.goods_count = #{goodsCount}</if>
            <if test="goodsType != null and goodsType != ''">and st.goods_type = #{goodsType}</if>
            <if test="mfrsid != null and mfrsid != ''">and st.mfrsid = #{mfrsid}</if>
            <if test="retailPriceStart != null and retailPriceStart != ''">and ABS(st.retail_price) >= ABS(#{retailPriceStart})</if>
            <if test="retailPriceEnd != null and retailPriceEnd != ''">and ABS(st.retail_price) &lt;= ABS(#{retailPriceEnd})</if>
            <if test="priceSum != null and priceSum != ''">and st.price_sum = #{priceSum}</if>
            <if test="costPrice != null and costPrice != ''">and st.cost_price = #{costPrice}</if>
            <if test="costSum != null and costSum != ''">and st.cost_sum = #{costSum}</if>
            <if test="wholePrice != null and wholePrice != ''">and st.whole_price = #{wholePrice}</if>
            <if test="wholeSum != null and wholeSum != ''">and st.whole_sum = #{wholeSum}</if>
            <if test="positionId != null and positionId != ''">and st.position_id = #{positionId}</if>
            <if test="rightYuanYongQJ != null and rightYuanYongQJ != ''">and j.sph_id =  #{rightYuanYongQJ}</if>
            <if test="rightYuanYongZJ != null and rightYuanYongZJ != ''">and j.cyl_id = #{rightYuanYongZJ}</if>
            <if test="leftYuanYongQJ != null and leftYuanYongQJ != ''">and j.sph_id = #{leftYuanYongQJ}</if>
            <if test="leftYuanYongZJ != null and leftYuanYongZJ != ''">and j.cyl_id = #{leftYuanYongZJ}</if>
            and st.goods_count > 0
        </where>
    </select>

    <!-- 镜片(订做)查询 -->
    <select id="listJpdz" resultType="com.shiguang.stock.domain.StockDO">
        select
        j.`id`,j.`produc_num` as goodsNum,j.`produc_code` as goodsCode,j.`produc_name` as goodsName,1 as goodsCount,2 as classtype,j.`mfrsid`,j.`retail_price`,
        u.`unitname` as unit,s.`sph`,c.`cyl`,r.`refractivityvalue`,pl.`light_name`,l.`lens_name`,f.`function_name`,g.`gradual_name`,cb.`brandname`,
        j.`sph_up`,j.`sph_down`,j.`cyl_up`,j.`cyl_down`,j.`lightbelow_right`,j.`lightbelow_left`
        from aa_jpdz j
        join c_brand cb on cb.brandnum = j.brandnum and cb.mfrsid = j.mfrsid
        left join a_sph s on s.sph_id = j.sph_id left join a_cyl c on c.cyl_id = j.cyl_id
        left join c_unit u on u.unitid = j.unitid
        left join c_refractivity r on r.refractivityid = j.refractivityid
        left join p_light pl on pl.light_id = j.light_id
        left join p_lens l on l.lens_id = j.lens_id
        left join p_gradual g on g.gradual_id = j.gradual_id
        left join p_function f on f.function_id = j.function_id
        <where>
            <if test="id != null and id != ''">and st.id = #{id}</if>
            <if test="goodsNum != null and goodsNum != ''">and j.`produc_num` like concat('%', #{goodsNum},'%')</if>
            <if test="goodsCode != null and goodsCode != ''">and j.`produc_code` = #{goodsCode}</if>
            <if test="goodsName != null and goodsName != ''">and j.`produc_name` like concat('%', #{goodsName},'%')</if>
            <if test="mfrsid != null and mfrsid != ''">and j.mfrsid = #{mfrsid}</if>
            <if test="retailPriceStart != null and retailPriceStart != ''">and ABS(j.retail_price) >= ABS(#{retailPriceStart})</if>
            <if test="retailPriceEnd != null and retailPriceEnd != ''">and ABS(j.retail_price) &lt;= ABS(#{retailPriceEnd})</if>
            and j.`state` = 1
            <!--<if test="rightYuanYongQJ != null and rightYuanYongQJ != ''">and j.sph_up &lt;= #{rightYuanYongQJ}</if>-->
            <!--<if test="rightYuanYongQJ != null and rightYuanYongQJ != ''">and j.sph_down &gt;= #{rightYuanYongQJ}</if>-->
            <!--<if test="rightYuanYongZJ != null and rightYuanYongZJ != ''">and ABS(j.cyl_up) &gt;= ABS(#{rightYuanYongZJ})</if>-->
            <!--<if test="rightYuanYongZJ != null and rightYuanYongZJ != ''">and ABS(j.cyl_down) &lt;= ABS(#{rightYuanYongZJ})</if>-->
            <!--<if test="leftYuanYongQJ != null and leftYuanYongQJ != ''">and j.sph_up &lt;= #{leftYuanYongQJ}</if>-->
            <!--<if test="leftYuanYongQJ != null and leftYuanYongQJ != ''">and j.sph_down &gt;= #{leftYuanYongQJ}</if>-->
            <!--<if test="leftYuanYongZJ != null and leftYuanYongZJ != ''">and ABS(j.cyl_up) &gt;= ABS(#{leftYuanYongZJ})</if>-->
            <!--<if test="leftYuanYongZJ != null and leftYuanYongZJ != ''">and ABS(j.cyl_down) &lt;= ABS(#{leftYuanYongZJ})</if>-->
            <!--<if test="rightYuanYongQJ != null and rightYuanYongQJ != ''">and s.sph like concat('%',-->
                <!--#{rightYuanYongQJ},'%')-->
            <!--</if>-->
            <!--<if test="rightYuanYongZJ != null and rightYuanYongZJ != ''">and c.cyl like concat('%',-->
                <!--#{rightYuanYongZJ},'%')-->
            <!--</if>-->
            <!--<if test="leftYuanYongQJ != null and leftYuanYongQJ != ''">and s.sph like concat('%',-->
                <!--#{leftYuanYongQJ},'%')-->
            <!--</if>-->
            <!--<if test="leftYuanYongZJ != null and leftYuanYongZJ != ''">and c.cyl like concat('%',-->
                <!--#{leftYuanYongZJ},'%')-->
            <!--</if>-->
        </where>
        <choose>
            <when test="sort != null and sort.trim() != ''">
                order by ${sort} ${order}
            </when>
            <otherwise>
                order by j.id desc
            </otherwise>
        </choose>
        <if test="offset != null and limit != null">
            limit #{offset}, #{limit}
        </if>
    </select>

    <select id="countJpdz" resultType="int">
        select count(*)
        from aa_jpdz j
        join c_brand cb on cb.brandnum = j.brandnum and cb.mfrsid = j.mfrsid
        left join a_sph s on s.sph_id = j.sph_id left join a_cyl c on c.cyl_id = j.cyl_id
        left join c_unit u on u.unitid = j.unitid
        left join c_refractivity r on r.refractivityid = j.refractivityid
        left join p_light pl on pl.light_id = j.light_id
        left join p_lens l on l.lens_id = j.lens_id
        left join p_gradual g on g.gradual_id = j.gradual_id
        left join p_function f on f.function_id = j.function_id
        <where>
            <if test="id != null and id != ''">and st.id = #{id}</if>
            <if test="goodsNum != null and goodsNum != ''">and j.`produc_num` like concat('%', #{goodsNum},'%')</if>
            <if test="goodsCode != null and goodsCode != ''">and j.`produc_code` = #{goodsCode}</if>
            <if test="goodsName != null and goodsName != ''">and j.`produc_name` like concat('%', #{goodsName},'%')</if>
            <if test="mfrsid != null and mfrsid != ''">and j.mfrsid = #{mfrsid}</if>
            <if test="retailPriceStart != null and retailPriceStart != ''">and ABS(j.retail_price) >= ABS(#{retailPriceStart})</if>
            <if test="retailPriceEnd != null and retailPriceEnd != ''">and ABS(j.retail_price) &lt;= ABS(#{retailPriceEnd})</if>
            and j.`state` = 1
            <!--<if test="rightYuanYongQJ != null and rightYuanYongQJ != ''">and j.sph_up &lt;= #{rightYuanYongQJ}</if>-->
            <!--<if test="rightYuanYongQJ != null and rightYuanYongQJ != ''">and j.sph_down &gt;= #{rightYuanYongQJ}</if>-->
            <!--<if test="rightYuanYongZJ != null and rightYuanYongZJ != ''">and ABS(j.cyl_up) &gt;= ABS(#{rightYuanYongZJ})</if>-->
            <!--<if test="rightYuanYongZJ != null and rightYuanYongZJ != ''">and ABS(j.cyl_down) &lt;= ABS(#{rightYuanYongZJ})</if>-->
            <!--<if test="leftYuanYongQJ != null and leftYuanYongQJ != ''">and j.sph_up &lt;= #{leftYuanYongQJ}</if>-->
            <!--<if test="leftYuanYongQJ != null and leftYuanYongQJ != ''">and j.sph_down &gt;= #{leftYuanYongQJ}</if>-->
            <!--<if test="leftYuanYongZJ != null and leftYuanYongZJ != ''">and ABS(j.cyl_up) &gt;= ABS(#{leftYuanYongZJ})</if>-->
            <!--<if test="leftYuanYongZJ != null and leftYuanYongZJ != ''">and ABS(j.cyl_down) &lt;= ABS(#{leftYuanYongZJ})</if>-->
            <!--<if test="rightYuanYongQJ != null and rightYuanYongQJ != ''">and s.sph like concat('%',-->
            <!--#{rightYuanYongQJ},'%')-->
            <!--</if>-->
            <!--<if test="rightYuanYongZJ != null and rightYuanYongZJ != ''">and c.cyl like concat('%',-->
            <!--#{rightYuanYongZJ},'%')-->
            <!--</if>-->
            <!--<if test="leftYuanYongQJ != null and leftYuanYongQJ != ''">and s.sph like concat('%',-->
            <!--#{leftYuanYongQJ},'%')-->
            <!--</if>-->
            <!--<if test="leftYuanYongZJ != null and leftYuanYongZJ != ''">and c.cyl like concat('%',-->
            <!--#{leftYuanYongZJ},'%')-->
            <!--</if>-->
        </where>
    </select>

    <!-- 镜架配件查询 -->
    <select id="listJiajiapj" resultType="com.shiguang.stock.domain.StockDO">
        select
        st.`id`,st.`goods_num`,st.`goods_code`,st.`goods_name`,st.`goods_count`,st.`goods_type`,st.`mfrsid`,st.`brandname`,st.`retail_price`,st.`price_sum`,st.`cost_price`,st.`cost_sum`,st.`whole_price`,
        st.`whole_sum`,st.`position_name`,st.`unit`,st.`batch`,st.`useday`,pr.`produc_factory`,pr.`parts_style`
        from stock st left join aa_parts pr on pr.produc_num = st.goods_num
        <where>
            <if test="partsStyle != null and partsStyle != ''">and pr.parts_style = #{partsStyle}</if>
            <if test="id != null and id != ''">and st.id = #{id}</if>
            <if test="goodsNum != null and goodsNum != ''">and st.goods_num like concat('%', #{goodsNum},'%')</if>
            <if test="goodsCode != null and goodsCode != ''">and st.goods_code = #{goodsCode}</if>
            <if test="goodsName != null and goodsName != ''">and st.goods_name like concat('%', #{goodsName},'%')</if>
            <if test="goodsCount != null and goodsCount != ''">and st.goods_count = #{goodsCount}</if>
            <if test="goodsType != null and goodsType != ''">and st.goods_type = #{goodsType}</if>
            <if test="mfrsid != null and mfrsid != ''">and st.mfrsid = #{mfrsid}</if>
            <if test="retailPriceStart != null and retailPriceStart != ''">and ABS(st.retail_price) >= ABS(#{retailPriceStart})</if>
            <if test="retailPriceEnd != null and retailPriceEnd != ''">and ABS(st.retail_price) &lt;= ABS(#{retailPriceEnd})</if>
            <if test="priceSum != null and priceSum != ''">and st.price_sum = #{priceSum}</if>
            <if test="costPrice != null and costPrice != ''">and st.cost_price = #{costPrice}</if>
            <if test="costSum != null and costSum != ''">and st.cost_sum = #{costSum}</if>
            <if test="wholePrice != null and wholePrice != ''">and st.whole_price = #{wholePrice}</if>
            <if test="wholeSum != null and wholeSum != ''">and st.whole_sum = #{wholeSum}</if>
            <if test="positionId != null and positionId != ''">and st.position_id = #{positionId}</if>
            and st.goods_count > 0
        </where>
        <choose>
            <when test="sort != null and sort.trim() != ''">
                order by ${sort} ${order}
            </when>
            <otherwise>
                GROUP BY st.goods_name
                order by st.id desc
            </otherwise>
        </choose>
        <if test="offset != null and limit != null">
            limit #{offset}, #{limit}
        </if>
    </select>

    <select id="countJiajiapj" resultType="int">
        select count(*) from stock st left join aa_parts pr on pr.produc_num = st.goods_num and pr.parts_style = '框镜'
        <where>
            <if test="partsStyle != null and partsStyle != ''">and pr.parts_style = #{partsStyle}</if>
            <if test="id != null and id != ''">and st.id = #{id}</if>
            <if test="goodsNum != null and goodsNum != ''">and st.goods_num like concat('%', #{goodsNum},'%')</if>
            <if test="goodsCode != null and goodsCode != ''">and st.goods_code = #{goodsCode}</if>
            <if test="goodsName != null and goodsName != ''">and st.goods_name like concat('%', #{goodsName},'%')</if>
            <if test="goodsCount != null and goodsCount != ''">and st.goods_count = #{goodsCount}</if>
            <if test="goodsType != null and goodsType != ''">and st.goods_type = #{goodsType}</if>
            <if test="mfrsid != null and mfrsid != ''">and st.mfrsid = #{mfrsid}</if>
            <if test="retailPriceStart != null and retailPriceStart != ''">and ABS(st.retail_price) >= ABS(#{retailPriceStart})</if>
            <if test="retailPriceEnd != null and retailPriceEnd != ''">and ABS(st.retail_price) &lt;= ABS(#{retailPriceEnd})</if>
            <if test="priceSum != null and priceSum != ''">and st.price_sum = #{priceSum}</if>
            <if test="costPrice != null and costPrice != ''">and st.cost_price = #{costPrice}</if>
            <if test="costSum != null and costSum != ''">and st.cost_sum = #{costSum}</if>
            <if test="wholePrice != null and wholePrice != ''">and st.whole_price = #{wholePrice}</if>
            <if test="wholeSum != null and wholeSum != ''">and st.whole_sum = #{wholeSum}</if>
            <if test="positionId != null and positionId != ''">and st.position_id = #{positionId}</if>
            and st.goods_count > 0
        </where>
    </select>

    <!-- 太阳镜查询 -->
    <select id="listTaiyj" resultType="com.shiguang.stock.domain.StockDO">
        select
        st.`id`,st.`goods_num`,st.`goods_code`,st.`goods_name`,st.`goods_count`,st.`goods_type`,st.`mfrsid`,st.`brandname`,st.`retail_price`,st.`price_sum`,st.`cost_price`,st.`cost_sum`,st.`whole_price`,
        st.`whole_sum`,st.`position_name`,st.`unit`,st.`batch`,st.`useday`,pr.`produc_factory`,pr.`produc_color`,pr.`size`
        from stock st left join aa_tyj pr on pr.produc_num = st.goods_num
        <where>
            <if test="id != null and id != ''">and st.id = #{id}</if>
            <if test="goodsNum != null and goodsNum != ''">and st.goods_num like concat('%', #{goodsNum},'%')</if>
            <if test="goodsCode != null and goodsCode != ''">and st.goods_code = #{goodsCode}</if>
            <if test="goodsName != null and goodsName != ''">and st.goods_name like concat('%', #{goodsName},'%')</if>
            <if test="goodsCount != null and goodsCount != ''">and st.goods_count = #{goodsCount}</if>
            <if test="goodsType != null and goodsType != ''">and st.goods_type = #{goodsType}</if>
            <if test="mfrsid != null and mfrsid != ''">and st.mfrsid = #{mfrsid}</if>
            <if test="retailPriceStart != null and retailPriceStart != ''">and ABS(st.retail_price) >= ABS(#{retailPriceStart})</if>
            <if test="retailPriceEnd != null and retailPriceEnd != ''">and ABS(st.retail_price) &lt;= ABS(#{retailPriceEnd})</if>
            <if test="priceSum != null and priceSum != ''">and st.price_sum = #{priceSum}</if>
            <if test="costPrice != null and costPrice != ''">and st.cost_price = #{costPrice}</if>
            <if test="costSum != null and costSum != ''">and st.cost_sum = #{costSum}</if>
            <if test="wholePrice != null and wholePrice != ''">and st.whole_price = #{wholePrice}</if>
            <if test="wholeSum != null and wholeSum != ''">and st.whole_sum = #{wholeSum}</if>
            <if test="positionId != null and positionId != ''">and st.position_id = #{positionId}</if>
            and st.goods_count > 0
        </where>
        <choose>
            <when test="sort != null and sort.trim() != ''">
                order by ${sort} ${order}
            </when>
            <otherwise>
                GROUP BY st.goods_name
                order by st.id desc
            </otherwise>
        </choose>
        <if test="offset != null and limit != null">
            limit #{offset}, #{limit}
        </if>
    </select>

    <select id="countTaiyj" resultType="int">
        select count(*) from stock st left join aa_tyj pr on pr.produc_num = st.goods_num
        <where>
            <if test="id != null and id != ''">and st.id = #{id}</if>
            <if test="goodsNum != null and goodsNum != ''">and st.goods_num like concat('%', #{goodsNum},'%')</if>
            <if test="goodsCode != null and goodsCode != ''">and st.goods_code = #{goodsCode}</if>
            <if test="goodsName != null and goodsName != ''">and st.goods_name like concat('%', #{goodsName},'%')</if>
            <if test="goodsCount != null and goodsCount != ''">and st.goods_count = #{goodsCount}</if>
            <if test="goodsType != null and goodsType != ''">and st.goods_type = #{goodsType}</if>
            <if test="mfrsid != null and mfrsid != ''">and st.mfrsid = #{mfrsid}</if>
            <if test="retailPriceStart != null and retailPriceStart != ''">and ABS(st.retail_price) >= ABS(#{retailPriceStart})</if>
            <if test="retailPriceEnd != null and retailPriceEnd != ''">and ABS(st.retail_price) &lt;= ABS(#{retailPriceEnd})</if>
            <if test="priceSum != null and priceSum != ''">and st.price_sum = #{priceSum}</if>
            <if test="costPrice != null and costPrice != ''">and st.cost_price = #{costPrice}</if>
            <if test="costSum != null and costSum != ''">and st.cost_sum = #{costSum}</if>
            <if test="wholePrice != null and wholePrice != ''">and st.whole_price = #{wholePrice}</if>
            <if test="wholeSum != null and wholeSum != ''">and st.whole_sum = #{wholeSum}</if>
            <if test="positionId != null and positionId != ''">and st.position_id = #{positionId}</if>
            and st.goods_count > 0
        </where>
    </select>

    <!-- 耗材查询 -->
    <select id="listHaocai" resultType="com.shiguang.stock.domain.StockDO">
        select
        st.`id`,st.`goods_num`,st.`goods_code`,st.`goods_name`,st.`goods_count`,st.`goods_type`,st.`mfrsid`,st.`brandname`,st.`retail_price`,st.`price_sum`,st.`cost_price`,st.`cost_sum`,st.`whole_price`,
        st.`whole_sum`,st.`position_name`,st.`unit`,st.`useday`,st.`batch`
        from stock st left join aa_hc pr on pr.produc_num = st.goods_num
        <where>
            <if test="id != null and id != ''">and st.id = #{id}</if>
            <if test="goodsNum != null and goodsNum != ''">and st.goods_num like concat('%', #{goodsNum},'%')</if>
            <if test="goodsCode != null and goodsCode != ''">and st.goods_code = #{goodsCode}</if>
            <if test="goodsName != null and goodsName != ''">and st.goods_name like concat('%', #{goodsName},'%')</if>
            <if test="goodsCount != null and goodsCount != ''">and st.goods_count = #{goodsCount}</if>
            <if test="goodsType != null and goodsType != ''">and st.goods_type = #{goodsType}</if>
            <if test="mfrsid != null and mfrsid != ''">and st.mfrsid = #{mfrsid}</if>
            <if test="retailPriceStart != null and retailPriceStart != ''">and ABS(st.retail_price) >= ABS(#{retailPriceStart})</if>
            <if test="retailPriceEnd != null and retailPriceEnd != ''">and ABS(st.retail_price) &lt;= ABS(#{retailPriceEnd})</if>
            <if test="priceSum != null and priceSum != ''">and st.price_sum = #{priceSum}</if>
            <if test="costPrice != null and costPrice != ''">and st.cost_price = #{costPrice}</if>
            <if test="costSum != null and costSum != ''">and st.cost_sum = #{costSum}</if>
            <if test="wholePrice != null and wholePrice != ''">and st.whole_price = #{wholePrice}</if>
            <if test="wholeSum != null and wholeSum != ''">and st.whole_sum = #{wholeSum}</if>
            <if test="positionId != null and positionId != ''">and st.position_id = #{positionId}</if>
            and st.goods_count > 0
        </where>
        <choose>
            <when test="sort != null and sort.trim() != ''">
                order by ${sort} ${order}
            </when>
            <otherwise>
                GROUP BY st.goods_name
                order by st.id desc
            </otherwise>
        </choose>
        <if test="offset != null and limit != null">
            limit #{offset}, #{limit}
        </if>
    </select>

    <select id="countHaocai" resultType="int">
        select count(*) from stock st left join aa_hc pr on pr.produc_num = st.goods_num
        <where>
            <if test="id != null and id != ''">and st.id = #{id}</if>
            <if test="goodsNum != null and goodsNum != ''">and st.goods_num like concat('%', #{goodsNum},'%')</if>
            <if test="goodsCode != null and goodsCode != ''">and st.goods_code = #{goodsCode}</if>
            <if test="goodsName != null and goodsName != ''">and st.goods_name like concat('%', #{goodsName},'%')</if>
            <if test="goodsCount != null and goodsCount != ''">and st.goods_count = #{goodsCount}</if>
            <if test="goodsType != null and goodsType != ''">and st.goods_type = #{goodsType}</if>
            <if test="mfrsid != null and mfrsid != ''">and st.mfrsid = #{mfrsid}</if>
            <if test="retailPriceStart != null and retailPriceStart != ''">and ABS(st.retail_price) >= ABS(#{retailPriceStart})</if>
            <if test="retailPriceEnd != null and retailPriceEnd != ''">and ABS(st.retail_price) &lt;= ABS(#{retailPriceEnd})</if>
            <if test="priceSum != null and priceSum != ''">and st.price_sum = #{priceSum}</if>
            <if test="costPrice != null and costPrice != ''">and st.cost_price = #{costPrice}</if>
            <if test="costSum != null and costSum != ''">and st.cost_sum = #{costSum}</if>
            <if test="wholePrice != null and wholePrice != ''">and st.whole_price = #{wholePrice}</if>
            <if test="wholeSum != null and wholeSum != ''">and st.whole_sum = #{wholeSum}</if>
            <if test="positionId != null and positionId != ''">and st.position_id = #{positionId}</if>
            and st.goods_count > 0
        </where>
    </select>

    <!-- 老花镜查询 -->
    <select id="listLaohj" resultType="com.shiguang.stock.domain.StockDO">
        select
        st.`id`,st.`goods_num`,st.`goods_code`,st.`goods_name`,st.`goods_count`,st.`goods_type`,st.`mfrsid`,st.`brandname`,st.`retail_price`,st.`price_sum`,st.`cost_price`,st.`cost_sum`,st.`whole_price`,
        st.`whole_sum`,st.`position_name`,st.`unit`,st.`useday`,st.`batch`
        from stock st left join aa_oldlens pr on pr.produc_num = st.goods_num
        <where>
            <if test="id != null and id != ''">and st.id = #{id}</if>
            <if test="goodsNum != null and goodsNum != ''">and st.goods_num like concat('%', #{goodsNum},'%')</if>
            <if test="goodsCode != null and goodsCode != ''">and st.goods_code = #{goodsCode}</if>
            <if test="goodsName != null and goodsName != ''">and st.goods_name like concat('%', #{goodsName},'%')</if>
            <if test="goodsCount != null and goodsCount != ''">and st.goods_count = #{goodsCount}</if>
            <if test="goodsType != null and goodsType != ''">and st.goods_type = #{goodsType}</if>
            <if test="mfrsid != null and mfrsid != ''">and st.mfrsid = #{mfrsid}</if>
            <if test="retailPriceStart != null and retailPriceStart != ''">and ABS(st.retail_price) >= ABS(#{retailPriceStart})</if>
            <if test="retailPriceEnd != null and retailPriceEnd != ''">and ABS(st.retail_price) &lt;= ABS(#{retailPriceEnd})</if>
            <if test="priceSum != null and priceSum != ''">and st.price_sum = #{priceSum}</if>
            <if test="costPrice != null and costPrice != ''">and st.cost_price = #{costPrice}</if>
            <if test="costSum != null and costSum != ''">and st.cost_sum = #{costSum}</if>
            <if test="wholePrice != null and wholePrice != ''">and st.whole_price = #{wholePrice}</if>
            <if test="wholeSum != null and wholeSum != ''">and st.whole_sum = #{wholeSum}</if>
            <if test="positionId != null and positionId != ''">and st.position_id = #{positionId}</if>
            and st.goods_count > 0
        </where>
        <choose>
            <when test="sort != null and sort.trim() != ''">
                order by ${sort} ${order}
            </when>
            <otherwise>
                GROUP BY st.goods_name
                order by st.id desc
            </otherwise>
        </choose>
        <if test="offset != null and limit != null">
            limit #{offset}, #{limit}
        </if>
    </select>

    <select id="countLaohj" resultType="int">
        select count(*) from stock st left join aa_hc pr on pr.produc_num = st.goods_num
        <where>
            <if test="id != null and id != ''">and st.id = #{id}</if>
            <if test="goodsNum != null and goodsNum != ''">and st.goods_num like concat('%', #{goodsNum},'%')</if>
            <if test="goodsCode != null and goodsCode != ''">and st.goods_code = #{goodsCode}</if>
            <if test="goodsName != null and goodsName != ''">and st.goods_name like concat('%', #{goodsName},'%')</if>
            <if test="goodsCount != null and goodsCount != ''">and st.goods_count = #{goodsCount}</if>
            <if test="goodsType != null and goodsType != ''">and st.goods_type = #{goodsType}</if>
            <if test="mfrsid != null and mfrsid != ''">and st.mfrsid = #{mfrsid}</if>
            <if test="retailPriceStart != null and retailPriceStart != ''">and ABS(st.retail_price) >= ABS(#{retailPriceStart})</if>
            <if test="retailPriceEnd != null and retailPriceEnd != ''">and ABS(st.retail_price) &lt;= ABS(#{retailPriceEnd})</if>
            <if test="priceSum != null and priceSum != ''">and st.price_sum = #{priceSum}</if>
            <if test="costPrice != null and costPrice != ''">and st.cost_price = #{costPrice}</if>
            <if test="costSum != null and costSum != ''">and st.cost_sum = #{costSum}</if>
            <if test="wholePrice != null and wholePrice != ''">and st.whole_price = #{wholePrice}</if>
            <if test="wholeSum != null and wholeSum != ''">and st.whole_sum = #{wholeSum}</if>
            <if test="positionId != null and positionId != ''">and st.position_id = #{positionId}</if>
            and st.goods_count > 0
        </where>
    </select>

    <!-- 视光查询 -->
    <select id="listShiguang" resultType="com.shiguang.stock.domain.StockDO">
        select
        st.`id`,st.`goods_num`,st.`goods_code`,st.`goods_name`,st.`goods_count`,st.`goods_type`,st.`mfrsid`,st.`brandname`,st.`retail_price`,st.`price_sum`,st.`cost_price`,st.`cost_sum`,st.`whole_price`,
        st.`whole_sum`,st.`position_name`,st.`unit`,st.`batch`,st.`useday`,pr.`produc_factory`
        from stock st left join aa_shiguang pr on pr.produc_num = st.goods_num
        <where>
            <if test="id != null and id != ''">and st.id = #{id}</if>
            <if test="goodsNum != null and goodsNum != ''">and st.goods_num like concat('%', #{goodsNum},'%')</if>
            <if test="goodsCode != null and goodsCode != ''">and st.goods_code = #{goodsCode}</if>
            <if test="goodsName != null and goodsName != ''">and st.goods_name like concat('%', #{goodsName},'%')</if>
            <if test="goodsCount != null and goodsCount != ''">and st.goods_count = #{goodsCount}</if>
            <if test="goodsType != null and goodsType != ''">and st.goods_type = #{goodsType}</if>
            <if test="mfrsid != null and mfrsid != ''">and st.mfrsid = #{mfrsid}</if>
            <if test="retailPriceStart != null and retailPriceStart != ''">and ABS(st.retail_price) >= ABS(#{retailPriceStart})</if>
            <if test="retailPriceEnd != null and retailPriceEnd != ''">and ABS(st.retail_price) &lt;= ABS(#{retailPriceEnd})</if>
            <if test="priceSum != null and priceSum != ''">and st.price_sum = #{priceSum}</if>
            <if test="costPrice != null and costPrice != ''">and st.cost_price = #{costPrice}</if>
            <if test="costSum != null and costSum != ''">and st.cost_sum = #{costSum}</if>
            <if test="wholePrice != null and wholePrice != ''">and st.whole_price = #{wholePrice}</if>
            <if test="wholeSum != null and wholeSum != ''">and st.whole_sum = #{wholeSum}</if>
            <if test="positionId != null and positionId != ''">and st.position_id = #{positionId}</if>
            and st.goods_count > 0
        </where>
        <choose>
            <when test="sort != null and sort.trim() != ''">
                order by ${sort} ${order}
            </when>
            <otherwise>
                order by st.id desc
            </otherwise>
        </choose>
        <if test="offset != null and limit != null">
            limit #{offset}, #{limit}
        </if>
    </select>

    <select id="countShiguang" resultType="int">
        select count(*) from stock st left join aa_shiguang pr on pr.produc_num = st.goods_num
        <where>
            <if test="id != null and id != ''">and st.id = #{id}</if>
            <if test="goodsNum != null and goodsNum != ''">and st.goods_num like concat('%', #{goodsNum},'%')</if>
            <if test="goodsCode != null and goodsCode != ''">and st.goods_code = #{goodsCode}</if>
            <if test="goodsName != null and goodsName != ''">and st.goods_name like concat('%', #{goodsName},'%')</if>
            <if test="goodsCount != null and goodsCount != ''">and st.goods_count = #{goodsCount}</if>
            <if test="goodsType != null and goodsType != ''">and st.goods_type = #{goodsType}</if>
            <if test="mfrsid != null and mfrsid != ''">and st.mfrsid = #{mfrsid}</if>
            <if test="retailPriceStart != null and retailPriceStart != ''">and ABS(st.retail_price) >= ABS(#{retailPriceStart})</if>
            <if test="retailPriceEnd != null and retailPriceEnd != ''">and ABS(st.retail_price) &lt;= ABS(#{retailPriceEnd})</if>
            <if test="priceSum != null and priceSum != ''">and st.price_sum = #{priceSum}</if>
            <if test="costPrice != null and costPrice != ''">and st.cost_price = #{costPrice}</if>
            <if test="costSum != null and costSum != ''">and st.cost_sum = #{costSum}</if>
            <if test="wholePrice != null and wholePrice != ''">and st.whole_price = #{wholePrice}</if>
            <if test="wholeSum != null and wholeSum != ''">and st.whole_sum = #{wholeSum}</if>
            <if test="positionId != null and positionId != ''">and st.position_id = #{positionId}</if>
            and st.goods_count > 0
        </where>
    </select>

    <!-- 视光订做查询 -->
    <select id="listShiguangdz" resultType="com.shiguang.stock.domain.StockDO">
        select
        st.`id`,st.`goods_num`,st.`goods_code`,st.`goods_name`,st.`goods_count`,st.`goods_type`,st.`mfrsid`,st.`brandname`,st.`retail_price`,st.`price_sum`,st.`cost_price`,st.`cost_sum`,st.`whole_price`,
        st.`whole_sum`,st.`position_name`,st.`unit`,st.`batch`,st.`useday`,pr.`produc_factory`
        from stock st left join aa_shiguangdz pr on pr.produc_num = st.goods_num
        <where>
            <if test="id != null and id != ''">and st.id = #{id}</if>
            <if test="goodsNum != null and goodsNum != ''">and st.goods_num like concat('%', #{goodsNum},'%')</if>
            <if test="goodsCode != null and goodsCode != ''">and st.goods_code = #{goodsCode}</if>
            <if test="goodsName != null and goodsName != ''">and st.goods_name like concat('%', #{goodsName},'%')</if>
            <if test="goodsCount != null and goodsCount != ''">and st.goods_count = #{goodsCount}</if>
            <if test="goodsType != null and goodsType != ''">and st.goods_type = #{goodsType}</if>
            <if test="mfrsid != null and mfrsid != ''">and st.mfrsid = #{mfrsid}</if>
            <if test="retailPriceStart != null and retailPriceStart != ''">and ABS(st.retail_price) >= ABS(#{retailPriceStart})</if>
            <if test="retailPriceEnd != null and retailPriceEnd != ''">and ABS(st.retail_price) &lt;= ABS(#{retailPriceEnd})</if>
            <if test="priceSum != null and priceSum != ''">and st.price_sum = #{priceSum}</if>
            <if test="costPrice != null and costPrice != ''">and st.cost_price = #{costPrice}</if>
            <if test="costSum != null and costSum != ''">and st.cost_sum = #{costSum}</if>
            <if test="wholePrice != null and wholePrice != ''">and st.whole_price = #{wholePrice}</if>
            <if test="wholeSum != null and wholeSum != ''">and st.whole_sum = #{wholeSum}</if>
            <if test="positionId != null and positionId != ''">and st.position_id = #{positionId}</if>
            and st.goods_count > 0
        </where>
        <choose>
            <when test="sort != null and sort.trim() != ''">
                order by ${sort} ${order}
            </when>
            <otherwise>
                order by st.id desc
            </otherwise>
        </choose>
        <if test="offset != null and limit != null">
            limit #{offset}, #{limit}
        </if>
    </select>

    <select id="countShiguangdz" resultType="int">
        select count(*) from stock st left join aa_shiguangdz pr on pr.produc_num = st.goods_num
        <where>
            <if test="id != null and id != ''">and st.id = #{id}</if>
            <if test="goodsNum != null and goodsNum != ''">and st.goods_num like concat('%', #{goodsNum},'%')</if>
            <if test="goodsCode != null and goodsCode != ''">and st.goods_code = #{goodsCode}</if>
            <if test="goodsName != null and goodsName != ''">and st.goods_name like concat('%', #{goodsName},'%')</if>
            <if test="goodsCount != null and goodsCount != ''">and st.goods_count = #{goodsCount}</if>
            <if test="goodsType != null and goodsType != ''">and st.goods_type = #{goodsType}</if>
            <if test="mfrsid != null and mfrsid != ''">and st.mfrsid = #{mfrsid}</if>
            <if test="retailPriceStart != null and retailPriceStart != ''">and ABS(st.retail_price) >= ABS(#{retailPriceStart})</if>
            <if test="retailPriceEnd != null and retailPriceEnd != ''">and ABS(st.retail_price) &lt;= ABS(#{retailPriceEnd})</if>
            <if test="priceSum != null and priceSum != ''">and st.price_sum = #{priceSum}</if>
            <if test="costPrice != null and costPrice != ''">and st.cost_price = #{costPrice}</if>
            <if test="costSum != null and costSum != ''">and st.cost_sum = #{costSum}</if>
            <if test="wholePrice != null and wholePrice != ''">and st.whole_price = #{wholePrice}</if>
            <if test="wholeSum != null and wholeSum != ''">and st.whole_sum = #{wholeSum}</if>
            <if test="positionId != null and positionId != ''">and st.position_id = #{positionId}</if>
            and st.goods_count > 0
        </where>
    </select>

    <!-- 护理液查询 -->
    <select id="listHuly" resultType="com.shiguang.stock.domain.StockDO">
        select
        st.`id`,st.`goods_num`,st.`goods_code`,st.`goods_name`,st.`goods_count`,st.`goods_type`,st.`mfrsid`,st.`brandname`,st.`retail_price`,st.`price_sum`,st.`cost_price`,st.`cost_sum`,st.`whole_price`,
        st.`whole_sum`,st.`position_name`,st.`unit`,st.`batch`,st.`useday`,pr.`main_capacity`,pr.`second_capacity`
        from stock st left join aa_hly pr on pr.produc_num = st.goods_num
        <where>
            <if test="id != null and id != ''">and st.id = #{id}</if>
            <if test="goodsNum != null and goodsNum != ''">and st.goods_num like concat('%', #{goodsNum},'%')</if>
            <if test="goodsCode != null and goodsCode != ''">and st.goods_code = #{goodsCode}</if>
            <if test="goodsName != null and goodsName != ''">and st.goods_name like concat('%', #{goodsName},'%')</if>
            <if test="goodsCount != null and goodsCount != ''">and st.goods_count = #{goodsCount}</if>
            <if test="goodsType != null and goodsType != ''">and st.goods_type = #{goodsType}</if>
            <if test="mfrsid != null and mfrsid != ''">and st.mfrsid = #{mfrsid}</if>
            <if test="retailPriceStart != null and retailPriceStart != ''">and ABS(st.retail_price) >= ABS(#{retailPriceStart})</if>
            <if test="retailPriceEnd != null and retailPriceEnd != ''">and ABS(st.retail_price) &lt;= ABS(#{retailPriceEnd})</if>
            <if test="priceSum != null and priceSum != ''">and st.price_sum = #{priceSum}</if>
            <if test="costPrice != null and costPrice != ''">and st.cost_price = #{costPrice}</if>
            <if test="costSum != null and costSum != ''">and st.cost_sum = #{costSum}</if>
            <if test="wholePrice != null and wholePrice != ''">and st.whole_price = #{wholePrice}</if>
            <if test="wholeSum != null and wholeSum != ''">and st.whole_sum = #{wholeSum}</if>
            <if test="positionId != null and positionId != ''">and st.position_id = #{positionId}</if>
            and st.goods_count > 0
        </where>
        <choose>
            <when test="sort != null and sort.trim() != ''">
                order by ${sort} ${order}
            </when>
            <otherwise>
                order by st.id desc
            </otherwise>
        </choose>
        <if test="offset != null and limit != null">
            limit #{offset}, #{limit}
        </if>
    </select>

    <select id="countHuly" resultType="int">
        select count(*) from stock st left join aa_hly pr on pr.produc_num = st.goods_num
        <where>
            <if test="id != null and id != ''">and st.id = #{id}</if>
            <if test="goodsNum != null and goodsNum != ''">and st.goods_num like concat('%', #{goodsNum},'%')</if>
            <if test="goodsCode != null and goodsCode != ''">and st.goods_code = #{goodsCode}</if>
            <if test="goodsName != null and goodsName != ''">and st.goods_name like concat('%', #{goodsName},'%')</if>
            <if test="goodsCount != null and goodsCount != ''">and st.goods_count = #{goodsCount}</if>
            <if test="goodsType != null and goodsType != ''">and st.goods_type = #{goodsType}</if>
            <if test="mfrsid != null and mfrsid != ''">and st.mfrsid = #{mfrsid}</if>
            <if test="retailPriceStart != null and retailPriceStart != ''">and ABS(st.retail_price) >= ABS(#{retailPriceStart})</if>
            <if test="retailPriceEnd != null and retailPriceEnd != ''">and ABS(st.retail_price) &lt;= ABS(#{retailPriceEnd})</if>
            <if test="priceSum != null and priceSum != ''">and st.price_sum = #{priceSum}</if>
            <if test="costPrice != null and costPrice != ''">and st.cost_price = #{costPrice}</if>
            <if test="costSum != null and costSum != ''">and st.cost_sum = #{costSum}</if>
            <if test="wholePrice != null and wholePrice != ''">and st.whole_price = #{wholePrice}</if>
            <if test="wholeSum != null and wholeSum != ''">and st.whole_sum = #{wholeSum}</if>
            <if test="positionId != null and positionId != ''">and st.position_id = #{positionId}</if>
            and st.goods_count > 0
        </where>
    </select>

    <!-- 赠品查询 -->
    <select id="listZengpin" resultType="com.shiguang.stock.domain.StockDO">
        select
        st.`id`,st.`goods_num`,st.`goods_code`,st.`goods_name`,st.`goods_count`,st.`goods_type`,st.`mfrsid`,st.`retail_price`,st.`price_sum`,st.`cost_price`,st.`cost_sum`,st.`whole_price`,
        st.`whole_sum`,st.`position_name`,st.`unit`,st.`batch`,g.`gift_name`
        from stock st left join giveaway pr on pr.give_number = st.goods_num left join gift g on g.gift_num =
        pr.give_type
        <where>
            <if test="id != null and id != ''">and st.id = #{id}</if>
            <if test="goodsNum != null and goodsNum != ''">and st.goods_num like concat('%', #{goodsNum},'%')</if>
            <if test="goodsCode != null and goodsCode != ''">and st.goods_code = #{goodsCode}</if>
            <if test="goodsName != null and goodsName != ''">and st.goods_name like concat('%', #{goodsName},'%')</if>
            <if test="goodsCount != null and goodsCount != ''">and st.goods_count = #{goodsCount}</if>
            <if test="goodsType != null and goodsType != ''">and st.goods_type = #{goodsType}</if>
            <if test="mfrsid != null and mfrsid != ''">and st.mfrsid = #{mfrsid}</if>
            <if test="retailPrice != null and retailPrice != ''">and st.retail_price = #{retailPrice}</if>
            <if test="priceSum != null and priceSum != ''">and st.price_sum = #{priceSum}</if>
            <if test="costPrice != null and costPrice != ''">and st.cost_price = #{costPrice}</if>
            <if test="costSum != null and costSum != ''">and st.cost_sum = #{costSum}</if>
            <if test="wholePrice != null and wholePrice != ''">and st.whole_price = #{wholePrice}</if>
            <if test="wholeSum != null and wholeSum != ''">and st.whole_sum = #{wholeSum}</if>
            <if test="positionId != null and positionId != ''">and st.position_id = #{positionId}</if>
            <if test="stores != null and stores != ''">and FIND_IN_SET(#{stores},pr.stores)</if>
            and st.goods_count > 0
        </where>
        <choose>
            <when test="sort != null and sort.trim() != ''">
                order by ${sort} ${order}
            </when>
            <otherwise>
                order by st.id desc
            </otherwise>
        </choose>
        <if test="offset != null and limit != null">
            limit #{offset}, #{limit}
        </if>
    </select>

    <select id="countZengpin" resultType="int">
        select count(*) from stock st left join giveaway pr on pr.give_number = st.goods_num left join gift g on
        g.gift_num = pr.give_type
        <where>
            <if test="id != null and id != ''">and st.id = #{id}</if>
            <if test="goodsNum != null and goodsNum != ''">and st.goods_num like concat('%', #{goodsNum},'%')</if>
            <if test="goodsCode != null and goodsCode != ''">and st.goods_code = #{goodsCode}</if>
            <if test="goodsName != null and goodsName != ''">and st.goods_name like concat('%', #{goodsName},'%')</if>
            <if test="goodsCount != null and goodsCount != ''">and st.goods_count = #{goodsCount}</if>
            <if test="goodsType != null and goodsType != ''">and st.goods_type = #{goodsType}</if>
            <if test="mfrsid != null and mfrsid != ''">and st.mfrsid = #{mfrsid}</if>
            <if test="retailPrice != null and retailPrice != ''">and st.retail_price = #{retailPrice}</if>
            <if test="priceSum != null and priceSum != ''">and st.price_sum = #{priceSum}</if>
            <if test="costPrice != null and costPrice != ''">and st.cost_price = #{costPrice}</if>
            <if test="costSum != null and costSum != ''">and st.cost_sum = #{costSum}</if>
            <if test="wholePrice != null and wholePrice != ''">and st.whole_price = #{wholePrice}</if>
            <if test="wholeSum != null and wholeSum != ''">and st.whole_sum = #{wholeSum}</if>
            <if test="positionId != null and positionId != ''">and st.position_id = #{positionId}</if>
            <if test="stores != null and stores != ''">and FIND_IN_SET(#{stores},pr.stores)</if>
            and st.goods_count > 0
        </where>
    </select>

    <!-- 隐形成品查询 -->
    <select id="listYxcp" resultType="com.shiguang.stock.domain.StockDO">
        select
        st.`id`,st.`goods_num`,st.`goods_code`,st.`goods_name`,st.`goods_count`,st.`goods_type`,st.`mfrsid`,st.`brandname`,st.`retail_price`,st.`price_sum`,st.`cost_price`,st.`cost_sum`,st.`whole_price`,
        st.`whole_sum`,st.`position_name`,st.`unit`,st.`batch`,st.`classtype`,st.`useday`,t.`type_name`,u.`usage_name`,cu.`unitname` as unit,
        y.`curvature`,y.sph_id as sph,y.cyl_id as cyl
        from stock st left join aa_yxcp y on y.produc_num = st.goods_num left join p_type t on t.type_id = y.type_id
        left join c_unit cu on cu.unitid = y.unitid
        left join p_usage u on u.usage_id = y.usage_id
        <where>
            <if test="id != null and id != ''">and st.id = #{id}</if>
            <if test="goodsNum != null and goodsNum != ''">and st.goods_num like concat('%', #{goodsNum},'%')</if>
            <if test="goodsCode != null and goodsCode != ''">and st.goods_code = #{goodsCode}</if>
            <if test="goodsName != null and goodsName != ''">and st.goods_name like concat('%', #{goodsName},'%')</if>
            <if test="goodsCount != null and goodsCount != ''">and st.goods_count = #{goodsCount}</if>
            <if test="goodsType != null and goodsType != ''">and st.goods_type = #{goodsType}</if>
            <if test="mfrsid != null and mfrsid != ''">and st.mfrsid = #{mfrsid}</if>
            <if test="retailPriceStart != null and retailPriceStart != ''">and ABS(st.retail_price) >= ABS(#{retailPriceStart})</if>
            <if test="retailPriceEnd != null and retailPriceEnd != ''">and ABS(st.retail_price) &lt;= ABS(#{retailPriceEnd})</if>
            <if test="priceSum != null and priceSum != ''">and st.price_sum = #{priceSum}</if>
            <if test="costPrice != null and costPrice != ''">and st.cost_price = #{costPrice}</if>
            <if test="costSum != null and costSum != ''">and st.cost_sum = #{costSum}</if>
            <if test="wholePrice != null and wholePrice != ''">and st.whole_price = #{wholePrice}</if>
            <if test="wholeSum != null and wholeSum != ''">and st.whole_sum = #{wholeSum}</if>
            <if test="positionId != null and positionId != ''">and st.position_id = #{positionId}</if>
            <if test="rightYuanYongQJ != null and rightYuanYongQJ != ''">and y.sph_id =  #{rightYuanYongQJ}</if>
            <if test="rightYuanYongZJ != null and rightYuanYongZJ != ''">and y.cyl_id = #{rightYuanYongZJ}</if>
            <if test="leftYuanYongQJ != null and leftYuanYongQJ != ''">and y.sph_id = #{leftYuanYongQJ}</if>
            <if test="leftYuanYongZJ != null and leftYuanYongZJ != ''">and y.cyl_id = #{leftYuanYongZJ}</if>
            and st.goods_count > 0
        </where>
        <choose>
            <when test="sort != null and sort.trim() != ''">
                order by ${sort} ${order}
            </when>
            <otherwise>
                order by st.id desc
            </otherwise>
        </choose>
        <if test="offset != null and limit != null">
            limit #{offset}, #{limit}
        </if>
    </select>

    <select id="countYxcp" resultType="int">
        select count(*)
        from stock st left join aa_yxcp y on y.id = st.goodsxinxiid left join p_type t on t.type_id = y.type_id
        left join c_unit cu on cu.unitid = y.unitid
        left join p_usage u on u.usage_id = y.usage_id
        <where>
            <if test="id != null and id != ''">and st.id = #{id}</if>
            <if test="goodsNum != null and goodsNum != ''">and st.goods_num like concat('%', #{goodsNum},'%')</if>
            <if test="goodsCode != null and goodsCode != ''">and st.goods_code = #{goodsCode}</if>
            <if test="goodsName != null and goodsName != ''">and st.goods_name like concat('%', #{goodsName},'%')</if>
            <if test="goodsCount != null and goodsCount != ''">and st.goods_count = #{goodsCount}</if>
            <if test="goodsType != null and goodsType != ''">and st.goods_type = #{goodsType}</if>
            <if test="mfrsid != null and mfrsid != ''">and st.mfrsid = #{mfrsid}</if>
            <if test="retailPriceStart != null and retailPriceStart != ''">and ABS(st.retail_price) >= ABS(#{retailPriceStart})</if>
            <if test="retailPriceEnd != null and retailPriceEnd != ''">and ABS(st.retail_price) &lt;= ABS(#{retailPriceEnd})</if>
            <if test="priceSum != null and priceSum != ''">and st.price_sum = #{priceSum}</if>
            <if test="costPrice != null and costPrice != ''">and st.cost_price = #{costPrice}</if>
            <if test="costSum != null and costSum != ''">and st.cost_sum = #{costSum}</if>
            <if test="wholePrice != null and wholePrice != ''">and st.whole_price = #{wholePrice}</if>
            <if test="wholeSum != null and wholeSum != ''">and st.whole_sum = #{wholeSum}</if>
            <if test="positionId != null and positionId != ''">and st.position_id = #{positionId}</if>
            <if test="rightYuanYongQJ != null and rightYuanYongQJ != ''">and y.sph_id =  #{rightYuanYongQJ}</if>
            <if test="rightYuanYongZJ != null and rightYuanYongZJ != ''">and y.cyl_id = #{rightYuanYongZJ}</if>
            <if test="leftYuanYongQJ != null and leftYuanYongQJ != ''">and y.sph_id = #{leftYuanYongQJ}</if>
            <if test="leftYuanYongZJ != null and leftYuanYongZJ != ''">and y.cyl_id = #{leftYuanYongZJ}</if>
            and st.goods_count > 0
        </where>
    </select>


    <!-- 隐形订做查询 -->
    <select id="listYxdz" resultType="com.shiguang.stock.domain.StockDO">
        select
        y.`id`,y.`produc_num` as goodsNum,y.`produc_code` as goodsCode,y.`produc_name` as goodsName,1 as goodsCount,2 as classtype,y.`mfrsid`,y.`retail_price`,
        t.`type_name`,u.`usage_name`,y.`sph_up`,y.`sph_down`,y.`cyl_up`,y.`cyl_down`,cu.`unitname` as unit,cb.`brandname`,
        y.`curvature_one`,y.`curvature_yi`,y.`curvature_two`,y.`curvature_er`,s.`sph`,c.`cyl`
        from aa_yxdz y join c_brand cb on cb.brandnum = y.brandnum and cb.mfrsid = y.mfrsid left join p_type t on t.type_id = y.type_id
        left join a_sph s on s.sph_id = y.sph_id left join a_cyl c on c.cyl_id = y.cyl_id
        left join c_unit cu on cu.unitid = y.unitid
        left join p_usage u on u.usage_id = y.usage_id
        <where>
            <if test="id != null and id != ''">and y.id = #{id}</if>
            <if test="goodsNum != null and goodsNum != ''">and y.`produc_num` like concat('%', #{goodsNum},'%')</if>
            <if test="goodsCode != null and goodsCode != ''">and y.`produc_code` = #{goodsCode}</if>
            <if test="goodsName != null and goodsName != ''">and y.`produc_name` like concat('%', #{goodsName},'%')</if>
            <if test="mfrsid != null and mfrsid != ''">and y.mfrsid = #{mfrsid}</if>
            <if test="retailPriceStart != null and retailPriceStart != ''">and ABS(y.retail_price) >= ABS(#{retailPriceStart})</if>
            <if test="retailPriceEnd != null and retailPriceEnd != ''">and ABS(y.retail_price) &lt;= ABS(#{retailPriceEnd})</if>
            and y.`state` = 1
            <!--<if test="rightYuanYongQJF != null and rightYuanYongQJF != ''">and y.sph_up &lt;= #{fuhao}#{rightYuanYongQJF}</if>-->
            <!--<if test="rightYuanYongQJF != null and rightYuanYongQJF != ''">and y.sph_down >= #{fuhao}#{rightYuanYongQJF}</if>-->
            <!--<if test="rightYuanYongQJZ != null and rightYuanYongQJZ != ''">and y.sph_up &lt;= #{fuhao}#{rightYuanYongQJZ}</if>-->
            <!--<if test="rightYuanYongQJZ != null and rightYuanYongQJZ != ''">and y.sph_down >= #{fuhao}#{rightYuanYongQJZ}</if>-->
            <!--<if test="rightYuanYongZJ != null and rightYuanYongZJ != ''">and ABS(y.cyl_up) &gt;= ABS(#{rightYuanYongZJ})</if>-->
            <!--<if test="rightYuanYongZJ != null and rightYuanYongZJ != ''">and ABS(y.cyl_down) &lt;= ABS(#{rightYuanYongZJ})</if>-->
            <!--<if test="leftYuanYongQJ != null and leftYuanYongQJ != ''">and y.sph_up &lt;= #{leftYuanYongQJ}</if>-->
            <!--<if test="leftYuanYongQJ != null and leftYuanYongQJ != ''">and y.sph_down &gt;= #{leftYuanYongQJ}</if>-->
            <!--<if test="leftYuanYongZJ != null and leftYuanYongZJ != ''">and ABS(y.cyl_up) &gt;= ABS(#{leftYuanYongZJ})</if>-->
            <!--<if test="leftYuanYongZJ != null and leftYuanYongZJ != ''">and ABS(y.cyl_down) &lt;= ABS(#{leftYuanYongZJ})</if>-->
        </where>
        <choose>
            <when test="sort != null and sort.trim() != ''">
                order by ${sort} ${order}
            </when>
            <otherwise>
                order by y.id desc
            </otherwise>
        </choose>
        <if test="offset != null and limit != null">
            limit #{offset}, #{limit}
        </if>
    </select>

    <select id="countYxdz" resultType="int">
        select count(*)
        from aa_yxdz y join c_brand cb on cb.brandnum = y.brandnum and cb.mfrsid = y.mfrsid  left join p_type t on t.type_id = y.type_id
        left join a_sph s on s.sph_id = y.sph_id left join a_cyl c on c.cyl_id = y.cyl_id
        left join p_usage u on u.usage_id = y.usage_id
        <where>
            <if test="id != null and id != ''">and y.id = #{id}</if>
            <if test="goodsNum != null and goodsNum != ''">and y.`produc_num` like concat('%', #{goodsNum},'%')</if>
            <if test="goodsCode != null and goodsCode != ''">and y.`produc_code` = #{goodsCode}</if>
            <if test="goodsName != null and goodsName != ''">and y.`produc_name` like concat('%', #{goodsName},'%')</if>
            <if test="mfrsid != null and mfrsid != ''">and y.mfrsid = #{mfrsid}</if>
            <if test="retailPriceStart != null and retailPriceStart != ''">and ABS(y.retail_price) >= ABS(#{retailPriceStart})</if>
            <if test="retailPriceEnd != null and retailPriceEnd != ''">and ABS(y.retail_price) &lt;= ABS(#{retailPriceEnd})</if>
            and y.`state` = 1
            <!--<if test="rightYuanYongQJ != null and rightYuanYongQJ != ''">and y.sph_up &lt;= #{rightYuanYongQJ}</if>-->
            <!--<if test="rightYuanYongQJ != null and rightYuanYongQJ != ''">and y.sph_down &gt;= #{rightYuanYongQJ}</if>-->
            <!--<if test="rightYuanYongZJ != null and rightYuanYongZJ != ''">and ABS(y.cyl_up) &gt;= ABS(#{rightYuanYongZJ})</if>-->
            <!--<if test="rightYuanYongZJ != null and rightYuanYongZJ != ''">and ABS(y.cyl_down) &lt;= ABS(#{rightYuanYongZJ})</if>-->
            <!--<if test="leftYuanYongQJ != null and leftYuanYongQJ != ''">and y.sph_up &lt;= #{leftYuanYongQJ}</if>-->
            <!--<if test="leftYuanYongQJ != null and leftYuanYongQJ != ''">and y.sph_down &gt;= #{leftYuanYongQJ}</if>-->
            <!--<if test="leftYuanYongZJ != null and leftYuanYongZJ != ''">and ABS(y.cyl_up) &gt;= ABS(#{leftYuanYongZJ})</if>-->
            <!--<if test="leftYuanYongZJ != null and leftYuanYongZJ != ''">and ABS(y.cyl_down) &lt;= ABS(#{leftYuanYongZJ})</if>-->
        </where>
    </select>

    <!-- 查询仓位 -->
    <select id="findPosition" resultType="com.shiguang.mfrs.domain.PositionDO">
        select p.`position_id`,p.`position_num`,p.`depart_number`,p.`depart_name`,p.`position_name` from c_position p join department d on d.depart_number = p.depart_number and d.company_id = p.company_id
        <where>
            <if test="companyId != null and companyId != ''">and d.company_id = #{companyId}</if>
            <if test="departNumber != null and departNumber != ''">and p.depart_number = #{departNumber}</if>
            <if test="positionId != null and positionId != ''">and p.position_id = #{positionId}</if>
            <if test="positionName != null and positionName != ''">and p.position_name = #{positionName}</if>
            and p.position_order = '1'
        </where>
    </select>

    <!-- 查询仓位 -->
    <select id="findHegePosition" resultType="com.shiguang.mfrs.domain.PositionDO">
        select p.`position_id`,p.`position_num`,p.`depart_number`,p.`depart_name`,p.`position_name` from c_position p join department d on d.depart_number = p.depart_number and d.company_id = p.company_id
        <where>
            <if test="companyId != null and companyId != ''">and d.company_id = #{companyId}</if>
            <if test="departNumber != null and departNumber != ''">and p.depart_number = #{departNumber}</if>
            <if test="positionId != null and positionId != ''">and p.position_id = #{positionId}</if>
            <if test="positionName != null and positionName != ''">and p.position_name = #{positionName}</if>
            and p.position_order = '2'
        </where>
    </select>

    <select id="findBuHegePosition" resultType="com.shiguang.mfrs.domain.PositionDO">
        select p.`position_id`,p.`position_num`,p.`depart_number`,p.`depart_name`,p.`position_name` from c_position p join department d on d.depart_number = p.depart_number and d.company_id = p.company_id
        <where>
            <if test="companyId != null and companyId != ''">and d.company_id = #{companyId}</if>
            <if test="departNumber != null and departNumber != ''">and p.depart_number = #{departNumber}</if>
            <if test="positionId != null and positionId != ''">and p.position_id = #{positionId}</if>
            <if test="positionName != null and positionName != ''">and p.position_name = #{positionName}</if>
            and p.position_order = '3'
        </where>
    </select>

    <!--更新库存  -->
    <update id="updateStockCCount" parameterType="com.shiguang.stock.domain.StockDO">
        update stock
        <set>
            <if test="goodsCount != null">`goods_count` = #{goodsCount}, </if>
        </set>
        where position_id = #{positionId} and goods_code = #{goodsCode}
    </update>

    <!--更新库存  -->
    <update id="updateStockCountNum" parameterType="com.shiguang.stock.domain.StockDO">
        update stock
        <set>
            <if test="goodsCount != null">`goods_count` = #{goodsCount}, </if>
        </set>
        where position_id = #{positionId} and goods_num = #{goodsNum}
    </update>

    <select id="getGoodsNum" resultType="com.shiguang.stock.domain.StockDO">
    select `id`,`goods_code`, goods_count as goodsCount  from stock where goods_code = #{value} group by goods_code
</select>
    <select id="selectJingjia" resultType="com.shiguang.product.domain.ProducaDO">
        select  p.produc_num,p.produc_name, b.brandnum,b.brandname,p.produc_factory,u.unitname,
        p.factory,p.retail_price,p.tax_price,p.produc_factorycolor,m.materialname,p.size,p.produc_code,
        p.trade_price,p.transfer_price,mfrs.medicinecode,p.classtype,p.view_good_name,b.goodsid,b.mfrsid,mfrs.mfrsname
        from aa_produca p left join c_unit u on p.unitid=u.unitid
        left join c_material m on p.materialid=m.materialid
        left join a_technology t on p.technology_id=t.technology_id
        left join c_brand b on p.brandnum=b.brandnum AND p.`mfrsid`=b.`mfrsid`
        left join c_mfrs mfrs on p.mfrsid=mfrs.mfrsnum
        <where>
            <if test="producNum != null and producNum != ''">and p.produc_num = #{producNum}</if>
            <if test="producCode != null and producCode != ''">and p.produc_code = #{producCode}</if>
            <if test="producName != null and producName != ''">and p.produc_name LIKE concat(concat('%', #{producName}),'%')</if>

            <if test="mfrsid != null and mfrsid != ''">and p.mfrsid = #{mfrsid}</if>
            <if test="brandid != null and brandid != ''">and p.brandid = #{brandid}</if>
            <if test="brandname != null and brandname != ''">and b.brandname = #{brandname}</if>
            <if test="factory != null and factory != ''">and p.factory = #{factory}</if>
            <if test="producFactory != null and producFactory != ''">and p.produc_factory = #{producFactory}</if>
            <if test="producFactorycolor != null and producFactorycolor != ''">and p.produc_factorycolor =
                #{producFactorycolor}
            </if>
            <if test="sizes != null and sizes != ''">and p.size = #{sizes}</if>
            <if test="technologyId != null and technologyId != ''">and t.technology_id = #{technologyId}</if>
            <if test="materialid != null and materialid != ''">and m.materialid = #{materialid}</if>


            <if test="retailPrice != null and retailPrice != ''">and ABS(p.retail_price) >= ABS(#{retailPrice})</if>
            <if test="retailPrice2 != null and retailPrice2 != ''">and ABS(p.retail_price) &lt;= ABS(#{retailPrice2})</if>
            <if test="taxPrice != null and taxPrice != ''">and ABS(p.tax_price) >= ABS(#{taxPrice})</if>
            <if test="taxPrice2 != null and taxPrice2 != ''">and ABS(p.tax_price) &lt;= ABS(#{taxPrice2})</if>

            and p.xsstate = 0 and  p.state=1 and mfrs.xsstate=0 and mfrs.state=1 and b.xsstate=0 and b.state=1

        </where>
        <choose>
            <when test="sort != null and sort.trim() != ''">
                order by ${sort} ${order}
            </when>
            <otherwise>
                order by mfrs.mfrsid,b.brandid,p.id
            </otherwise>
        </choose>
        <if test="offset != null and limit != null">
            limit #{offset}, #{limit}
        </if>
    </select>
    <select id="selectJingjiaCount" resultType="int">
        select count(*)  from aa_produca p left join c_unit u on p.unitid=u.unitid
        left join c_material m on p.materialid=m.materialid
        left join a_technology t on p.technology_id=t.technology_id
        left join c_brand b on p.brandnum=b.brandnum AND p.`mfrsid`=b.`mfrsid`
        left join c_mfrs mfrs on p.mfrsid=mfrs.mfrsnum
        <where>
            <if test="producNum != null and producNum != ''">and p.produc_num = #{producNum}</if>
            <if test="producCode != null and producCode != ''">and p.produc_code = #{producCode}</if>
            <if test="producName != null and producName != ''">and p.produc_name LIKE concat(concat('%', #{producName}),'%')</if>

            <if test="mfrsid != null and mfrsid != ''">and p.mfrsid = #{mfrsid}</if>
            <if test="brandid != null and brandid != ''">and p.brandid = #{brandid}</if>
            <if test="brandname != null and brandname != ''">and b.brandname = #{brandname}</if>
            <if test="factory != null and factory != ''">and p.factory = #{factory}</if>
            <if test="producFactory != null and producFactory != ''">and p.produc_factory = #{producFactory}</if>
            <if test="producFactorycolor != null and producFactorycolor != ''">and p.produc_factorycolor =
                #{producFactorycolor}
            </if>
            <if test="sizes != null and sizes != ''">and p.size = #{sizes}</if>
            <if test="technologyId != null and technologyId != ''">and t.technology_id = #{technologyId}</if>
            <if test="materialid != null and materialid != ''">and m.materialid = #{materialid}</if>

            <if test="retailPrice != null and retailPrice != ''">and ABS(p.retail_price) >= ABS(#{retailPrice})</if>
            <if test="retailPrice2 != null and retailPrice2 != ''">and ABS(p.retail_price) &lt;= ABS(#{retailPrice2})</if>
            <if test="taxPrice != null and taxPrice != ''">and ABS(p.tax_price) >= ABS(#{taxPrice})</if>
            <if test="taxPrice2 != null and taxPrice2 != ''">and ABS(p.tax_price) &lt;= ABS(#{taxPrice2})</if>

            and p.xsstate = 0 and  p.state=1 and mfrs.xsstate=0 and mfrs.state=1 and b.xsstate=0 and b.state=1
        </where>
        order by mfrs.mfrsid,b.brandid,p.id
    </select>
    <select id="selectPeijian" resultType="com.shiguang.product.domain.PartsDO">
        select  p.produc_num,p.produc_name, b.brandnum,b.brandname,p.produc_factory,u.unitname,
        p.factory,p.retail_price,p.tax_price,p.parts_style,p.produc_code,
        p.trade_price,p.transfer_price,mfrs.medicinecode,p.classtype,p.view_good_name,b.goodsid,b.mfrsid,mfrs.mfrsname
        from aa_parts p left join c_unit u on p.unitid=u.unitid
        left join c_brand b on p.brandnum=b.brandnum AND p.`mfrsid`=b.`mfrsid`
        left join c_mfrs mfrs on p.mfrsid=mfrs.mfrsnum
        <where>
            <if test="producNum != null and producNum != ''">and p.produc_num = #{producNum}</if>
            <if test="producCode != null and producCode != ''">and p.produc_code = #{producCode}</if>
            <if test="producName != null and producName != ''">and p.produc_name LIKE concat(concat('%', #{producName}),'%')</if>
            <if test="mfrsid != null and mfrsid != ''">and p.mfrsid = #{mfrsid}</if>
            <if test="brandid != null and brandid != ''">and p.brandid = #{brandid}</if>
            <if test="brandname != null and brandname != ''">and b.brandname = #{brandname}</if>
            <if test="partsStyle != null and partsStyle != ''">and p.parts_style = #{partsStyle}</if>
            <if test="producFactory != null and producFactory != ''">and p.produc_factory = #{producFactory}</if>
            <if test="factory != null and factory != ''">and p.factory = #{factory}</if>

            <if test="retailPrice != null and retailPrice != ''">and ABS(p.retail_price) >= ABS(#{retailPrice})</if>
            <if test="retailPrice2 != null and retailPrice2 != ''">and ABS(p.retail_price) &lt;= ABS(#{retailPrice2})</if>
            <if test="taxPrice != null and taxPrice != ''">and ABS(p.tax_price) >= ABS(#{taxPrice})</if>
            <if test="taxPrice2 != null and taxPrice2 != ''">and ABS(p.tax_price) &lt;= ABS(#{taxPrice2})</if>

            and p.xsstate = 0 and  p.state=1 and mfrs.xsstate=0 and mfrs.state=1 and b.xsstate=0 and b.state=1
        </where>
        <choose>
            <when test="sort != null and sort.trim() != ''">
                order by ${sort} ${order}
            </when>
            <otherwise>
                order by mfrs.mfrsid,b.brandid,p.id
            </otherwise>
        </choose>
        <if test="offset != null and limit != null">
            limit #{offset}, #{limit}
        </if>
    </select>
    <select id="selectPeijianCount" resultType="int">
        select count(*)   from aa_parts p left join c_unit u on p.unitid=u.unitid
        left join c_brand b on p.brandnum=b.brandnum AND p.`mfrsid`=b.`mfrsid`
        left join c_mfrs mfrs on p.mfrsid=mfrs.mfrsnum
        <where>
            <if test="producNum != null and producNum != ''">and p.produc_num = #{producNum}</if>
            <if test="producCode != null and producCode != ''">and p.produc_code = #{producCode}</if>
            <if test="producName != null and producName != ''">and p.produc_name LIKE concat(concat('%', #{producName}),'%')</if>
            <if test="mfrsid != null and mfrsid != ''">and p.mfrsid = #{mfrsid}</if>
            <if test="brandid != null and brandid != ''">and p.brandid = #{brandid}</if>
            <if test="brandname != null and brandname != ''">and b.brandname = #{brandname}</if>
            <if test="partsStyle != null and partsStyle != ''">and p.parts_style = #{partsStyle}</if>
            <if test="producFactory != null and producFactory != ''">and p.produc_factory = #{producFactory}</if>
            <if test="factory != null and factory != ''">and p.factory = #{factory}</if>

            <if test="retailPrice != null and retailPrice != ''">and ABS(p.retail_price) >= ABS(#{retailPrice})</if>
            <if test="retailPrice2 != null and retailPrice2 != ''">and ABS(p.retail_price) &lt;= ABS(#{retailPrice2})</if>
            <if test="taxPrice != null and taxPrice != ''">and ABS(p.tax_price) >= ABS(#{taxPrice})</if>
            <if test="taxPrice2 != null and taxPrice2 != ''">and ABS(p.tax_price) &lt;= ABS(#{taxPrice2})</if>

            and p.xsstate = 0 and  p.state=1 and mfrs.xsstate=0 and mfrs.state=1 and b.xsstate=0 and b.state=1
        </where>
        order by mfrs.mfrsid,b.brandid,p.id
    </select>
    <select id="selectJpdz" resultType="com.shiguang.product.domain.JpdzDO">
        SELECT
        j.produc_num,
        j.produc_name,
        u.unitname,
        b.brandnum,
        b.brandname,
        j.factory,
        j.retail_price,
        j.tax_price,
        j.sph_up,
        j.sph_down,
        j.cyl_up,
        j.cyl_down,
        j.lightbelow_left,
        j.lightbelow_right,
        j.refractivityid as refractivityvalue,
        l.light_name,
        le.lens_name,
        g.gradual_name,
        f.function_name,
        j.produc_code,
        j.trade_price,
        j.transfer_price,
        mfrs.medicinecode,
        j.classtype,
        j.produc_factory,
        j.view_good_name,
        b.goodsid,b.mfrsid,mfrs.mfrsname
        FROM
        aa_jpdz j
        LEFT JOIN c_unit u ON j.unitid = u.unitid
        LEFT JOIN p_light l ON j.light_id = l.light_id
        LEFT JOIN p_lens le ON j.lens_id = le.lens_id
        LEFT JOIN p_gradual g ON j.gradual_id = g.gradual_id
        LEFT JOIN p_function f ON j.function_id = f.function_id
        LEFT JOIN c_brand b ON j.brandnum = b.brandnum
        AND j.`mfrsid` = b.`mfrsid`
        LEFT JOIN c_mfrs mfrs ON j.mfrsid = mfrs.mfrsnum
        <where>
            <if test="producNum != null and producNum != ''">and j.produc_num = #{producNum}</if>
            <if test="producCode != null and producCode != ''">and j.produc_code = #{producCode}</if>
            <if test="producName != null and producName != ''">and p.produc_name LIKE concat(concat('%', #{producName}),'%')</if>
            <if test="mfrsid != null and mfrsid != ''">and j.mfrsid = #{mfrsid}</if>
            <if test="brandid != null and brandid != ''">and j.brandid = #{brandid}</if>
            <if test="brandname != null and brandname != ''">and b.brandname = #{brandname}</if>
            <if test="lensId != null and lensId != ''">and j.lens_id = #{lensId}</if>
            <if test="refractivityid != null and refractivityid != ''">and j.refractivityid = #{refractivityid}</if>
            <if test="lightId != null and lightId != ''">and j.light_d = #{lightId}</if>
            <if test="functionId != null and functionId != ''">and j.function_id = #{functionId}</if>
            <if test="gradualId != null and gradualId != ''">and j.gradual_id = #{gradualId}</if>
            <if test="factory != null and factory != ''">and j.factory = #{factory}</if>

            <if test="retailPrice != null and retailPrice != ''">and ABS(j.retail_price) >= ABS(#{retailPrice})</if>
            <if test="retailPrice2 != null and retailPrice2 != ''">and ABS(j.retail_price) &lt;= ABS(#{retailPrice2})</if>
            <if test="taxPrice != null and taxPrice != ''">and ABS(j.tax_price) >= ABS(#{taxPrice})</if>
            <if test="taxPrice2 != null and taxPrice2 != ''">and ABS(j.tax_price) &lt;= ABS(#{taxPrice2})</if>

            <if test="classtype != null and classtype != ''">and j.classtype = #{classtype}</if>
            <if test="producFactory != null and producFactory != ''">and j.produc_factory = #{producFactory}</if>
            and j.xsstate = 0 and  j.state=1 and mfrs.xsstate=0 and mfrs.state=1 and b.xsstate=0 and b.state=1
        </where>
        <choose>
            <when test="sort != null and sort.trim() != ''">
                order by ${sort} ${order}
            </when>
            <otherwise>
                order by mfrs.mfrsid,b.brandid,j.id
            </otherwise>
        </choose>
        <if test="offset != null and limit != null">
            limit #{offset}, #{limit}
        </if>
    </select>
    <select id="selectJpdzCount" resultType="int">
    select count(*)  FROM
        aa_jpdz j
        LEFT JOIN c_unit u ON j.unitid = u.unitid
        LEFT JOIN p_light l ON j.light_id = l.light_id
        LEFT JOIN p_lens le ON j.lens_id = le.lens_id
        LEFT JOIN p_gradual g ON j.gradual_id = g.gradual_id
        LEFT JOIN p_function f ON j.function_id = f.function_id
        LEFT JOIN c_brand b ON j.brandnum = b.brandnum
        AND j.`mfrsid` = b.`mfrsid`
        LEFT JOIN c_mfrs mfrs ON j.mfrsid = mfrs.mfrsnum
        <where>
            <if test="producNum != null and producNum != ''">and j.produc_num = #{producNum}</if>
            <if test="producCode != null and producCode != ''">and j.produc_code = #{producCode}</if>
            <if test="producName != null and producName != ''">and p.produc_name LIKE concat(concat('%', #{producName}),'%')</if>
            <if test="mfrsid != null and mfrsid != ''">and j.mfrsid = #{mfrsid}</if>
            <if test="brandid != null and brandid != ''">and j.brandid = #{brandid}</if>
            <if test="brandname != null and brandname != ''">and b.brandname = #{brandname}</if>
            <if test="lensId != null and lensId != ''">and j.lens_id = #{lensId}</if>
            <if test="refractivityid != null and refractivityid != ''">and j.refractivityid = #{refractivityid}</if>
            <if test="lightId != null and lightId != ''">and j.light_d = #{lightId}</if>
            <if test="functionId != null and functionId != ''">and j.function_id = #{functionId}</if>
            <if test="gradualId != null and gradualId != ''">and j.gradual_id = #{gradualId}</if>
            <if test="factory != null and factory != ''">and j.factory = #{factory}</if>

            <if test="retailPrice != null and retailPrice != ''">and ABS(j.retail_price) >= ABS(#{retailPrice})</if>
            <if test="retailPrice2 != null and retailPrice2 != ''">and ABS(j.retail_price) &lt;= ABS(#{retailPrice2})</if>
            <if test="taxPrice != null and taxPrice != ''">and ABS(j.tax_price) >= ABS(#{taxPrice})</if>
            <if test="taxPrice2 != null and taxPrice2 != ''">and ABS(j.tax_price) &lt;= ABS(#{taxPrice2})</if>

            <if test="classtype != null and classtype != ''">and j.classtype = #{classtype}</if>
            <if test="producFactory != null and producFactory != ''">and j.produc_factory = #{producFactory}</if>
            and j.xsstate = 0 and  j.state=1 and mfrs.xsstate=0 and mfrs.state=1 and b.xsstate=0 and b.state=1
        </where>
        order by mfrs.mfrsid,b.brandid,j.id
    </select>
    <select id="selectJpcp" resultType="com.shiguang.product.domain.JpcpDO">
        SELECT
        j.produc_num,
        j.produc_name,
        u.unitname,
        b.brandnum,
        b.brandname,
        j.retail_price,
        j.tax_price,
        j.sph_id AS sph,
        j.cyl_id AS cyl,
        j.lightbelow_id AS lightbelow,
        j.refractivityid AS refractivityvalue,
        l.light_name,
        le.lens_name,
        g.gradual_name,
        f.function_name,
        j.produc_code,
        j.trade_price,
        j.transfer_price,
        mfrs.medicinecode,
        j.classtype,
        j.produc_factory,
        j.produc_factory as factoty,
        j.view_good_name
        ,b.goodsid,b.mfrsid,mfrs.mfrsname
        FROM
        aa_jpcp j
        JOIN c_unit u ON j.unitid = u.unitid
        LEFT JOIN p_light l ON j.light_id = l.light_id
        LEFT JOIN p_lens le ON j.lens_id = le.lens_id
        LEFT JOIN p_gradual g ON j.gradual_id = g.gradual_id
        LEFT JOIN p_function f ON j.function_id = f.function_id
        LEFT JOIN c_brand b ON j.brandnum = b.brandnum
        AND j.`mfrsid` = b.`mfrsid`
        LEFT JOIN c_mfrs mfrs ON j.mfrsid = mfrs.mfrsnum
        <where>
            <if test="producNum != null and producNum != ''">and j.produc_num = #{producNum}</if>
            <if test="producCode != null and producCode != ''">and j.produc_code = #{producCode}</if>
            <if test="producName != null and producName != ''">and p.produc_name LIKE concat(concat('%', #{producName}),'%')</if>
            <if test="mfrsid != null and mfrsid != ''">and j.mfrsid = #{mfrsid}</if>
            <if test="brandid != null and brandid != ''">and j.brandid = #{brandid}</if>
            <if test="brandname != null and brandname != ''">and b.brandname = #{brandname}</if>
            <if test="lensId != null and lensId != ''">and j.lens_id = #{lensId}</if>
            <if test="refractivityid != null and refractivityid != ''">and j.refractivityid = #{refractivityid}</if>
            <if test="lightId != null and lightId != ''">and j.light_id = #{lightId}</if>
            <if test="functionId != null and functionId != ''">and j.function_id = #{functionId}</if>
            <if test="gradualId != null and gradualId != ''">and j.gradual_id = #{gradualId}</if>
            <if test="factory != null and factory != ''">and j.factory = #{factory}</if>

            <if test="retailPrice != null and retailPrice != ''">and ABS(j.retail_price) >= ABS(#{retailPrice})</if>
            <if test="retailPrice2 != null and retailPrice2 != ''">and ABS(j.retail_price) &lt;= ABS(#{retailPrice2})</if>
            <if test="taxPrice != null and taxPrice != ''">and ABS(j.tax_price) >= ABS(#{taxPrice})</if>
            <if test="taxPrice2 != null and taxPrice2 != ''">and ABS(j.tax_price) &lt;= ABS(#{taxPrice2})</if>

            <if test="classtype != null and classtype != ''">and j.classtype = #{classtype}</if>
            and j.xsstate = 0 and  j.state=1 and mfrs.xsstate=0 and mfrs.state=1 and b.xsstate=0 and b.state=1
        </where>
        <choose>
            <when test="sort != null and sort.trim() != ''">
                order by ${sort} ${order}
            </when>
            <otherwise>
                order by mfrs.mfrsid,b.brandid,j.id
            </otherwise>
        </choose>
        <if test="offset != null and limit != null">
            limit #{offset}, #{limit}
        </if>
    </select>
    <select id="selectJpcpCount" resultType="int">
        select count(*)  FROM
        aa_jpcp j
        JOIN c_unit u ON j.unitid = u.unitid
        LEFT JOIN p_light l ON j.light_id = l.light_id
        LEFT JOIN p_lens le ON j.lens_id = le.lens_id
        LEFT JOIN p_gradual g ON j.gradual_id = g.gradual_id
        LEFT JOIN p_function f ON j.function_id = f.function_id
        LEFT JOIN c_brand b ON j.brandnum = b.brandnum
        AND j.`mfrsid` = b.`mfrsid`
        LEFT JOIN c_mfrs mfrs ON j.mfrsid = mfrs.mfrsnum
        <where>
            <if test="producNum != null and producNum != ''">and j.produc_num = #{producNum}</if>
            <if test="producCode != null and producCode != ''">and j.produc_code = #{producCode}</if>
            <if test="producName != null and producName != ''">and p.produc_name LIKE concat(concat('%', #{producName}),'%')</if>
            <if test="mfrsid != null and mfrsid != ''">and j.mfrsid = #{mfrsid}</if>
            <if test="brandid != null and brandid != ''">and j.brandid = #{brandid}</if>
            <if test="brandname != null and brandname != ''">and b.brandname = #{brandname}</if>
            <if test="lensId != null and lensId != ''">and j.lens_id = #{lensId}</if>
            <if test="refractivityid != null and refractivityid != ''">and j.refractivityid = #{refractivityid}</if>
            <if test="lightId != null and lightId != ''">and j.light_id = #{lightId}</if>
            <if test="functionId != null and functionId != ''">and j.function_id = #{functionId}</if>
            <if test="gradualId != null and gradualId != ''">and j.gradual_id = #{gradualId}</if>
            <if test="factory != null and factory != ''">and j.factory = #{factory}</if>

            <if test="retailPrice != null and retailPrice != ''">and ABS(j.retail_price) >= ABS(#{retailPrice})</if>
            <if test="retailPrice2 != null and retailPrice2 != ''">and ABS(j.retail_price) &lt;= ABS(#{retailPrice2})</if>
            <if test="taxPrice != null and taxPrice != ''">and ABS(j.tax_price) >= ABS(#{taxPrice})</if>
            <if test="taxPrice2 != null and taxPrice2 != ''">and ABS(j.tax_price) &lt;= ABS(#{taxPrice2})</if>

            <if test="classtype != null and classtype != ''">and j.classtype = #{classtype}</if>
            and j.xsstate = 0 and  j.state=1 and mfrs.xsstate=0 and mfrs.state=1 and b.xsstate=0 and b.state=1
        </where>
        order by mfrs.mfrsid,b.brandid,j.id
    </select>
    <select id="selectYxdz" resultType="com.shiguang.product.domain.YxdzDO">
        select
        y.produc_num,y.produc_name, y.produc_code,u.unitname,y.factory,y.retail_price,y.tax_price,y.sph_up,y.sph_down,y.cyl_up,y.cyl_down,
        y.curvature_one,y.curvature_yi,y.diameter_one,y.diameter_yi,pu.usage_name,pt.type_name,y.trade_price,y.transfer_price, b.brandnum,b.brandname,
        mfrs.medicinecode,y.classtype,y.produc_factory,y.view_good_name,b.goodsid,b.mfrsid,mfrs.mfrsname
        	from aa_yxdz y left join c_unit u on y.unitid=u.unitid
        	left join a_cyl c on y.cyl_id=c.cyl_id
        	left join p_usage pu  on y.usage_id=pu.usage_id
        	left join p_type pt  on y.type_id=pt.type_id
        	left join c_brand b on y.brandnum=b.brandnum AND y.`mfrsid`=b.`mfrsid`
            left join c_mfrs mfrs on y.mfrsid=mfrs.mfrsnum
        <where>
            <if test="producNum != null and producNum != ''">and y.produc_num = #{producNum}</if>
            <if test="producCode != null and producCode != ''">and y.produc_code = #{producCode}</if>
            <if test="producName != null and producName != ''">and p.produc_name LIKE concat(concat('%', #{producName}),'%')</if>
            <if test="mfrsid != null and mfrsid != ''">and y.mfrsid = #{mfrsid}</if>
            <if test="brandid != null and brandid != ''">and y.brandid = #{brandid}</if>
            <if test="brandname != null and brandname != ''">and b.brandname = #{brandname}</if>
            <if test="producFactory != null and producFactory != ''">and y.produc_factory = #{producFactory}</if>
            <if test="factory != null and factory != ''">and y.factory = #{factory}</if>

            <if test="retailPrice != null and retailPrice != ''">and ABS(y.retail_price) >= ABS(#{retailPrice})</if>
            <if test="retailPrice2 != null and retailPrice2 != ''">and ABS(y.retail_price) &lt;= ABS(#{retailPrice2})</if>
            <if test="taxPrice != null and taxPrice != ''">and ABS(y.tax_price) >= ABS(#{taxPrice})</if>
            <if test="taxPrice2 != null and taxPrice2 != ''">and ABS(y.tax_price) &lt;= ABS(#{taxPrice2})</if>

            <if test="usageId != null and usageId != ''">and y.usage_id = #{usageId}</if>
            <if test="typeId != null and typeId != ''">and y.type_id = #{typeId}</if>
            <if test="classtype != null and classtype != ''">and y.classtype = #{classtype}</if>
            and y.xsstate = 0 and  y.state=1 and mfrs.xsstate=0 and mfrs.state=1 and b.xsstate=0 and b.state=1
        </where>
        <choose>
            <when test="sort != null and sort.trim() != ''">
                order by ${sort} ${order}
            </when>
            <otherwise>
                order by mfrs.mfrsid,b.brandid,y.id
            </otherwise>
        </choose>
        <if test="offset != null and limit != null">
            limit #{offset}, #{limit}
        </if>
    </select>
    <select id="selectYxdzCount" resultType="int">
        select count(*) from aa_yxdz y left join c_unit u on y.unitid=u.unitid
        left join a_cyl c on y.cyl_id=c.cyl_id
        left join p_usage pu  on y.usage_id=pu.usage_id
        left join p_type pt  on y.type_id=pt.type_id
        left join c_brand b on y.brandnum=b.brandnum AND y.`mfrsid`=b.`mfrsid`
        left join c_mfrs mfrs on y.mfrsid=mfrs.mfrsnum
        <where>
            <if test="producNum != null and producNum != ''">and y.produc_num = #{producNum}</if>
            <if test="producCode != null and producCode != ''">and y.produc_code = #{producCode}</if>
            <if test="producName != null and producName != ''">and p.produc_name LIKE concat(concat('%', #{producName}),'%')</if>
            <if test="mfrsid != null and mfrsid != ''">and y.mfrsid = #{mfrsid}</if>
            <if test="brandid != null and brandid != ''">and y.brandid = #{brandid}</if>
            <if test="brandname != null and brandname != ''">and b.brandname = #{brandname}</if>
            <if test="producFactory != null and producFactory != ''">and y.produc_factory = #{producFactory}</if>
            <if test="factory != null and factory != ''">and y.factory = #{factory}</if>

            <if test="retailPrice != null and retailPrice != ''">and ABS(y.retail_price) >= ABS(#{retailPrice})</if>
            <if test="retailPrice2 != null and retailPrice2 != ''">and ABS(y.retail_price) &lt;= ABS(#{retailPrice2})</if>
            <if test="taxPrice != null and taxPrice != ''">and ABS(y.tax_price) >= ABS(#{taxPrice})</if>
            <if test="taxPrice2 != null and taxPrice2 != ''">and ABS(y.tax_price) &lt;= ABS(#{taxPrice2})</if>

            <if test="usageId != null and usageId != ''">and y.usage_id = #{usageId}</if>
            <if test="typeId != null and typeId != ''">and y.type_id = #{typeId}</if>
            <if test="classtype != null and classtype != ''">and y.classtype = #{classtype}</if>
            and y.xsstate = 0 and  y.state=1 and mfrs.xsstate=0 and mfrs.state=1 and b.xsstate=0 and b.state=1
        </where>
        order by mfrs.mfrsid,b.brandid,y.id
    </select>
    <select id="selectYxcp" resultType="com.shiguang.product.domain.YxcpDO">
        SELECT
        y.produc_num,
        y.produc_name,
        y.produc_code,
        u.unitname,
        y.factory,
        y.retail_price,
        y.tax_price,
        y.sph_id AS sph,
        y.cyl_id AS cyl,
        y.curvature,
        y.diameter,
        pu.usage_name,
        pt.type_name,
        y.trade_price,
        y.transfer_price,
        b.brandnum,
        b.brandname,
        mfrs.medicinecode,
        y.classtype,
        y.view_good_name,b.goodsid,b.mfrsid,mfrs.mfrsname
        FROM
        aa_yxcp y
        LEFT JOIN c_unit u ON y.unitid = u.unitid
        LEFT JOIN p_usage pu ON y.usage_id = pu.usage_id
        LEFT JOIN p_type pt ON y.type_id = pt.type_id
        LEFT JOIN c_brand b ON y.brandnum = b.brandnum
        AND y.`mfrsid` = b.`mfrsid`
        LEFT JOIN c_mfrs mfrs ON y.mfrsid = mfrs.mfrsnum
        <where>
            <if test="producNum != null and producNum != ''">and y.produc_num = #{producNum}</if>
            <if test="producCode != null and producCode != ''">and y.produc_code = #{producCode}</if>
            <if test="producName != null and producName != ''">and p.produc_name LIKE concat(concat('%', #{producName}),'%')</if>
            <if test="mfrsid != null and mfrsid != ''">and y.mfrsid = #{mfrsid}</if>
            <if test="brandid != null and brandid != ''">and y.brandid = #{brandid}</if>
            <if test="brandname != null and brandname != ''">and b.brandname = #{brandname}</if>
            <if test="producFactory != null and producFactory != ''">and y.produc_factory = #{producFactory}</if>
            <if test="factory != null and factory != ''">and y.factory = #{factory}</if>

            <if test="retailPrice != null and retailPrice != ''">and ABS(y.retail_price) >= ABS(#{retailPrice})</if>
            <if test="retailPrice2 != null and retailPrice2 != ''">and ABS(y.retail_price) &lt;= ABS(#{retailPrice2})</if>
            <if test="taxPrice != null and taxPrice != ''">and ABS(y.tax_price) >= ABS(#{taxPrice})</if>
            <if test="taxPrice2 != null and taxPrice2 != ''">and ABS(y.tax_price) &lt;= ABS(#{taxPrice2})</if>

            <if test="usageId != null and usageId != ''">and y.usage_id = #{usageId}</if>
            <if test="typeId != null and typeId != ''">and y.type_id = #{typeId}</if>
            <if test="classtype != null and classtype != ''">and y.classtype = #{classtype}</if>
            and y.xsstate = 0 and  y.state=1 and mfrs.xsstate=0 and mfrs.state=1 and b.xsstate=0 and b.state=1
        </where>
        <choose>
            <when test="sort != null and sort.trim() != ''">
                order by ${sort} ${order}
            </when>
            <otherwise>
                order by mfrs.mfrsid,b.brandid,y.id
            </otherwise>
        </choose>
        <if test="offset != null and limit != null">
            limit #{offset}, #{limit}
        </if>
    </select>
    <select id="selectYxcpCount" resultType="int">
        select count(*)  FROM
        aa_yxcp y
        LEFT JOIN c_unit u ON y.unitid = u.unitid
        LEFT JOIN p_usage pu ON y.usage_id = pu.usage_id
        LEFT JOIN p_type pt ON y.type_id = pt.type_id
        LEFT JOIN c_brand b ON y.brandnum = b.brandnum
        AND y.`mfrsid` = b.`mfrsid`
        LEFT JOIN c_mfrs mfrs ON y.mfrsid = mfrs.mfrsnum
        <where>
            <if test="producNum != null and producNum != ''">and y.produc_num = #{producNum}</if>
            <if test="producCode != null and producCode != ''">and y.produc_code = #{producCode}</if>
            <if test="producName != null and producName != ''">and p.produc_name LIKE concat(concat('%', #{producName}),'%')</if>
            <if test="mfrsid != null and mfrsid != ''">and y.mfrsid = #{mfrsid}</if>
            <if test="brandid != null and brandid != ''">and y.brandid = #{brandid}</if>
            <if test="brandname != null and brandname != ''">and b.brandname = #{brandname}</if>
            <if test="producFactory != null and producFactory != ''">and y.produc_factory = #{producFactory}</if>
            <if test="factory != null and factory != ''">and y.factory = #{factory}</if>

            <if test="retailPrice != null and retailPrice != ''">and ABS(y.retail_price) >= ABS(#{retailPrice})</if>
            <if test="retailPrice2 != null and retailPrice2 != ''">and ABS(y.retail_price) &lt;= ABS(#{retailPrice2})</if>
            <if test="taxPrice != null and taxPrice != ''">and ABS(y.tax_price) >= ABS(#{taxPrice})</if>
            <if test="taxPrice2 != null and taxPrice2 != ''">and ABS(y.tax_price) &lt;= ABS(#{taxPrice2})</if>


            <if test="usageId != null and usageId != ''">and y.usage_id = #{usageId}</if>
            <if test="typeId != null and typeId != ''">and y.type_id = #{typeId}</if>
            <if test="classtype != null and classtype != ''">and y.classtype = #{classtype}</if>
            and y.xsstate = 0 and  y.state=1 and mfrs.xsstate=0 and mfrs.state=1 and b.xsstate=0 and b.state=1
        </where>
        order by mfrs.mfrsid,b.brandid,y.id
    </select>


    <select id="selectHly" resultType="com.shiguang.product.domain.HlyDO">
        select
        h.produc_num,  h.produc_name,  b.brandnum, b.brandname,h.produc_factory,h.factory,u.unitname,h.retail_price,h.tax_price,h.main_capacity,h.second_capacity,h.produc_code,
        h.trade_price,h.transfer_price,mfrs.medicinecode,h.classtype,h.view_good_name,b.goodsid,b.mfrsid,mfrs.mfrsname
        from aa_hly h left join c_unit u on h.unitid = u.unitid
        left join c_brand b on h.brandnum=b.brandnum AND h.`mfrsid`=b.`mfrsid`
        left join c_mfrs mfrs on h.mfrsid=mfrs.mfrsnum
        <where>
            <if test="producNum != null and producNum != ''">and h.produc_num = #{producNum}</if>
            <if test="producCode != null and producCode != ''">and h.produc_code = #{producCode}</if>
            <if test="producName != null and producName != ''">and p.produc_name LIKE concat(concat('%', #{producName}),'%')</if>
            <if test="mfrsid != null and mfrsid != ''">and h.mfrsid = #{mfrsid}</if>
            <if test="brandid != null and brandid != ''">and h.brandid = #{brandid}</if>
            <if test="brandname != null and brandname != ''">and b.brandname = #{brandname}</if>
            <if test="mainCapacity != null and mainCapacity != ''">and h.main_capacity = #{mainCapacity}</if>
            <if test="secondCapacity != null and secondCapacity != ''">and h.second_capacity = #{secondCapacity}</if>
            <if test="producFactory != null and producFactory != ''">and h.produc_factory = #{producFactory}</if>
            <if test="factory != null and factory != ''">and h.factory = #{factory}</if>

            <if test="retailPrice != null and retailPrice != ''">and ABS(h.retail_price) >= ABS(#{retailPrice})</if>
            <if test="retailPrice2 != null and retailPrice2 != ''">and ABS(h.retail_price) &lt;= ABS(#{retailPrice2})</if>
            <if test="taxPrice != null and taxPrice != ''">and ABS(h.tax_price) >= ABS(#{taxPrice})</if>
            <if test="taxPrice2 != null and taxPrice2 != ''">and ABS(h.tax_price) &lt;= ABS(#{taxPrice2})</if>

            and h.xsstate = 0 and  h.state=1 and mfrs.xsstate=0 and mfrs.state=1 and b.xsstate=0 and b.state=1
        </where>
        <choose>
            <when test="sort != null and sort.trim() != ''">
                order by ${sort} ${order}
            </when>
            <otherwise>
                order by mfrs.mfrsid,b.brandid,h.id
            </otherwise>
        </choose>
        <if test="offset != null and limit != null">
            limit #{offset}, #{limit}
        </if>
    </select>
    <select id="selectHlyCount" resultType="int">
        select count(*)  from aa_hly h left join c_unit u on h.unitid = u.unitid
        left join c_brand b on h.brandnum=b.brandnum AND h.`mfrsid`=b.`mfrsid`
        left join c_mfrs mfrs on h.mfrsid=mfrs.mfrsnum
        <where>
            <if test="producNum != null and producNum != ''">and h.produc_num = #{producNum}</if>
            <if test="producCode != null and producCode != ''">and h.produc_code = #{producCode}</if>
            <if test="producName != null and producName != ''">and p.produc_name LIKE concat(concat('%', #{producName}),'%')</if>
            <if test="mfrsid != null and mfrsid != ''">and h.mfrsid = #{mfrsid}</if>
            <if test="brandid != null and brandid != ''">and h.brandid = #{brandid}</if>
            <if test="brandname != null and brandname != ''">and b.brandname = #{brandname}</if>
            <if test="mainCapacity != null and mainCapacity != ''">and h.main_capacity = #{mainCapacity}</if>
            <if test="secondCapacity != null and secondCapacity != ''">and h.second_capacity = #{secondCapacity}</if>
            <if test="producFactory != null and producFactory != ''">and h.produc_factory = #{producFactory}</if>
            <if test="factory != null and factory != ''">and h.factory = #{factory}</if>

            <if test="retailPrice != null and retailPrice != ''">and ABS(h.retail_price) >= ABS(#{retailPrice})</if>
            <if test="retailPrice2 != null and retailPrice2 != ''">and ABS(h.retail_price) &lt;= ABS(#{retailPrice2})</if>
            <if test="taxPrice != null and taxPrice != ''">and ABS(h.tax_price) >= ABS(#{taxPrice})</if>
            <if test="taxPrice2 != null and taxPrice2 != ''">and ABS(h.tax_price) &lt;= ABS(#{taxPrice2})</if>

            and h.xsstate = 0 and  h.state=1 and mfrs.xsstate=0 and mfrs.state=1 and b.xsstate=0 and b.state=1
        </where>
        order by mfrs.mfrsid,b.brandid,h.id
    </select>
    <select id="selectTyj" resultType="com.shiguang.product.domain.TyjDO">
        SELECT
        t.produc_num,
        t.produc_name,
        t.produc_code,
        b.brandnum,
        b.brandname,
        t.produc_factory,
        t.factory,
        u.unitname,
        t.retail_price,
        t.tax_price,
        t.produc_factorycolor,
        t.size,
        t.trade_price,
        t.transfer_price,
        mfrs.medicinecode,
        t.classtype,
        t.view_good_name,b.goodsid,b.mfrsid,mfrs.mfrsname
        FROM
        aa_tyj t
        LEFT JOIN c_unit u ON t.unitid = u.unitid
        LEFT JOIN c_brand b ON t.brandnum = b.brandnum
        AND t.`mfrsid` = b.`mfrsid`
        LEFT JOIN c_mfrs mfrs ON t.mfrsid = mfrs.mfrsnum
        <where>
            <if test="producNum != null and producNum != ''">and t.produc_num = #{producNum}</if>
            <if test="producCode != null and producCode != ''">and t.produc_code = #{producCode}</if>
            <if test="producName != null and producName != ''">and p.produc_name LIKE concat(concat('%', #{producName}),'%')</if>
            <if test="mfrsid != null and mfrsid != ''">and t.mfrsid = #{mfrsid}</if>
            <if test="brandid != null and brandid != ''">and t.brandid = #{brandid}</if>
            <if test="brandname != null and brandname != ''">and b.brandname = #{brandname}</if>
            <if test="producFactorycolor != null and producFactorycolor != ''">and t.produc_factorycolor =
                #{producFactorycolor}
            </if>

            <if test="size != null and size != ''">and t.size = #{size}</if>
            <if test="producFactory != null and producFactory != ''">and t.produc_factory = #{producFactory}</if>
            <if test="factory != null and factory != ''">and t.factory = #{factory}</if>

            <if test="retailPrice != null and retailPrice != ''">and ABS(t.retail_price) >= ABS(#{retailPrice})</if>
            <if test="retailPrice2 != null and retailPrice2 != ''">and ABS(t.retail_price) &lt;= ABS(#{retailPrice2})</if>
            <if test="taxPrice != null and taxPrice != ''">and ABS(t.tax_price) >= ABS(#{taxPrice})</if>
            <if test="taxPrice2 != null and taxPrice2 != ''">and ABS(t.tax_price) &lt;= ABS(#{taxPrice2})</if>

            and t.xsstate = 0 and  t.state=1 and mfrs.xsstate=0 and mfrs.state=1 and b.xsstate=0 and b.state=1
        </where>
        <choose>
            <when test="sort != null and sort.trim() != ''">
                order by ${sort} ${order}
            </when>
            <otherwise>
                order by mfrs.mfrsid,b.brandid,t.id
            </otherwise>
        </choose>
        <if test="offset != null and limit != null">
            limit #{offset}, #{limit}
        </if>
    </select>
    <select id="selectTyjCount" resultType="int">
        select count(*)  FROM
        aa_tyj t
        LEFT JOIN c_unit u ON t.unitid = u.unitid
        LEFT JOIN c_brand b ON t.brandnum = b.brandnum
        AND t.`mfrsid` = b.`mfrsid`
        LEFT JOIN c_mfrs mfrs ON t.mfrsid = mfrs.mfrsnum
        <where>
            <if test="producNum != null and producNum != ''">and t.produc_num = #{producNum}</if>
            <if test="producCode != null and producCode != ''">and t.produc_code = #{producCode}</if>
            <if test="producName != null and producName != ''">and p.produc_name LIKE concat(concat('%', #{producName}),'%')</if>
            <if test="mfrsid != null and mfrsid != ''">and t.mfrsid = #{mfrsid}</if>
            <if test="brandid != null and brandid != ''">and t.brandid = #{brandid}</if>
            <if test="brandname != null and brandname != ''">and b.brandname = #{brandname}</if>
            <if test="producFactorycolor != null and producFactorycolor != ''">and t.produc_factorycolor =
                #{producFactorycolor}
            </if>

            <if test="size != null and size != ''">and t.size = #{size}</if>
            <if test="producFactory != null and producFactory != ''">and t.produc_factory = #{producFactory}</if>
            <if test="factory != null and factory != ''">and t.factory = #{factory}</if>

            <if test="retailPrice != null and retailPrice != ''">and ABS(t.retail_price) >= ABS(#{retailPrice})</if>
            <if test="retailPrice2 != null and retailPrice2 != ''">and ABS(t.retail_price) &lt;= ABS(#{retailPrice2})</if>
            <if test="taxPrice != null and taxPrice != ''">and ABS(t.tax_price) >= ABS(#{taxPrice})</if>
            <if test="taxPrice2 != null and taxPrice2 != ''">and ABS(t.tax_price) &lt;= ABS(#{taxPrice2})</if>

            and t.xsstate = 0 and  t.state=1 and mfrs.xsstate=0 and mfrs.state=1 and b.xsstate=0 and b.state=1
        </where>
        order by mfrs.mfrsid,b.brandid,t.id
    </select>
    <select id="selectLhj" resultType="com.shiguang.product.domain.OldlensDO">
        SELECT
        o.produc_num,
        o.produc_name,
        o.produc_code,
        b.brandnum,
        b.brandname,
        o.produc_factory,
        o.factory,
        o.retail_price,
        o.tax_price,
        u.unitname,
        o.old_id,
        o.size,
        o.produc_factorycolor,
        o.trade_price,
        o.transfer_price,
        mfrs.medicinecode,
        o.classtype,
        o.view_good_name,b.goodsid,b.mfrsid,mfrs.mfrsname
        FROM
        aa_oldlens o
        LEFT JOIN c_unit u ON o.unitid = u.unitid
        LEFT JOIN c_brand b ON o.brandnum = b.brandnum
        AND o.`mfrsid` = b.`mfrsid`
        LEFT JOIN c_mfrs mfrs ON o.mfrsid = mfrs.mfrsnum
        <where>
            <if test="producNum != null and producNum != ''">and o.produc_num = #{producNum}</if>
            <if test="producCode != null and producCode != ''">and o.produc_code = #{producCode}</if>
            <if test="producName != null and producName != ''">and p.produc_name LIKE concat(concat('%', #{producName}),'%')</if>
            <if test="mfrsid != null and mfrsid != ''">and o.mfrsid = #{mfrsid}</if>
            <if test="brandid != null and brandid != ''">and o.brandid = #{brandid}</if>
            <if test="brandname != null and brandname != ''">and b.brandname = #{brandname}</if>
            <if test="producFactorycolor != null and producFactorycolor != ''">and o.produc_factorycolor =
                #{producFactorycolor}
            </if>
            <if test="size != null and size != ''">and o.size = #{size}</if>
            <if test="oldId != null and oldId != ''">and o.old_id = #{oldId}</if>
            <if test="producFactory != null and producFactory != ''">and o.produc_factory = #{producFactory}</if>
            <if test="factory != null and factory != ''">and o.factory = #{factory}</if>

            <if test="retailPrice != null and retailPrice != ''">and ABS(o.retail_price) >= ABS(#{retailPrice})</if>
            <if test="retailPrice2 != null and retailPrice2 != ''">and ABS(o.retail_price) &lt;= ABS(#{retailPrice2})</if>
            <if test="taxPrice != null and taxPrice != ''">and ABS(o.tax_price) >= ABS(#{taxPrice})</if>
            <if test="taxPrice2 != null and taxPrice2 != ''">and ABS(o.tax_price) &lt;= ABS(#{taxPrice2})</if>

            and o.xsstate = 0 and  o.state=1 and mfrs.xsstate=0 and mfrs.state=1 and b.xsstate=0 and b.state=1
        </where>
        <choose>
            <when test="sort != null and sort.trim() != ''">
                order by ${sort} ${order}
            </when>
            <otherwise>
                order by mfrs.mfrsid,b.brandid,o.id
            </otherwise>
        </choose>
        <if test="offset != null and limit != null">
            limit #{offset}, #{limit}
        </if>
    </select>
    <select id="selectLhjCount" resultType="int">
        select count(*)  FROM
        aa_oldlens o
        LEFT JOIN c_unit u ON o.unitid = u.unitid
        LEFT JOIN c_brand b ON o.brandnum = b.brandnum
        AND o.`mfrsid` = b.`mfrsid`
        LEFT JOIN c_mfrs mfrs ON o.mfrsid = mfrs.mfrsnum
        <where>
            <if test="producNum != null and producNum != ''">and o.produc_num = #{producNum}</if>
            <if test="producCode != null and producCode != ''">and o.produc_code = #{producCode}</if>
            <if test="producName != null and producName != ''">and p.produc_name LIKE concat(concat('%', #{producName}),'%')</if>
            <if test="mfrsid != null and mfrsid != ''">and o.mfrsid = #{mfrsid}</if>
            <if test="brandid != null and brandid != ''">and o.brandid = #{brandid}</if>
            <if test="brandname != null and brandname != ''">and b.brandname = #{brandname}</if>
            <if test="producFactorycolor != null and producFactorycolor != ''">and o.produc_factorycolor =
                #{producFactorycolor}
            </if>
            <if test="size != null and size != ''">and o.size = #{size}</if>
            <if test="oldId != null and oldId != ''">and o.old_id = #{oldId}</if>
            <if test="producFactory != null and producFactory != ''">and o.produc_factory = #{producFactory}</if>
            <if test="factory != null and factory != ''">and o.factory = #{factory}</if>

            <if test="retailPrice != null and retailPrice != ''">and ABS(o.retail_price) >= ABS(#{retailPrice})</if>
            <if test="retailPrice2 != null and retailPrice2 != ''">and ABS(o.retail_price) &lt;= ABS(#{retailPrice2})</if>
            <if test="taxPrice != null and taxPrice != ''">and ABS(o.tax_price) >= ABS(#{taxPrice})</if>
            <if test="taxPrice2 != null and taxPrice2 != ''">and ABS(o.tax_price) &lt;= ABS(#{taxPrice2})</if>

            and o.xsstate = 0 and  o.state=1 and mfrs.xsstate=0 and mfrs.state=1 and b.xsstate=0 and b.state=1
        </where>
        order by mfrs.mfrsid,b.brandid,o.id
    </select>
    <select id="selectHc" resultType="com.shiguang.product.domain.HcDO">
        select  h.produc_num,h.produc_name, h.produc_code, b.brandnum,b.brandname,u.unitname,h.retail_price,h.tax_price,h.produc_factory,
        h.produc_factory as factoty,
        h.trade_price,h.transfer_price,mfrs.medicinecode ,h.classtype,h.view_good_name,b.goodsid,b.mfrsid,mfrs.mfrsname
        from aa_hc h left join c_unit u on h.unitid=u.unitid
        left join c_brand b on h.brandnum=b.brandnum  AND h.`mfrsid`=b.`mfrsid`
        left join c_mfrs mfrs on h.mfrsid=mfrs.mfrsnum
        <where>
            <if test="producNum != null and producNum != ''">and h.produc_num = #{producNum}</if>
            <if test="producCode != null and producCode != ''">and h.produc_code = #{producCode}</if>
            <if test="producName != null and producName != ''">and p.produc_name LIKE concat(concat('%', #{producName}),'%')</if>
            <if test="mfrsid != null and mfrsid != ''">and h.mfrsid = #{mfrsid}</if>
            <if test="brandid != null and brandid != ''">and h.brandid = #{brandid}</if>
            <if test="brandname != null and brandname != ''">and b.brandname = #{brandname}</if>
            <if test="producFactory != null and producFactory != ''">and h.produc_factory = #{producFactory}</if>
            <if test="factory != null and factory != ''">and h.factory = #{factory}</if>

            <if test="retailPrice != null and retailPrice != ''">and ABS(h.retail_price) >= ABS(#{retailPrice})</if>
            <if test="retailPrice2 != null and retailPrice2 != ''">and ABS(h.retail_price) &lt;= ABS(#{retailPrice2})</if>
            <if test="taxPrice != null and taxPrice != ''">and ABS(h.tax_price) >= ABS(#{taxPrice})</if>
            <if test="taxPrice2 != null and taxPrice2 != ''">and ABS(h.tax_price) &lt;= ABS(#{taxPrice2})</if>

            and h.xsstate = 0 and  h.state=1 and mfrs.xsstate=0 and mfrs.state=1 and b.xsstate=0 and b.state=1
        </where>
        <choose>
            <when test="sort != null and sort.trim() != ''">
                order by ${sort} ${order}
            </when>
            <otherwise>
                order by mfrs.mfrsid,b.brandid,h.id
            </otherwise>
        </choose>
        <if test="offset != null and limit != null">
            limit #{offset}, #{limit}
        </if>
    </select>
    <select id="selectHcCount" resultType="int">
        select count(*)  from aa_hc h left join c_unit u on h.unitid=u.unitid
        left join c_brand b on h.brandnum=b.brandnum  AND h.`mfrsid`=b.`mfrsid`
        left join c_mfrs mfrs on h.mfrsid=mfrs.mfrsnum
        <where>
            <if test="producNum != null and producNum != ''">and h.produc_num = #{producNum}</if>
            <if test="producCode != null and producCode != ''">and h.produc_code = #{producCode}</if>
            <if test="producName != null and producName != ''">and p.produc_name LIKE concat(concat('%', #{producName}),'%')</if>
            <if test="mfrsid != null and mfrsid != ''">and h.mfrsid = #{mfrsid}</if>
            <if test="brandid != null and brandid != ''">and h.brandid = #{brandid}</if>
            <if test="brandname != null and brandname != ''">and b.brandname = #{brandname}</if>
            <if test="producFactory != null and producFactory != ''">and h.produc_factory = #{producFactory}</if>
            <if test="factory != null and factory != ''">and h.factory = #{factory}</if>

            <if test="retailPrice != null and retailPrice != ''">and ABS(h.retail_price) >= ABS(#{retailPrice})</if>
            <if test="retailPrice2 != null and retailPrice2 != ''">and ABS(h.retail_price) &lt;= ABS(#{retailPrice2})</if>
            <if test="taxPrice != null and taxPrice != ''">and ABS(h.tax_price) >= ABS(#{taxPrice})</if>
            <if test="taxPrice2 != null and taxPrice2 != ''">and ABS(h.tax_price) &lt;= ABS(#{taxPrice2})</if>

            and h.xsstate = 0 and  h.state=1 and mfrs.xsstate=0 and mfrs.state=1 and b.xsstate=0 and b.state=1
        </where>
        order by mfrs.mfrsid,b.brandid,h.id
    </select>
    <select id="selectSg" resultType="com.shiguang.product.domain.ShiguangDO">
        select
        s.produc_num,s.produc_name, s.produc_code, b.brandnum,b.brandname,s.factory,s.produc_factory,u.unitname,s.retail_price,s.tax_price,
        s.trade_price,s.transfer_price,mfrs.medicinecode,s.classtype,s.view_good_name,b.goodsid,b.mfrsid,mfrs.mfrsname
        from aa_shiguang s left join c_unit u on s.unitid=u.unitid
        left join c_brand b on s.brandnum=b.brandnum  AND s.`mfrsid`=b.`mfrsid`
        left join c_mfrs mfrs on s.mfrsid=mfrs.mfrsnum
        <where>
            <if test="producNum != null and producNum != ''">and s.produc_num = #{producNum}</if>
            <if test="producCode != null and producCode != ''">and s.produc_code = #{producCode}</if>
            <if test="producName != null and producName != ''">and p.produc_name LIKE concat(concat('%', #{producName}),'%')</if>
            <if test="mfrsid != null and mfrsid != ''">and s.mfrsid = #{mfrsid}</if>
            <if test="mfrsname != null and mfrsname != ''">and mfrs.mfrsname = #{mfrsname}</if>
            <if test="brandid != null and brandid != ''">and s.brandid = #{brandid}</if>
            <if test="brandname != null and brandname != ''">and b.brandname = #{brandname}</if>
            <if test="producFactory != null and producFactory != ''">and s.produc_factory = #{producFactory}</if>
            <if test="factory != null and factory != ''">and s.factory = #{factory}</if>

            <if test="retailPrice != null and retailPrice != ''">and ABS(s.retail_price) >= ABS(#{retailPrice})</if>
            <if test="retailPrice2 != null and retailPrice2 != ''">and ABS(s.retail_price) &lt;= ABS(#{retailPrice2})</if>
            <if test="taxPrice != null and taxPrice != ''">and ABS(s.tax_price) >= ABS(#{taxPrice})</if>
            <if test="taxPrice2 != null and taxPrice2 != ''">and ABS(s.tax_price) &lt;= ABS(#{taxPrice2})</if>

            and s.xsstate = 0 and  s.state=1 and mfrs.xsstate=0 and mfrs.state=1 and b.xsstate=0 and b.state=1
        </where>
        <choose>
            <when test="sort != null and sort.trim() != ''">
                order by ${sort} ${order}
            </when>
            <otherwise>
                order by mfrs.mfrsid,b.brandid,s.id
            </otherwise>
        </choose>
        <if test="offset != null and limit != null">
            limit #{offset}, #{limit}
        </if>
    </select>
    <select id="selectSgCount" resultType="int">
        select count(*)   from aa_shiguang s left join c_unit u on s.unitid=u.unitid
        left join c_brand b on s.brandnum=b.brandnum  AND s.`mfrsid`=b.`mfrsid`
        left join c_mfrs mfrs on s.mfrsid=mfrs.mfrsnum
        <where>
            <if test="producNum != null and producNum != ''">and s.produc_num = #{producNum}</if>
            <if test="producCode != null and producCode != ''">and s.produc_code = #{producCode}</if>
            <if test="producName != null and producName != ''">and p.produc_name LIKE concat(concat('%', #{producName}),'%')</if>
            <if test="mfrsid != null and mfrsid != ''">and s.mfrsid = #{mfrsid}</if>
            <if test="mfrsname != null and mfrsname != ''">and mfrs.mfrsname = #{mfrsname}</if>
            <if test="brandid != null and brandid != ''">and s.brandid = #{brandid}</if>
            <if test="brandname != null and brandname != ''">and b.brandname = #{brandname}</if>
            <if test="producFactory != null and producFactory != ''">and s.produc_factory = #{producFactory}</if>
            <if test="factory != null and factory != ''">and s.factory = #{factory}</if>


            <if test="retailPrice != null and retailPrice != ''">and ABS(s.retail_price) >= ABS(#{retailPrice})</if>
            <if test="retailPrice2 != null and retailPrice2 != ''">and ABS(s.retail_price) &lt;= ABS(#{retailPrice2})</if>
            <if test="taxPrice != null and taxPrice != ''">and ABS(s.tax_price) >= ABS(#{taxPrice})</if>
            <if test="taxPrice2 != null and taxPrice2 != ''">and ABS(s.tax_price) &lt;= ABS(#{taxPrice2})</if>

            and s.xsstate = 0 and  s.state=1 and mfrs.xsstate=0 and mfrs.state=1 and b.xsstate=0 and b.state=1
        </where>
        order by mfrs.mfrsid,b.brandid,s.id
    </select>

    <select id="selectSgdz" resultType="com.shiguang.product.domain.ShiguangdzDO">
        select
        s.produc_num,s.produc_name, s.produc_code, b.brandnum,b.brandname,s.factory,s.produc_factory,u.unitname,s.retail_price,s.tax_price,
        s.trade_price,s.transfer_price,mfrs.medicinecode,s.classtype,s.view_good_name,b.goodsid,b.mfrsid,mfrs.mfrsname
        from aa_shiguangdz s left join c_unit u on s.unitid=u.unitid
        left join c_brand b on s.brandnum=b.brandnum  AND s.`mfrsid`=b.`mfrsid`
        left join c_mfrs mfrs on s.mfrsid=mfrs.mfrsnum
        <where>
            <if test="producNum != null and producNum != ''">and s.produc_num = #{producNum}</if>
            <if test="producCode != null and producCode != ''">and s.produc_code = #{producCode}</if>
            <if test="producName != null and producName != ''">and p.produc_name LIKE concat(concat('%', #{producName}),'%')</if>
            <if test="mfrsid != null and mfrsid != ''">and s.mfrsid = #{mfrsid}</if>
            <if test="mfrsname != null and mfrsname != ''">and mfrs.mfrsname = #{mfrsname}</if>
            <if test="brandid != null and brandid != ''">and s.brandid = #{brandid}</if>
            <if test="brandname != null and brandname != ''">and b.brandname = #{brandname}</if>
            <if test="producFactory != null and producFactory != ''">and s.produc_factory = #{producFactory}</if>
            <if test="factory != null and factory != ''">and s.factory = #{factory}</if>

            <if test="retailPrice != null and retailPrice != ''">and ABS(s.retail_price) >= ABS(#{retailPrice})</if>
            <if test="retailPrice2 != null and retailPrice2 != ''">and ABS(s.retail_price) &lt;= ABS(#{retailPrice2})</if>
            <if test="taxPrice != null and taxPrice != ''">and ABS(s.tax_price) >= ABS(#{taxPrice})</if>
            <if test="taxPrice2 != null and taxPrice2 != ''">and ABS(s.tax_price) &lt;= ABS(#{taxPrice2})</if>

            and s.xsstate = 0 and  s.state=1 and mfrs.xsstate=0 and mfrs.state=1 and b.xsstate=0 and b.state=1
        </where>
        <choose>
            <when test="sort != null and sort.trim() != ''">
                order by ${sort} ${order}
            </when>
            <otherwise>
                order by mfrs.mfrsid,b.brandid,s.id
            </otherwise>
        </choose>
        <if test="offset != null and limit != null">
            limit #{offset}, #{limit}
        </if>
    </select>
    <select id="selectSgdzCount" resultType="int">
        select count(*)   from aa_shiguangdz s left join c_unit u on s.unitid=u.unitid
        left join c_brand b on s.brandnum=b.brandnum  AND s.`mfrsid`=b.`mfrsid`
        left join c_mfrs mfrs on s.mfrsid=mfrs.mfrsnum
        <where>
            <if test="producNum != null and producNum != ''">and s.produc_num = #{producNum}</if>
            <if test="producCode != null and producCode != ''">and s.produc_code = #{producCode}</if>
            <if test="producName != null and producName != ''">and p.produc_name LIKE concat(concat('%', #{producName}),'%')</if>
            <if test="mfrsid != null and mfrsid != ''">and s.mfrsid = #{mfrsid}</if>
            <if test="mfrsname != null and mfrsname != ''">and mfrs.mfrsname = #{mfrsname}</if>
            <if test="brandid != null and brandid != ''">and s.brandid = #{brandid}</if>
            <if test="brandname != null and brandname != ''">and b.brandname = #{brandname}</if>
            <if test="producFactory != null and producFactory != ''">and s.produc_factory = #{producFactory}</if>
            <if test="factory != null and factory != ''">and s.factory = #{factory}</if>


            <if test="retailPrice != null and retailPrice != ''">and ABS(s.retail_price) >= ABS(#{retailPrice})</if>
            <if test="retailPrice2 != null and retailPrice2 != ''">and ABS(s.retail_price) &lt;= ABS(#{retailPrice2})</if>
            <if test="taxPrice != null and taxPrice != ''">and ABS(s.tax_price) >= ABS(#{taxPrice})</if>
            <if test="taxPrice2 != null and taxPrice2 != ''">and ABS(s.tax_price) &lt;= ABS(#{taxPrice2})</if>

            and s.xsstate = 0 and  s.state=1 and mfrs.xsstate=0 and mfrs.state=1 and b.xsstate=0 and b.state=1
        </where>
        order by mfrs.mfrsid,b.brandid,s.id
    </select>

    <select id="haveNum" resultType="com.shiguang.stock.domain.StockDO">
        select  * from stock
         <where>
             <if test="goodsNum != null and goodsNum != ''">and goods_num = #{goodsNum}</if>
             <if test="goodsCode != null and goodsCode != ''">and goods_code = #{goodsCode}</if>
             <if test="positionName != null and positionName != ''">and position_name = #{positionName}</if>
             <if test="positionId != null and positionId != ''">and position_id = #{positionId}</if>
             <!--<if test="mfrsid != null and mfrsid != ''">and mfrsid = #{mfrsid}</if>-->
             <!--<if test="brandname != null and brandname != ''">and brandname = #{brandname}</if>-->
             <if test="useday != null and useday != ''">and useday = #{useday}</if>
             <if test="batch != null and batch != ''">and batch = #{batch}</if>
         </where>
        order by id
    </select>

    <select id="haveCountNum" resultType="com.shiguang.stock.domain.StockDO">
        select  * from stock
        <where>
            <if test="goodsNum != null and goodsNum != ''">and goods_num = #{goodsNum}</if>
            <if test="goodsCode != null and goodsCode != ''">and goods_code = #{goodsCode}</if>
            <if test="positionName != null and positionName != ''">and position_name = #{positionName}</if>
            <if test="positionId != null and positionId != ''">and position_id = #{positionId}</if>
            <!--<if test="mfrsid != null and mfrsid != ''">and mfrsid = #{mfrsid}</if>-->
            <!--<if test="brandname != null and brandname != ''">and brandname = #{brandname}</if>-->
            <if test="useday != null and useday != ''">and useday = #{useday}</if>
            <if test="batch != null and batch != ''">and batch = #{batch}</if>
            and goods_count > 0
        </where>
        order by id
    </select>

    <select id="kccxList" resultType="com.shiguang.stock.domain.StockDO">
    SELECT
    s.danju_number,
    s.goods_num,
    s.goods_code,
    s.goods_name,
    s.goods_count,
    g.goodsname AS 'gdname',
    g.goodsid,
    m.mfrsname,
    s.brandname,
    s.retail_price,
    s.price_sum,
    s.cost_price,
    s.cost_sum,
    s.whole_price,
    s.whole_sum,
    po.position_name,
    s.batch,
    s.zhuce_number,
    s.produce_day,
    s.useday,
    s.factory,
    s.mfrsid,
    s.unit,
    s.classtype,
    s.returnzt,
    jj.produc_factorycolor AS jjColor,
    jpcp.sph_id AS jpcpSph,
    jpcp.cyl_id AS jpcpCyl,
    jpdz.sph_up AS jpcpSphUp,
    jpdz.sph_down AS jpcpSphDown,
    jpdz.cyl_up AS jpcpCylUp,
    jpdz.cyl_down AS jpcpCylDown,
    yxcp.sph_id AS yxcpSph,
    yxcp.cyl_id AS yxcpCyl,
    yxdz.sph_up AS yxdzSphUp,
    yxdz.sph_down AS yxdzSphDown,
    yxdz.cyl_up AS yxdzCylUp,
    yxdz.cyl_down AS yxdzCylDown,
    tyj.produc_factorycolor AS tyjColor,
    lhj.old_id AS lhjSph
    FROM
    stock s
    LEFT JOIN c_goods g ON s.goods_type = g.goodsid
    LEFT JOIN c_mfrs m ON s.mfrsid = m.mfrsnum
    LEFT JOIN c_position po ON s.position_id = po.position_id
    LEFT JOIN c_brand b ON s.brandname = b.brandname AND s.`mfrsid` = b.`mfrsid`
    LEFT JOIN department d ON po.depart_number = d.depart_number  and po.company_id=d.company_id
    LEFT JOIN aa_produca jj ON jj.produc_num = s.goods_num
    LEFT JOIN aa_parts pj ON pj.produc_num = s.goods_num

    LEFT JOIN aa_jpcp jpcp ON jpcp.produc_num = s.goods_num
    LEFT JOIN aa_jpdz jpdz ON jpdz.produc_num = s.goods_num
    LEFT JOIN aa_yxcp yxcp ON yxcp.produc_num = s.goods_num
    LEFT JOIN aa_yxdz yxdz ON yxdz.produc_num = s.goods_num
    LEFT JOIN aa_tyj tyj ON tyj.produc_num = s.goods_num
    LEFT JOIN aa_oldlens lhj ON lhj.produc_num = s.goods_num
    <where>

        <if test="goodsNum != null and goodsNum != ''">and  s.goods_num  LIKE concat(concat('%', #{goodsNum}),'%')</if>
        <if test="goodsCode != null and goodsCode != ''">and  s.goods_code  LIKE concat(concat('%', #{goodsCode}),'%')</if>


        <if test="goodsName != null and goodsName != ''">and  s.goods_name LIKE concat(concat('%', #{goodsName}),'%')</if>
    <if test="goodsType != null and goodsType != ''">and s.goods_type = #{goodsType}</if>

    <if test="mfrsname != null and mfrsname != ''">and m.mfrsname = #{mfrsname}</if>
    <if test="brandname != null and brandname != ''">and s.brandname = #{brandname}</if>

    <if test="retailPrice != null and retailPrice != ''">and ABS(s.retail_price) >= ABS(#{retailPrice})</if>
    <if test="retailPrice2 != null and retailPrice2 != ''">and ABS(s.retail_price) &lt;= ABS(#{retailPrice2})</if>

    <if test="xsstate != null and xsstate != ''">and po.xsstate = #{xsstate}</if>
    <if test="positionId != null and positionId != ''">and po.position_id = #{positionId}</if>
    <if test="positionName != null and positionName != ''">and po.position_name = #{positionName}</if>
    <if test="departNumber != null and departNumber != ''">and po.depart_number = #{departNumber}</if>
    <if test="companyId != null and companyId != ''">and FIND_IN_SET(d.company_id,#{companyId})</if>
    <if test="classtype != null and classtype != ''">and s.classtype = #{classtype}</if>
    <if test="status != null and status != ''">and s.status = #{status}</if>
    <if test="outPosition != null and outPosition != ''">and  po.position_id  = #{outPosition}</if>


        <if test="kccount0 != null and kccount0 != ''">and  s.goods_count = #{kccount0}</if>
        <if test="kccount1 != null and kccount1 != ''">and  s.goods_count > #{kccount1}</if>
        <if test="kccount2 != null and kccount2 != ''">and  s.goods_count &lt; #{kccount2}</if>

        <if test="factory != null and factory != ''">and s.factory LIKE concat(concat('%', #{factory}),'%')</if>
        <if test="(factoryColor != null and factoryColor != '') ">
           and (
            jj.produc_factorycolor LIKE concat(concat('%', #{factoryColor}),'%')
            or tyj.produc_factorycolor LIKE concat(concat('%', #{factoryColor}),'%')
            or lhj.produc_factorycolor LIKE concat(concat('%', #{factoryColor}),'%')
            )
        </if>

        <if test="(sph != null and sph != '') or (sph2 != null and sph2 != '')   ">
          and  (
            jpcp.sph_id between #{sph,jdbcType=VARCHAR} and (#{sph2,jdbcType=VARCHAR})
            or yxcp.sph_id between #{sph,jdbcType=VARCHAR} and (#{sph2,jdbcType=VARCHAR})
            )
        </if>
        <if test="(cyl != null and cyl != '') or (cyl2 != null and cyl2 != '')   ">
            and  (
            jpcp.cyl_id between #{cyl,jdbcType=VARCHAR} and #{cyl2,jdbcType=VARCHAR}
            or    yxcp.cyl_id between #{cyl,jdbcType=VARCHAR} and #{cyl2,jdbcType=VARCHAR}
            )
        </if>


        <if test="(refractivityid != null and refractivityid != '') ">
            and (
            pj.refractivityid LIKE concat(concat('%', #{refractivityid}),'%')
            or jpcp.refractivityid LIKE concat(concat('%', #{refractivityid}),'%')
            or jpdz.refractivityid LIKE concat(concat('%', #{refractivityid}),'%')
            )
        </if>



    </where>
    <choose>
    <when test="sort != null and sort.trim() != ''">
    order by ${sort} ${order}
    </when>
    <otherwise>
        order by  po.state_id ,s.position_id,m.mfrsid,b.brandid
    </otherwise>
    </choose>
    <if test="offset != null and limit != null">
    limit #{offset}, #{limit}
    </if>
    </select>
    <select id="countall" resultType="int">
        SELECT ifnull(sum(s.goods_count),0)  FROM
        stock s
        LEFT JOIN c_goods g ON s.goods_type = g.goodsid
        LEFT JOIN c_mfrs m ON s.mfrsid = m.mfrsnum
        LEFT JOIN c_position po ON s.position_id = po.position_id
        LEFT JOIN c_brand b ON s.brandname = b.brandname AND s.`mfrsid` = b.`mfrsid`
        LEFT JOIN department d ON po.depart_number = d.depart_number  and po.company_id=d.company_id
        LEFT JOIN aa_produca jj ON jj.produc_num = s.goods_num
        LEFT JOIN aa_parts pj ON pj.produc_num = s.goods_num

        LEFT JOIN aa_jpcp jpcp ON jpcp.produc_num = s.goods_num
        LEFT JOIN aa_jpdz jpdz ON jpdz.produc_num = s.goods_num
        LEFT JOIN aa_yxcp yxcp ON yxcp.produc_num = s.goods_num
        LEFT JOIN aa_yxdz yxdz ON yxdz.produc_num = s.goods_num
        LEFT JOIN aa_tyj tyj ON tyj.produc_num = s.goods_num
        LEFT JOIN aa_oldlens lhj ON lhj.produc_num = s.goods_num
        <where>

            <if test="goodsNum != null and goodsNum != ''">and  s.goods_num  LIKE concat(concat('%', #{goodsNum}),'%')</if>
            <if test="goodsCode != null and goodsCode != ''">and  s.goods_code  LIKE concat(concat('%', #{goodsCode}),'%')</if>


            <if test="goodsName != null and goodsName != ''">and  s.goods_name LIKE concat(concat('%', #{goodsName}),'%')</if>
            <if test="goodsType != null and goodsType != ''">and s.goods_type = #{goodsType}</if>

            <if test="mfrsname != null and mfrsname != ''">and m.mfrsname = #{mfrsname}</if>
            <if test="brandname != null and brandname != ''">and s.brandname = #{brandname}</if>

            <if test="retailPrice != null and retailPrice != ''">and ABS(s.retail_price) >= ABS(#{retailPrice})</if>
            <if test="retailPrice2 != null and retailPrice2 != ''">and ABS(s.retail_price) &lt;= ABS(#{retailPrice2})</if>

            <if test="xsstate != null and xsstate != ''">and po.xsstate = #{xsstate}</if>
            <if test="positionId != null and positionId != ''">and po.position_id = #{positionId}</if>
            <if test="positionName != null and positionName != ''">and po.position_name = #{positionName}</if>
            <if test="departNumber != null and departNumber != ''">and po.depart_number = #{departNumber}</if>
            <if test="companyId != null and companyId != ''">and FIND_IN_SET(d.company_id,#{companyId})</if>
            <if test="classtype != null and classtype != ''">and s.classtype = #{classtype}</if>
            <if test="status != null and status != ''">and s.status = #{status}</if>
            <if test="outPosition != null and outPosition != ''">and  po.position_id  = #{outPosition}</if>

            <if test="kccount0 != null and kccount0 != ''">and  s.goods_count = #{kccount0}</if>
            <if test="kccount1 != null and kccount1 != ''">and  s.goods_count > #{kccount1}</if>
            <if test="kccount2 != null and kccount2 != ''">and  s.goods_count &lt; #{kccount2}</if>



            <if test="factory != null and factory != ''">and s.factory LIKE concat(concat('%', #{factory}),'%')</if>
            <if test="(factoryColor != null and factoryColor != '') ">
              and  (
                jj.produc_factorycolor LIKE concat(concat('%', #{factoryColor}),'%')
                or tyj.produc_factorycolor LIKE concat(concat('%', #{factoryColor}),'%')
                or lhj.produc_factorycolor LIKE concat(concat('%', #{factoryColor}),'%')
                )
            </if>



            <if test="(sph != null and sph != '') or (sph2 != null and sph2 != '')   ">
                and  (
                jpcp.sph_id between #{sph,jdbcType=VARCHAR} and (#{sph2,jdbcType=VARCHAR})
                or yxcp.sph_id between #{sph,jdbcType=VARCHAR} and (#{sph2,jdbcType=VARCHAR})
                )
            </if>
            <if test="(cyl != null and cyl != '') or (cyl2 != null and cyl2 != '')   ">
                and  (
                jpcp.cyl_id between #{cyl,jdbcType=VARCHAR} and #{cyl2,jdbcType=VARCHAR}
                or    yxcp.cyl_id between #{cyl,jdbcType=VARCHAR} and #{cyl2,jdbcType=VARCHAR}
                )
            </if>

            <if test="(refractivityid != null and refractivityid != '') ">
                and (
                pj.refractivityid LIKE concat(concat('%', #{refractivityid}),'%')
                or jpcp.refractivityid LIKE concat(concat('%', #{refractivityid}),'%')
                or jpdz.refractivityid LIKE concat(concat('%', #{refractivityid}),'%')
                )
            </if>
        </where>
    </select>
    <select id="kccxListCount" resultType="int">
        select count(*)  FROM
        stock s
        LEFT JOIN c_goods g ON s.goods_type = g.goodsid
        LEFT JOIN c_mfrs m ON s.mfrsid = m.mfrsnum
        LEFT JOIN c_position po ON s.position_id = po.position_id
        LEFT JOIN c_brand b ON s.brandname = b.brandname AND s.`mfrsid` = b.`mfrsid`
        LEFT JOIN department d ON po.depart_number = d.depart_number  and po.company_id=d.company_id
        LEFT JOIN aa_produca jj ON jj.produc_num = s.goods_num
        LEFT JOIN aa_parts pj ON pj.produc_num = s.goods_num

        LEFT JOIN aa_jpcp jpcp ON jpcp.produc_num = s.goods_num
        LEFT JOIN aa_jpdz jpdz ON jpdz.produc_num = s.goods_num
        LEFT JOIN aa_yxcp yxcp ON yxcp.produc_num = s.goods_num
        LEFT JOIN aa_yxdz yxdz ON yxdz.produc_num = s.goods_num
        LEFT JOIN aa_tyj tyj ON tyj.produc_num = s.goods_num
        LEFT JOIN aa_oldlens lhj ON lhj.produc_num = s.goods_num
        <where>

            <if test="goodsNum != null and goodsNum != ''">and  s.goods_num  LIKE concat(concat('%', #{goodsNum}),'%')</if>
            <if test="goodsCode != null and goodsCode != ''">and  s.goods_code  LIKE concat(concat('%', #{goodsCode}),'%')</if>


            <if test="goodsName != null and goodsName != ''">and  s.goods_name LIKE concat(concat('%', #{goodsName}),'%')</if>
            <if test="goodsType != null and goodsType != ''">and s.goods_type = #{goodsType}</if>

            <if test="mfrsname != null and mfrsname != ''">and m.mfrsname = #{mfrsname}</if>
            <if test="brandname != null and brandname != ''">and s.brandname = #{brandname}</if>

            <if test="retailPrice != null and retailPrice != ''">and ABS(s.retail_price) >= ABS(#{retailPrice})</if>
            <if test="retailPrice2 != null and retailPrice2 != ''">and ABS(s.retail_price) &lt;= ABS(#{retailPrice2})</if>

            <if test="xsstate != null and xsstate != ''">and po.xsstate = #{xsstate}</if>
            <if test="positionId != null and positionId != ''">and po.position_id = #{positionId}</if>
            <if test="positionName != null and positionName != ''">and po.position_name = #{positionName}</if>
            <if test="departNumber != null and departNumber != ''">and po.depart_number = #{departNumber}</if>
            <if test="companyId != null and companyId != ''">and FIND_IN_SET(d.company_id,#{companyId})</if>
            <if test="classtype != null and classtype != ''">and s.classtype = #{classtype}</if>
            <if test="status != null and status != ''">and s.status = #{status}</if>
            <if test="outPosition != null and outPosition != ''">and  po.position_id  = #{outPosition}</if>

            <if test="kccount0 != null and kccount0 != ''">and  s.goods_count = #{kccount0}</if>
            <if test="kccount1 != null and kccount1 != ''">and  s.goods_count > #{kccount1}</if>
            <if test="kccount2 != null and kccount2 != ''">and  s.goods_count &lt; #{kccount2}</if>


            <if test="factory != null and factory != ''">and s.factory LIKE concat(concat('%', #{factory}),'%')</if>
            <if test="(factoryColor != null and factoryColor != '') ">
                and (
                jj.produc_factorycolor LIKE concat(concat('%', #{factoryColor}),'%')
                or tyj.produc_factorycolor LIKE concat(concat('%', #{factoryColor}),'%')
                or lhj.produc_factorycolor LIKE concat(concat('%', #{factoryColor}),'%')
                )
            </if>


            <if test="(sph != null and sph != '') or (sph2 != null and sph2 != '')   ">
                and  (
                jpcp.sph_id between #{sph,jdbcType=VARCHAR} and (#{sph2,jdbcType=VARCHAR})
                or yxcp.sph_id between #{sph,jdbcType=VARCHAR} and (#{sph2,jdbcType=VARCHAR})
                )
            </if>
            <if test="(cyl != null and cyl != '') or (cyl2 != null and cyl2 != '')   ">
                and  (
                  jpcp.cyl_id between #{cyl,jdbcType=VARCHAR} and #{cyl2,jdbcType=VARCHAR}
                or    yxcp.cyl_id between #{cyl,jdbcType=VARCHAR} and #{cyl2,jdbcType=VARCHAR}
                )
            </if>


            <if test="(refractivityid != null and refractivityid != '') ">
                and (
                pj.refractivityid LIKE concat(concat('%', #{refractivityid}),'%')
                or jpcp.refractivityid LIKE concat(concat('%', #{refractivityid}),'%')
                or jpdz.refractivityid LIKE concat(concat('%', #{refractivityid}),'%')
                )
            </if>
        </where>
    </select>

































    <update id="updateStatus" parameterType="com.shiguang.stock.domain.StockDO">
        update stock
        <set>
            <if test="status != null">`status` = #{status}, </if>
            <if test="username != null">`username` = #{username} ,</if>
            <if test="zhidanPeople != null">`zhidan_people` = #{zhidanPeople} </if>
        </set>
        where danju_number = #{danjuNumber}
    </update>
    <update id="outPosionJ" parameterType="com.shiguang.stock.domain.StockDO">
        update stock
        <set>
            <if test="status != null">`status` = #{status}, </if>
            <if test="username != null">`username` = #{username} </if>
        </set>
    </update>
    <select id="getOeder" resultType="com.shiguang.stock.domain.OrderDO">
          select m.mfrsname,o.danju_number,d.depart_name,o.danju_day,d.depart_tel,d.depart_address,o.zhidan_people,o.goods_type
          from stock_order o
          left join c_mfrs m on o.mfrsid=m.mfrsnum
          left join c_position p on o.position_id=p.position_id
          left join  department d on p.depart_number=d.depart_number
          where o.danju_number = #{value}
		  group by o.danju_number
    </select>

    <select id="getOederList" resultType="com.shiguang.stock.domain.OrderDO">
        SELECT
        g.goodsname AS gdname,
        o.goods_name,
        o.factory,
        produca.produc_factorycolor,
        o.retail_price,
        o.goods_count,
        o.beizhu,
        o.unit,
        jpcp.sph_id AS jscpsph,
        jpcp.cyl_id AS jpcpcyl,
        yxcp.sph_id AS yxcpsph,
        yxcp.cyl_id AS yxcpcyl,
        tyj.produc_factorycolor AS tyjproducfactorycolor,
        old.produc_factorycolor AS oldproducfactorycolor
        FROM
        stock_order o
        LEFT JOIN c_goods g ON o.goods_type = g.goodsid
        LEFT JOIN aa_produca produca ON o.goodsxinxiid = produca.id
        LEFT JOIN aa_parts parts ON o.goodsxinxiid = parts.id
        LEFT JOIN aa_jpcp jpcp ON o.goodsxinxiid = jpcp.id
        LEFT JOIN aa_yxcp yxcp ON o.goodsxinxiid = yxcp.id
        LEFT JOIN aa_hly h ON o.goodsxinxiid = h.id
        LEFT JOIN aa_tyj tyj ON o.goodsxinxiid = tyj.id
        LEFT JOIN aa_oldlens old ON o.goodsxinxiid = old.id
        <where>
            <if test="danjuNumber != null and danjuNumber != ''">and o.danju_number = #{danjuNumber}</if>
            <if test="goodsType != null and goodsType != ''">and o.goods_type = #{goodsType}</if>
        </where>
    </select>
    <select id="getShouhuo" resultType="com.shiguang.stock.domain.OrderDO">
          select m.mfrsname,o.danju_number,d.depart_name,o.danju_day,d.depart_tel,d.depart_address,o.zhidan_people,o.goods_type,o.beizhu
          from stock_order o
          left join c_mfrs m on o.mfrsid=m.mfrsnum
          left join c_position p on o.position_id=p.position_id
          left join  department d on p.depart_number=d.depart_number
          where o.danju_number = #{value}
		  group by o.danju_number
    </select>
    <select id="getShouhuoList" resultType="com.shiguang.stock.domain.OrderDO">
        select o.goods_num ,o.goods_code,o.goods_name,o.goods_count,p.position_name
        from stock_order o left join c_position p on o.position_id=p.position_id
        <where>
            <if test="danjuNumber != null and danjuNumber != ''">and o.danju_number = #{danjuNumber}</if>
            <if test="goodsType != null and goodsType != ''">and o.goods_type = #{goodsType}</if>
        </where>
    </select>
    <select id="jingjias" resultType="com.shiguang.stock.domain.StockDO">
        SELECT
	a.produc_num,
	a.view_good_name,
	a.produc_code,
	a.mfrsid,
	a.brandnum,
	b.brandname,
	a.retail_price,
	a.tax_price,
	a.trade_price,
	a.transfer_price,
	a.unitid,
	u.unitname,
	a.produc_factory,
	a.produc_factorycolor,
	a.classtype,
	m.medicinecode
FROM
	aa_produca a
	JOIN c_brand b ON b.brandnum = a.brandnum
	AND a.mfrsid = b.mfrsid
	JOIN c_unit u ON a.unitid = u.unitid
	JOIN c_mfrs m ON a.mfrsid = m.mfrsnum
        where a.produc_num=#{goodsNum}
    </select>
    <select id="peijians" resultType="com.shiguang.stock.domain.StockDO">
        select a.produc_num,a.produc_code,a.view_good_name,a.mfrsid,a.brandnum,b.brandname,
        a.retail_price,a.tax_price,a.trade_price,a.transfer_price,
        a.unitid,u.unitname,a.produc_factory,a.classtype,m.medicinecode
        from aa_parts a
        join c_brand b on b.brandnum=a.brandnum and a.mfrsid=b.mfrsid
        join c_unit u on a.unitid=u.unitid
        join c_mfrs m on a.mfrsid=m.mfrsnum
        where a.produc_num=#{goodsNum}
    </select>
    <select id="jingpians" resultType="com.shiguang.stock.domain.StockDO">
       select a.produc_num,a.produc_code,a.view_good_name,a.sph_id as sph,a.cyl_id as cyl,  a.mfrsid,a.brandnum,b.brandname,
        a.retail_price,a.tax_price,a.trade_price,a.transfer_price,
        a.unitid,u.unitname,a.produc_factory,a.classtype,m.medicinecode
        from aa_jpcp a
        join c_brand b on b.brandnum=a.brandnum and a.mfrsid=b.mfrsid
        join c_unit u on a.unitid=u.unitid
        join c_mfrs m on a.mfrsid=m.mfrsnum
        where a.produc_num=#{goodsNum}
    </select>
    <select id="jingpiandzs" resultType="com.shiguang.stock.domain.StockDO">
         select a.produc_num,a.produc_code,a.view_good_name,a.sph_up,a.sph_down,a.cyl_up,a.cyl_down,
				a.mfrsid,a.brandnum,b.brandname,
        a.retail_price,a.tax_price,a.trade_price,a.transfer_price,
        a.unitid,u.unitname,a.produc_factory,a.classtype,m.medicinecode
        from aa_jpdz a
        join c_brand b on b.brandnum=a.brandnum and a.mfrsid=b.mfrsid
        join c_unit u on a.unitid=u.unitid
        join c_mfrs m on a.mfrsid=m.mfrsnum
        where a.produc_num=#{goodsNum}
    </select>
    <select id="yinxings" resultType="com.shiguang.stock.domain.StockDO">
        select a.produc_num,a.produc_code,a.view_good_name,a.sph_id as sph,a.cyl_id as cyl,a.mfrsid,a.brandnum,b.brandname,
        a.retail_price,a.tax_price,a.trade_price,a.transfer_price,
        a.unitid,u.unitname,a.factory as produc_factory,a.classtype,m.medicinecode
        from aa_yxcp a
        join c_brand b on b.brandnum=a.brandnum and a.mfrsid=b.mfrsid
        join c_unit u on a.unitid=u.unitid
        join c_mfrs m on a.mfrsid=m.mfrsnum
        where a.produc_num=#{goodsNum}
    </select>
    <select id="yinxingdzs" resultType="com.shiguang.stock.domain.StockDO">
        select a.produc_num,a.produc_code,a.view_good_name,a.sph_up,a.sph_down,a.cyl_up,a.cyl_down,
				a.mfrsid,a.brandnum,b.brandname,
        a.retail_price,a.tax_price,a.trade_price,a.transfer_price,
        a.unitid,u.unitname,a.produc_factory,a.classtype,m.medicinecode
        from aa_yxdz a
        join c_brand b on b.brandnum=a.brandnum and a.mfrsid=b.mfrsid
        join c_unit u on a.unitid=u.unitid
        join c_mfrs m on a.mfrsid=m.mfrsnum
        where a.produc_num=#{goodsNum}
    </select>
    <select id="huliyes" resultType="com.shiguang.stock.domain.StockDO">
        select a.produc_num,a.produc_code,a.view_good_name,a.mfrsid,a.brandnum,b.brandname,
        a.retail_price,a.tax_price,a.trade_price,a.transfer_price,
        a.unitid,u.unitname,a.produc_factory,a.classtype,m.medicinecode
        from aa_hly  a
        join c_brand b on b.brandnum=a.brandnum and a.mfrsid=b.mfrsid
        join c_unit u on a.unitid=u.unitid
        join c_mfrs m on a.mfrsid=m.mfrsnum
        where a.produc_num=#{goodsNum}
    </select>
    <select id="taiyangjings" resultType="com.shiguang.stock.domain.StockDO">
        select a.produc_num,a.produc_code,a.view_good_name,a.mfrsid,a.brandnum,b.brandname,
        a.retail_price,a.tax_price,a.trade_price,a.transfer_price,
        a.unitid,u.unitname,a.produc_factory,a.produc_factorycolor,a.classtype,m.medicinecode
        from aa_tyj a
        join c_brand b on b.brandnum=a.brandnum and a.mfrsid=b.mfrsid
        join c_unit u on a.unitid=u.unitid
        join c_mfrs m on a.mfrsid=m.mfrsnum
        where a.produc_num=#{goodsNum}
    </select>
    <select id="laohuajings" resultType="com.shiguang.stock.domain.StockDO">
        select a.produc_num,a.produc_code,a.view_good_name,a.mfrsid,a.brandnum,b.brandname,
        a.retail_price,a.tax_price,a.trade_price,a.transfer_price,
        a.unitid,u.unitname,a.produc_factory,a.old_id as sph,a.classtype,m.medicinecode
        from aa_oldlens a
        join c_brand b on b.brandnum=a.brandnum and a.mfrsid=b.mfrsid
        join c_unit u on a.unitid=u.unitid
        join c_mfrs m on a.mfrsid=m.mfrsnum
        where a.produc_num=#{goodsNum}
    </select>
    <select id="haocais" resultType="com.shiguang.stock.domain.StockDO">
        select a.produc_num,a.produc_code,a.view_good_name,a.mfrsid,a.brandnum,b.brandname,
        a.retail_price,a.tax_price,a.trade_price,a.transfer_price,
        a.unitid,u.unitname,a.produc_factory,a.classtype,m.medicinecode
        from aa_hc a
        join c_brand b on b.brandnum=a.brandnum and a.mfrsid=b.mfrsid
        join c_unit u on a.unitid=u.unitid
        join c_mfrs m on a.mfrsid=m.mfrsnum
        where a.produc_num=#{goodsNum}
    </select>
    <select id="shiguangs" resultType="com.shiguang.stock.domain.StockDO">
        select a.produc_num,a.produc_code,a.view_good_name,a.mfrsid,a.brandnum,b.brandname,
        a.retail_price,a.tax_price,a.trade_price,a.transfer_price,
        a.unitid,u.unitname,a.produc_factory,a.classtype,m.medicinecode
        from aa_shiguang a
        join c_brand b on b.brandnum=a.brandnum and a.mfrsid=b.mfrsid
        join c_unit u on a.unitid=u.unitid
        join c_mfrs m on a.mfrsid=m.mfrsnum
        where a.produc_num=#{goodsNum}
    </select>
    <!-- 批量打印条码 -->
    <select id="codeBatch" parameterType="string" resultType="com.shiguang.stock.domain.StockDO">
            SELECT
    s.danju_number,
    s.goods_num,
    s.goods_code,
    s.goods_name,
    s.goods_count,
    g.goodsname AS 'gdname',
    g.goodsid,
    m.mfrsname,
    s.brandname,
    s.retail_price,
    s.price_sum,
    s.cost_price,
    s.cost_sum,
    s.whole_price,
    s.whole_sum,
    po.position_name,
    s.batch,
    s.zhuce_number,
    s.produce_day,
    s.useday,
    s.factory,
    s.mfrsid,
    s.unit,
    s.classtype,
    s.returnzt,
    jj.produc_factorycolor AS jjColor,
    jpcp.sph_id AS jpcpSph,
    jpcp.cyl_id AS jpcpCyl,
    jpdz.sph_up AS jpcpSphUp,
    jpdz.sph_down AS jpcpSphDown,
    jpdz.cyl_up AS jpcpCylUp,
    jpdz.cyl_down AS jpcpCylDown,
    yxcp.sph_id AS yxcpSph,
    yxcp.cyl_id AS yxcpCyl,
    yxdz.sph_up AS yxdzSphUp,
    yxdz.sph_down AS yxdzSphDown,
    yxdz.cyl_up AS yxdzCylUp,
    yxdz.cyl_down AS yxdzCylDown,
    tyj.produc_factorycolor AS tyjColor,
    lhj.old_id AS lhjSph
    FROM
    stock s
    LEFT JOIN c_goods g ON s.goods_type = g.goodsid
    LEFT JOIN c_mfrs m ON s.mfrsid = m.mfrsnum
    LEFT JOIN c_position po ON s.position_id = po.position_id
    LEFT JOIN c_brand b ON s.brandname = b.brandname AND s.`mfrsid` = b.`mfrsid`
    LEFT JOIN department d ON po.depart_number = d.depart_number  and po.company_id=d.company_id
    LEFT JOIN aa_produca jj ON jj.produc_num = s.goods_num
    LEFT JOIN aa_parts pj ON pj.produc_num = s.goods_num

    LEFT JOIN aa_jpcp jpcp ON jpcp.produc_num = s.goods_num
    LEFT JOIN aa_jpdz jpdz ON jpdz.produc_num = s.goods_num
    LEFT JOIN aa_yxcp yxcp ON yxcp.produc_num = s.goods_num
    LEFT JOIN aa_yxdz yxdz ON yxdz.produc_num = s.goods_num
    LEFT JOIN aa_tyj tyj ON tyj.produc_num = s.goods_num
    LEFT JOIN aa_oldlens lhj ON lhj.produc_num = s.goods_num
    <where>
        <if test="num != null and num != ''">and  s.goods_num in ( #{num} ) </if>
    </where>
    </select>
</mapper>