<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.shiguang.stock.dao.StockDao">

    <select id="get" resultType="com.shiguang.stock.domain.StockDO">
    select `id`,`goods_num`,`goods_code`,`goods_name`,`goods_count`,`goods_type`,`mfrsid`,`retail_price`,`price_sum`,`cost_price`,`cost_sum`,`whole_price`,`whole_sum`,`position_name`,`create_time`,`danju_number`,`order_number`,`yundan_number`,`zhidan_people`,`danju_day`,`tuihuo_number`,`factory_number`,`beizhu`,`unit` from stock where id = #{value}
</select>

    <select id="list" resultType="com.shiguang.stock.domain.StockDO">
        select
        s.`id`,s.`goods_num`,s.`goods_code`,s.`goods_name`,s.`goods_count`,s.`goods_type`,s.`mfrsid`,s.`retail_price`,
        s.`price_sum`, s.`cost_price`, s.`cost_sum`, s.`whole_price`, s.`whole_sum`, s.`position_name`, s.`create_time`,
        s.`danju_number`, s.`order_number`, s.`yundan_number`, s.`zhidan_people`, s.`danju_day`, s.`tuihuo_number`,
        s.`factory_number`, s.`beizhu`, s.`unit`,m.mfrsname
        from stock s join c_mfrs m on s.mfrsid=m.mfrsid
        <where>
            <if test="id != null and id != ''">and id = #{id}</if>
            <if test="goodsNum != null and goodsNum != ''">and goods_num = #{goodsNum}</if>
            <if test="goodsCode != null and goodsCode != ''">and goods_code = #{goodsCode}</if>
            <if test="goodsName != null and goodsName != ''">and goods_name = #{goodsName}</if>
            <if test="goodsCount != null and goodsCount != ''">and goods_count = #{goodsCount}</if>
            <if test="goodsType != null and goodsType != ''">and goods_type = #{goodsType}</if>
            <if test="mfrsid != null and mfrsid != ''">and mfrsid = #{mfrsid}</if>
            <if test="retailPrice != null and retailPrice != ''">and retail_price = #{retailPrice}</if>
            <if test="priceSum != null and priceSum != ''">and price_sum = #{priceSum}</if>
            <if test="costPrice != null and costPrice != ''">and cost_price = #{costPrice}</if>
            <if test="costSum != null and costSum != ''">and cost_sum = #{costSum}</if>
            <if test="wholePrice != null and wholePrice != ''">and whole_price = #{wholePrice}</if>
            <if test="wholeSum != null and wholeSum != ''">and whole_sum = #{wholeSum}</if>
            <if test="positionName != null and positionName != ''">and position_name = #{positionName}</if>
            <if test="createTime != null and createTime != ''">and create_time = #{createTime}</if>
            <if test="danjuNumber != null and danjuNumber != ''">and danju_number = #{danjuNumber}</if>
            <if test="orderNumber != null and orderNumber != ''">and order_number = #{orderNumber}</if>
            <if test="yundanNumber != null and yundanNumber != ''">and yundan_number = #{yundanNumber}</if>
            <if test="zhidanPeople != null and zhidanPeople != ''">and zhidan_people = #{zhidanPeople}</if>
            <if test="danjuDay != null and danjuDay != ''">and danju_day = #{danjuDay}</if>
            <if test="tuihuoNumber != null and tuihuoNumber != ''">and tuihuo_number = #{tuihuoNumber}</if>
            <if test="factoryNumber != null and factoryNumber != ''">and factory_number = #{factoryNumber}</if>
            <if test="beizhu != null and beizhu != ''">and beizhu = #{beizhu}</if>
        </where>
        <choose>
            <when test="sort != null and sort.trim() != ''">
                order by ${sort} ${order}
            </when>
            <otherwise>
                order by id desc
            </otherwise>
        </choose>
        <if test="offset != null and limit != null">
            limit #{offset}, #{limit}
        </if>
    </select>

    <select id="count" resultType="int">
        select count(*) from stock
        <where>
            <if test="id != null and id != ''">and id = #{id}</if>
            <if test="goodsNum != null and goodsNum != ''">and goods_num = #{goodsNum}</if>
            <if test="goodsCode != null and goodsCode != ''">and goods_code = #{goodsCode}</if>
            <if test="goodsName != null and goodsName != ''">and goods_name = #{goodsName}</if>
            <if test="goodsCount != null and goodsCount != ''">and goods_count = #{goodsCount}</if>
            <if test="goodsType != null and goodsType != ''">and goods_type = #{goodsType}</if>
            <if test="mfrsid != null and mfrsid != ''">and mfrsid = #{mfrsid}</if>
            <if test="retailPrice != null and retailPrice != ''">and retail_price = #{retailPrice}</if>
            <if test="priceSum != null and priceSum != ''">and price_sum = #{priceSum}</if>
            <if test="costPrice != null and costPrice != ''">and cost_price = #{costPrice}</if>
            <if test="costSum != null and costSum != ''">and cost_sum = #{costSum}</if>
            <if test="wholePrice != null and wholePrice != ''">and whole_price = #{wholePrice}</if>
            <if test="wholeSum != null and wholeSum != ''">and whole_sum = #{wholeSum}</if>
            <if test="positionName != null and positionName != ''">and position_name = #{positionName}</if>
            <if test="createTime != null and createTime != ''">and create_time = #{createTime}</if>
            <if test="danjuNumber != null and danjuNumber != ''">and danju_number = #{danjuNumber}</if>
            <if test="orderNumber != null and orderNumber != ''">and order_number = #{orderNumber}</if>
            <if test="yundanNumber != null and yundanNumber != ''">and yundan_number = #{yundanNumber}</if>
            <if test="zhidanPeople != null and zhidanPeople != ''">and zhidan_people = #{zhidanPeople}</if>
            <if test="danjuDay != null and danjuDay != ''">and danju_day = #{danjuDay}</if>
            <if test="tuihuoNumber != null and tuihuoNumber != ''">and tuihuo_number = #{tuihuoNumber}</if>
            <if test="factoryNumber != null and factoryNumber != ''">and factory_number = #{factoryNumber}</if>
            <if test="beizhu != null and beizhu != ''">and beizhu = #{beizhu}</if>
        </where>
    </select>

    <insert id="save" parameterType="com.shiguang.stock.domain.StockDO" useGeneratedKeys="true" keyProperty="id">
    insert into stock
    (
        `goods_num`,
        `goods_code`,
        `goods_name`,
        `goods_count`,
        `goods_type`,
        `mfrsid`,
        `retail_price`,
        `price_sum`,
        `cost_price`,
        `cost_sum`,
        `whole_price`,
        `whole_sum`,
        `position_name`,
        `create_time`,
        `danju_number`,
        `order_number`,
        `yundan_number`,
        `zhidan_people`,
        `danju_day`,
        `tuihuo_number`,
        `factory_number`,
        `beizhu`,
        `unit`
    )
    values
    (
        #{goodsNum},
        #{goodsCode},
        #{goodsName},
        #{goodsCount},
        #{goodsType},
        #{mfrsid},
        #{retailPrice},
        #{priceSum},
        #{costPrice},
        #{costSum},
        #{wholePrice},
        #{wholeSum},
        #{positionName},
        #{createTime},
        #{danjuNumber},
        #{orderNumber},
        #{yundanNumber},
        #{zhidanPeople},
        #{danjuDay},
        #{tuihuoNumber},
        #{factoryNumber},
        #{beizhu},
        #{unit}
    )
</insert>

    <update id="update" parameterType="com.shiguang.stock.domain.StockDO">
        update stock
        <set>
            <if test="goodsNum != null">`goods_num` = #{goodsNum},</if>
            <if test="goodsCode != null">`goods_code` = #{goodsCode},</if>
            <if test="goodsName != null">`goods_name` = #{goodsName},</if>
            <if test="goodsCount != null">`goods_count` = #{goodsCount},</if>
            <if test="goodsType != null">`goods_type` = #{goodsType},</if>
            <if test="mfrsid != null">`mfrsid` = #{mfrsid},</if>
            <if test="retailPrice != null">`retail_price` = #{retailPrice},</if>
            <if test="priceSum != null">`price_sum` = #{priceSum},</if>
            <if test="costPrice != null">`cost_price` = #{costPrice},</if>
            <if test="costSum != null">`cost_sum` = #{costSum},</if>
            <if test="wholePrice != null">`whole_price` = #{wholePrice},</if>
            <if test="wholeSum != null">`whole_sum` = #{wholeSum},</if>
            <if test="positionName != null">`position_name` = #{positionName},</if>
            <if test="createTime != null">`create_time` = #{createTime},</if>
            <if test="danjuNumber != null">`danju_number` = #{danjuNumber},</if>
            <if test="orderNumber != null">`order_number` = #{orderNumber},</if>
            <if test="yundanNumber != null">`yundan_number` = #{yundanNumber},</if>
            <if test="zhidanPeople != null">`zhidan_people` = #{zhidanPeople},</if>
            <if test="danjuDay != null">`danju_day` = #{danjuDay},</if>
            <if test="tuihuoNumber != null">`tuihuo_number` = #{tuihuoNumber},</if>
            <if test="factoryNumber != null">`factory_number` = #{factoryNumber},</if>
            <if test="beizhu != null">`beizhu` = #{beizhu}</if>
        </set>
        where id = #{id}
    </update>

    <update id="updateGoodsCount" parameterType="com.shiguang.stock.domain.StockDO">
        update stock
        <set>
            <if test="goodsCount != null">`goods_count` = #{goodsCount},</if>
        </set>
        where goods_num = #{goodsNum}
    </update>

    <delete id="remove">
    delete from stock where id = #{value}
</delete>

    <delete id="batchRemove">
        delete from stock where id in
        <foreach item="id" collection="array" open="(" separator="," close=")">
            #{id}
        </foreach>
    </delete>


    <!-- 镜架查询 -->
    <select id="listJiajia" resultType="com.shiguang.stock.domain.StockDO">
        select
        st.`id`,st.`goods_num`,st.`goods_code`,st.`goods_name`,st.`goods_count`,st.`goods_type`,st.`mfrsid`,st.`retail_price`,st.`price_sum`,st.`cost_price`,st.`cost_sum`,st.`whole_price`,
        st.`whole_sum`,st.`position_name`,st.`unit`,pr.`produc_factory`,pr.`produc_color`,ac.`materialname`,pr.`size`
        from stock st left join aa_produca pr on pr.produc_num = st.goods_num left join c_material ac on ac.materialid =
        pr.materialid
        <where>
            <if test="id != null and id != ''">and st.id = #{id}</if>
            <if test="goodsNum != null and goodsNum != ''">and st.goods_num = #{goodsNum}</if>
            <if test="goodsCode != null and goodsCode != ''">and st.goods_code = #{goodsCode}</if>
            <if test="goodsName != null and goodsName != ''">and st.goods_name = #{goodsName}</if>
            <if test="goodsCount != null and goodsCount != ''">and st.goods_count = #{goodsCount}</if>
            <if test="goodsType != null and goodsType != ''">and st.goods_type = #{goodsType}</if>
            <if test="mfrsid != null and mfrsid != ''">and st.mfrsid = #{mfrsid}</if>
            <if test="retailPrice != null and retailPrice != ''">and st.retail_price = #{retailPrice}</if>
            <if test="priceSum != null and priceSum != ''">and st.price_sum = #{priceSum}</if>
            <if test="costPrice != null and costPrice != ''">and st.cost_price = #{costPrice}</if>
            <if test="costSum != null and costSum != ''">and st.cost_sum = #{costSum}</if>
            <if test="wholePrice != null and wholePrice != ''">and st.whole_price = #{wholePrice}</if>
            <if test="wholeSum != null and wholeSum != ''">and st.whole_sum = #{wholeSum}</if>
            <if test="positionName != null and positionName != ''">and st.position_name = #{positionName}</if>
        </where>
        <choose>
            <when test="sort != null and sort.trim() != ''">
                order by ${sort} ${order}
            </when>
            <otherwise>
                GROUP BY st.goods_name
                order by st.id desc
            </otherwise>
        </choose>
        <if test="offset != null and limit != null">
            limit #{offset}, #{limit}
        </if>
    </select>

    <select id="countJiajia" resultType="int">
        select count(*) from stock st left join aa_produca pr on pr.produc_num = st.goods_num left join a_caizhi ac on
        ac.caizhi_id = pr.materialid
        <where>
            <if test="id != null and id != ''">and st.id = #{id}</if>
            <if test="goodsNum != null and goodsNum != ''">and st.goods_num = #{goodsNum}</if>
            <if test="goodsCode != null and goodsCode != ''">and st.goods_code = #{goodsCode}</if>
            <if test="goodsName != null and goodsName != ''">and st.goods_name = #{goodsName}</if>
            <if test="goodsCount != null and goodsCount != ''">and st.goods_count = #{goodsCount}</if>
            <if test="goodsType != null and goodsType != ''">and st.goods_type = #{goodsType}</if>
            <if test="mfrsid != null and mfrsid != ''">and st.mfrsid = #{mfrsid}</if>
            <if test="retailPrice != null and retailPrice != ''">and st.retail_price = #{retailPrice}</if>
            <if test="priceSum != null and priceSum != ''">and st.price_sum = #{priceSum}</if>
            <if test="costPrice != null and costPrice != ''">and st.cost_price = #{costPrice}</if>
            <if test="costSum != null and costSum != ''">and st.cost_sum = #{costSum}</if>
            <if test="wholePrice != null and wholePrice != ''">and st.whole_price = #{wholePrice}</if>
            <if test="wholeSum != null and wholeSum != ''">and st.whole_sum = #{wholeSum}</if>
            <if test="positionName != null and positionName != ''">and st.position_name = #{positionName}</if>
        </where>
    </select>

    <!-- 镜片(成品)查询 -->
    <select id="listJpcp" resultType="com.shiguang.stock.domain.StockDO">
        select
        st.`id`,st.`goods_num`,st.`goods_code`,st.`goods_name`,st.`goods_count`,st.`goods_type`,st.`mfrsid`,st.`retail_price`,st.`price_sum`,st.`cost_price`,st.`cost_sum`,st.`whole_price`,
        st.`whole_sum`,st.`position_name`,st.`unit`,s.`sph`,c.`cyl`,l.`lightbelow`,r.`refractivityvalue`,pl.`light_name`,le.`lens_name`
        from stock st left join aa_jpcp j on j.produc_num = st.goods_num
        left join a_sph s on s.sph_id = j.sph_id left join a_cyl c on c.cyl_id = j.cyl_id
        left join a_lightbelow l on l.lightbelow_id = j.lightbelow_id left join c_refractivity r on r.refractivityid =
        j.refractivityid
        left join p_light pl on pl.light_id = j.light_id left join p_lens le on le.lens_id = j.lens_id
        <where>
            <if test="id != null and id != ''">and st.id = #{id}</if>
            <if test="goodsNum != null and goodsNum != ''">and st.goods_num = #{goodsNum}</if>
            <if test="goodsCode != null and goodsCode != ''">and st.goods_code = #{goodsCode}</if>
            <if test="goodsName != null and goodsName != ''">and st.goods_name = #{goodsName}</if>
            <if test="goodsCount != null and goodsCount != ''">and st.goods_count = #{goodsCount}</if>
            <if test="goodsType != null and goodsType != ''">and st.goods_type = #{goodsType}</if>
            <if test="mfrsid != null and mfrsid != ''">and st.mfrsid = #{mfrsid}</if>
            <if test="retailPrice != null and retailPrice != ''">and st.retail_price = #{retailPrice}</if>
            <if test="priceSum != null and priceSum != ''">and st.price_sum = #{priceSum}</if>
            <if test="costPrice != null and costPrice != ''">and st.cost_price = #{costPrice}</if>
            <if test="costSum != null and costSum != ''">and st.cost_sum = #{costSum}</if>
            <if test="wholePrice != null and wholePrice != ''">and st.whole_price = #{wholePrice}</if>
            <if test="wholeSum != null and wholeSum != ''">and st.whole_sum = #{wholeSum}</if>
            <if test="positionName != null and positionName != ''">and st.position_name = #{positionName}</if>
            <if test="rightYuanYongQJ != null and rightYuanYongQJ != ''">and s.sph like concat('%',
                #{rightYuanYongQJ},'%')
            </if>
            <if test="rightYuanYongZJ != null and rightYuanYongZJ != ''">and c.cyl like concat('%',
                #{rightYuanYongZJ},'%')
            </if>
            <if test="leftYuanYongQJ != null and leftYuanYongQJ != ''">and s.sph like concat('%',
                #{leftYuanYongQJ},'%')
            </if>
            <if test="leftYuanYongZJ != null and leftYuanYongZJ != ''">and c.cyl like concat('%',
                #{leftYuanYongZJ},'%')
            </if>
        </where>
        <choose>
            <when test="sort != null and sort.trim() != ''">
                order by ${sort} ${order}
            </when>
            <otherwise>
                GROUP BY st.goods_name
                order by st.id desc
            </otherwise>
        </choose>
        <if test="offset != null and limit != null">
            limit #{offset}, #{limit}
        </if>
    </select>

    <select id="countJpcp" resultType="int">
        select count(*)
        from stock st left join aa_jpcp j on j.produc_num = st.goods_num
        left join a_sph s on s.sph_id = j.sph_id left join a_cyl c on c.cyl_id = j.cyl_id
        left join a_lightbelow l on l.lightbelow_id = j.lightbelow_id left join c_refractivity r on r.refractivityid =
        j.refractivityid
        left join p_light pl on pl.light_id = j.light_id left join p_lens le on le.lens_id = j.lens_id
        <where>
            <if test="id != null and id != ''">and st.id = #{id}</if>
            <if test="goodsNum != null and goodsNum != ''">and st.goods_num = #{goodsNum}</if>
            <if test="goodsCode != null and goodsCode != ''">and st.goods_code = #{goodsCode}</if>
            <if test="goodsName != null and goodsName != ''">and st.goods_name = #{goodsName}</if>
            <if test="goodsCount != null and goodsCount != ''">and st.goods_count = #{goodsCount}</if>
            <if test="goodsType != null and goodsType != ''">and st.goods_type = #{goodsType}</if>
            <if test="mfrsid != null and mfrsid != ''">and st.mfrsid = #{mfrsid}</if>
            <if test="retailPrice != null and retailPrice != ''">and st.retail_price = #{retailPrice}</if>
            <if test="priceSum != null and priceSum != ''">and st.price_sum = #{priceSum}</if>
            <if test="costPrice != null and costPrice != ''">and st.cost_price = #{costPrice}</if>
            <if test="costSum != null and costSum != ''">and st.cost_sum = #{costSum}</if>
            <if test="wholePrice != null and wholePrice != ''">and st.whole_price = #{wholePrice}</if>
            <if test="wholeSum != null and wholeSum != ''">and st.whole_sum = #{wholeSum}</if>
            <if test="positionName != null and positionName != ''">and st.position_name = #{positionName}</if>
            <if test="rightYuanYongQJ != null and rightYuanYongQJ != ''">and s.sph like concat('%',
                #{rightYuanYongQJ},'%')
            </if>
            <if test="rightYuanYongZJ != null and rightYuanYongZJ != ''">and c.cyl like concat('%',
                #{rightYuanYongZJ},'%')
            </if>
            <if test="leftYuanYongQJ != null and leftYuanYongQJ != ''">and s.sph like concat('%',
                #{leftYuanYongQJ},'%')
            </if>
            <if test="leftYuanYongZJ != null and leftYuanYongZJ != ''">and c.cyl like concat('%',
                #{leftYuanYongZJ},'%')
            </if>
        </where>
    </select>

    <!-- 镜片(订做)查询 -->
    <select id="listJpdz" resultType="com.shiguang.stock.domain.StockDO">
        select
        st.`id`,st.`goods_num`,st.`goods_code`,st.`goods_name`,st.`goods_count`,st.`goods_type`,st.`mfrsid`,st.`retail_price`,st.`price_sum`,st.`cost_price`,st.`cost_sum`,st.`whole_price`,
        st.`whole_sum`,st.`position_name`,st.`unit`,s.`sph`,c.`cyl`,l.`lightbelow`,r.`refractivityvalue`,pl.`light_name`,le.`lens_name`,f.`function_name`,g.`gradual_name`,
        j.`sph_up`,j.`sph_down`,j.`cyl_up`,j.`cyl_down`,j.`lightbelow_right`,j.`lightbelow_left`
        from stock st left join aa_jpdz j on j.produc_num = st.goods_num
        left join a_sph s on s.sph_id = j.sph_id left join a_cyl c on c.cyl_id = j.cyl_id
        left join c_refractivity r on r.refractivityid = j.refractivityid
        left join p_light pl on pl.light_id = j.light_id
        left join p_lens l on l.lens_id = j.lens_id
        left join p_gradual g on g.gradual_id = j.gradual_id
        left join p_function f on f.function_id = j.function_id
        <where>
            <if test="id != null and id != ''">and st.id = #{id}</if>
            <if test="goodsNum != null and goodsNum != ''">and st.goods_num = #{goodsNum}</if>
            <if test="goodsCode != null and goodsCode != ''">and st.goods_code = #{goodsCode}</if>
            <if test="goodsName != null and goodsName != ''">and st.goods_name = #{goodsName}</if>
            <if test="goodsCount != null and goodsCount != ''">and st.goods_count = #{goodsCount}</if>
            <if test="goodsType != null and goodsType != ''">and st.goods_type = #{goodsType}</if>
            <if test="mfrsid != null and mfrsid != ''">and st.mfrsid = #{mfrsid}</if>
            <if test="retailPrice != null and retailPrice != ''">and st.retail_price = #{retailPrice}</if>
            <if test="priceSum != null and priceSum != ''">and st.price_sum = #{priceSum}</if>
            <if test="costPrice != null and costPrice != ''">and st.cost_price = #{costPrice}</if>
            <if test="costSum != null and costSum != ''">and st.cost_sum = #{costSum}</if>
            <if test="wholePrice != null and wholePrice != ''">and st.whole_price = #{wholePrice}</if>
            <if test="wholeSum != null and wholeSum != ''">and st.whole_sum = #{wholeSum}</if>
            <if test="positionName != null and positionName != ''">and st.position_name = #{positionName}</if>
            <if test="rightYuanYongQJ != null and rightYuanYongQJ != ''">and s.sph like concat('%',
                #{rightYuanYongQJ},'%')
            </if>
            <if test="rightYuanYongZJ != null and rightYuanYongZJ != ''">and c.cyl like concat('%',
                #{rightYuanYongZJ},'%')
            </if>
            <if test="leftYuanYongQJ != null and leftYuanYongQJ != ''">and s.sph like concat('%',
                #{leftYuanYongQJ},'%')
            </if>
            <if test="leftYuanYongZJ != null and leftYuanYongZJ != ''">and c.cyl like concat('%',
                #{leftYuanYongZJ},'%')
            </if>

        </where>
        <choose>
            <when test="sort != null and sort.trim() != ''">
                order by ${sort} ${order}
            </when>
            <otherwise>
                GROUP BY st.goods_name
                order by st.id desc
            </otherwise>
        </choose>
        <if test="offset != null and limit != null">
            limit #{offset}, #{limit}
        </if>
    </select>

    <select id="countJpdz" resultType="int">
        select count(*)
        from stock st left join aa_jpdz j on j.produc_num = st.goods_num
        left join a_sph s on s.sph_id = j.sph_id left join a_cyl c on c.cyl_id = j.cyl_id
        left join c_refractivity r on r.refractivityid = j.refractivityid
        left join p_light pl on pl.light_id = j.light_id
        left join p_lens l on l.lens_id = j.lens_id
        left join p_gradual g on g.gradual_id = j.gradual_id
        left join p_function f on f.function_id = j.function_id
        <where>
            <if test="id != null and id != ''">and st.id = #{id}</if>
            <if test="goodsNum != null and goodsNum != ''">and st.goods_num = #{goodsNum}</if>
            <if test="goodsCode != null and goodsCode != ''">and st.goods_code = #{goodsCode}</if>
            <if test="goodsName != null and goodsName != ''">and st.goods_name = #{goodsName}</if>
            <if test="goodsCount != null and goodsCount != ''">and st.goods_count = #{goodsCount}</if>
            <if test="goodsType != null and goodsType != ''">and st.goods_type = #{goodsType}</if>
            <if test="mfrsid != null and mfrsid != ''">and st.mfrsid = #{mfrsid}</if>
            <if test="retailPrice != null and retailPrice != ''">and st.retail_price = #{retailPrice}</if>
            <if test="priceSum != null and priceSum != ''">and st.price_sum = #{priceSum}</if>
            <if test="costPrice != null and costPrice != ''">and st.cost_price = #{costPrice}</if>
            <if test="costSum != null and costSum != ''">and st.cost_sum = #{costSum}</if>
            <if test="wholePrice != null and wholePrice != ''">and st.whole_price = #{wholePrice}</if>
            <if test="wholeSum != null and wholeSum != ''">and st.whole_sum = #{wholeSum}</if>
            <if test="positionName != null and positionName != ''">and st.position_name = #{positionName}</if>
            <if test="rightYuanYongQJ != null and rightYuanYongQJ != ''">and s.sph like concat('%',
                #{rightYuanYongQJ},'%')
            </if>
            <if test="rightYuanYongZJ != null and rightYuanYongZJ != ''">and c.cyl like concat('%',
                #{rightYuanYongZJ},'%')
            </if>
            <if test="leftYuanYongQJ != null and leftYuanYongQJ != ''">and s.sph like concat('%',
                #{leftYuanYongQJ},'%')
            </if>
            <if test="leftYuanYongZJ != null and leftYuanYongZJ != ''">and c.cyl like concat('%',
                #{leftYuanYongZJ},'%')
            </if>
        </where>
    </select>

    <!-- 镜架配件查询 -->
    <select id="listJiajiapj" resultType="com.shiguang.stock.domain.StockDO">
        select
        st.`id`,st.`goods_num`,st.`goods_code`,st.`goods_name`,st.`goods_count`,st.`goods_type`,st.`mfrsid`,st.`retail_price`,st.`price_sum`,st.`cost_price`,st.`cost_sum`,st.`whole_price`,
        st.`whole_sum`,st.`position_name`,st.`unit`,pr.`produc_factory`,pr.`parts_style`
        from stock st left join aa_parts pr on pr.produc_num = st.goods_num
        <where>
            <if test="partsStyle != null and partsStyle != ''">and pr.parts_style = #{partsStyle}</if>
            <if test="id != null and id != ''">and st.id = #{id}</if>
            <if test="goodsNum != null and goodsNum != ''">and st.goods_num = #{goodsNum}</if>
            <if test="goodsCode != null and goodsCode != ''">and st.goods_code = #{goodsCode}</if>
            <if test="goodsName != null and goodsName != ''">and st.goods_name = #{goodsName}</if>
            <if test="goodsCount != null and goodsCount != ''">and st.goods_count = #{goodsCount}</if>
            <if test="goodsType != null and goodsType != ''">and st.goods_type = #{goodsType}</if>
            <if test="mfrsid != null and mfrsid != ''">and st.mfrsid = #{mfrsid}</if>
            <if test="retailPrice != null and retailPrice != ''">and st.retail_price = #{retailPrice}</if>
            <if test="priceSum != null and priceSum != ''">and st.price_sum = #{priceSum}</if>
            <if test="costPrice != null and costPrice != ''">and st.cost_price = #{costPrice}</if>
            <if test="costSum != null and costSum != ''">and st.cost_sum = #{costSum}</if>
            <if test="wholePrice != null and wholePrice != ''">and st.whole_price = #{wholePrice}</if>
            <if test="wholeSum != null and wholeSum != ''">and st.whole_sum = #{wholeSum}</if>
            <if test="positionName != null and positionName != ''">and st.position_name = #{positionName}</if>
        </where>
        <choose>
            <when test="sort != null and sort.trim() != ''">
                order by ${sort} ${order}
            </when>
            <otherwise>
                GROUP BY st.goods_name
                order by st.id desc
            </otherwise>
        </choose>
        <if test="offset != null and limit != null">
            limit #{offset}, #{limit}
        </if>
    </select>

    <select id="countJiajiapj" resultType="int">
        select count(*) from stock st left join aa_parts pr on pr.produc_num = st.goods_num and pr.parts_style = '框镜'
        <where>
            <if test="partsStyle != null and partsStyle != ''">and pr.parts_style = #{partsStyle}</if>
            <if test="id != null and id != ''">and st.id = #{id}</if>
            <if test="goodsNum != null and goodsNum != ''">and st.goods_num = #{goodsNum}</if>
            <if test="goodsCode != null and goodsCode != ''">and st.goods_code = #{goodsCode}</if>
            <if test="goodsName != null and goodsName != ''">and st.goods_name = #{goodsName}</if>
            <if test="goodsCount != null and goodsCount != ''">and st.goods_count = #{goodsCount}</if>
            <if test="goodsType != null and goodsType != ''">and st.goods_type = #{goodsType}</if>
            <if test="mfrsid != null and mfrsid != ''">and st.mfrsid = #{mfrsid}</if>
            <if test="retailPrice != null and retailPrice != ''">and st.retail_price = #{retailPrice}</if>
            <if test="priceSum != null and priceSum != ''">and st.price_sum = #{priceSum}</if>
            <if test="costPrice != null and costPrice != ''">and st.cost_price = #{costPrice}</if>
            <if test="costSum != null and costSum != ''">and st.cost_sum = #{costSum}</if>
            <if test="wholePrice != null and wholePrice != ''">and st.whole_price = #{wholePrice}</if>
            <if test="wholeSum != null and wholeSum != ''">and st.whole_sum = #{wholeSum}</if>
            <if test="positionName != null and positionName != ''">and st.position_name = #{positionName}</if>
        </where>
    </select>

    <!-- 太阳镜查询 -->
    <select id="listTaiyj" resultType="com.shiguang.stock.domain.StockDO">
        select
        st.`id`,st.`goods_num`,st.`goods_code`,st.`goods_name`,st.`goods_count`,st.`goods_type`,st.`mfrsid`,st.`retail_price`,st.`price_sum`,st.`cost_price`,st.`cost_sum`,st.`whole_price`,
        st.`whole_sum`,st.`position_name`,st.`unit`,pr.`produc_factory`,pr.`produc_color`,pr.`size`
        from stock st left join aa_tyj pr on pr.produc_num = st.goods_num
        <where>
            <if test="id != null and id != ''">and st.id = #{id}</if>
            <if test="goodsNum != null and goodsNum != ''">and st.goods_num = #{goodsNum}</if>
            <if test="goodsCode != null and goodsCode != ''">and st.goods_code = #{goodsCode}</if>
            <if test="goodsName != null and goodsName != ''">and st.goods_name = #{goodsName}</if>
            <if test="goodsCount != null and goodsCount != ''">and st.goods_count = #{goodsCount}</if>
            <if test="goodsType != null and goodsType != ''">and st.goods_type = #{goodsType}</if>
            <if test="mfrsid != null and mfrsid != ''">and st.mfrsid = #{mfrsid}</if>
            <if test="retailPrice != null and retailPrice != ''">and st.retail_price = #{retailPrice}</if>
            <if test="priceSum != null and priceSum != ''">and st.price_sum = #{priceSum}</if>
            <if test="costPrice != null and costPrice != ''">and st.cost_price = #{costPrice}</if>
            <if test="costSum != null and costSum != ''">and st.cost_sum = #{costSum}</if>
            <if test="wholePrice != null and wholePrice != ''">and st.whole_price = #{wholePrice}</if>
            <if test="wholeSum != null and wholeSum != ''">and st.whole_sum = #{wholeSum}</if>
            <if test="positionName != null and positionName != ''">and st.position_name = #{positionName}</if>
        </where>
        <choose>
            <when test="sort != null and sort.trim() != ''">
                order by ${sort} ${order}
            </when>
            <otherwise>
                GROUP BY st.goods_name
                order by st.id desc
            </otherwise>
        </choose>
        <if test="offset != null and limit != null">
            limit #{offset}, #{limit}
        </if>
    </select>

    <select id="countTaiyj" resultType="int">
        select count(*) from stock st left join aa_tyj pr on pr.produc_num = st.goods_num
        <where>
            <if test="id != null and id != ''">and st.id = #{id}</if>
            <if test="goodsNum != null and goodsNum != ''">and st.goods_num = #{goodsNum}</if>
            <if test="goodsCode != null and goodsCode != ''">and st.goods_code = #{goodsCode}</if>
            <if test="goodsName != null and goodsName != ''">and st.goods_name = #{goodsName}</if>
            <if test="goodsCount != null and goodsCount != ''">and st.goods_count = #{goodsCount}</if>
            <if test="goodsType != null and goodsType != ''">and st.goods_type = #{goodsType}</if>
            <if test="mfrsid != null and mfrsid != ''">and st.mfrsid = #{mfrsid}</if>
            <if test="retailPrice != null and retailPrice != ''">and st.retail_price = #{retailPrice}</if>
            <if test="priceSum != null and priceSum != ''">and st.price_sum = #{priceSum}</if>
            <if test="costPrice != null and costPrice != ''">and st.cost_price = #{costPrice}</if>
            <if test="costSum != null and costSum != ''">and st.cost_sum = #{costSum}</if>
            <if test="wholePrice != null and wholePrice != ''">and st.whole_price = #{wholePrice}</if>
            <if test="wholeSum != null and wholeSum != ''">and st.whole_sum = #{wholeSum}</if>
            <if test="positionName != null and positionName != ''">and st.position_name = #{positionName}</if>
        </where>
    </select>

    <!-- 耗材查询 -->
    <select id="listHaocai" resultType="com.shiguang.stock.domain.StockDO">
        select
        st.`id`,st.`goods_num`,st.`goods_code`,st.`goods_name`,st.`goods_count`,st.`goods_type`,st.`mfrsid`,st.`retail_price`,st.`price_sum`,st.`cost_price`,st.`cost_sum`,st.`whole_price`,
        st.`whole_sum`,st.`position_name`,st.`unit`
        from stock st left join aa_hc pr on pr.produc_num = st.goods_num
        <where>
            <if test="id != null and id != ''">and st.id = #{id}</if>
            <if test="goodsNum != null and goodsNum != ''">and st.goods_num = #{goodsNum}</if>
            <if test="goodsCode != null and goodsCode != ''">and st.goods_code = #{goodsCode}</if>
            <if test="goodsName != null and goodsName != ''">and st.goods_name = #{goodsName}</if>
            <if test="goodsCount != null and goodsCount != ''">and st.goods_count = #{goodsCount}</if>
            <if test="goodsType != null and goodsType != ''">and st.goods_type = #{goodsType}</if>
            <if test="mfrsid != null and mfrsid != ''">and st.mfrsid = #{mfrsid}</if>
            <if test="retailPrice != null and retailPrice != ''">and st.retail_price = #{retailPrice}</if>
            <if test="priceSum != null and priceSum != ''">and st.price_sum = #{priceSum}</if>
            <if test="costPrice != null and costPrice != ''">and st.cost_price = #{costPrice}</if>
            <if test="costSum != null and costSum != ''">and st.cost_sum = #{costSum}</if>
            <if test="wholePrice != null and wholePrice != ''">and st.whole_price = #{wholePrice}</if>
            <if test="wholeSum != null and wholeSum != ''">and st.whole_sum = #{wholeSum}</if>
            <if test="positionName != null and positionName != ''">and st.position_name = #{positionName}</if>
        </where>
        <choose>
            <when test="sort != null and sort.trim() != ''">
                order by ${sort} ${order}
            </when>
            <otherwise>
                GROUP BY st.goods_name
                order by st.id desc
            </otherwise>
        </choose>
        <if test="offset != null and limit != null">
            limit #{offset}, #{limit}
        </if>
    </select>

    <select id="countHaocai" resultType="int">
        select count(*) from stock st left join aa_hc pr on pr.produc_num = st.goods_num
        <where>
            <if test="id != null and id != ''">and st.id = #{id}</if>
            <if test="goodsNum != null and goodsNum != ''">and st.goods_num = #{goodsNum}</if>
            <if test="goodsCode != null and goodsCode != ''">and st.goods_code = #{goodsCode}</if>
            <if test="goodsName != null and goodsName != ''">and st.goods_name = #{goodsName}</if>
            <if test="goodsCount != null and goodsCount != ''">and st.goods_count = #{goodsCount}</if>
            <if test="goodsType != null and goodsType != ''">and st.goods_type = #{goodsType}</if>
            <if test="mfrsid != null and mfrsid != ''">and st.mfrsid = #{mfrsid}</if>
            <if test="retailPrice != null and retailPrice != ''">and st.retail_price = #{retailPrice}</if>
            <if test="priceSum != null and priceSum != ''">and st.price_sum = #{priceSum}</if>
            <if test="costPrice != null and costPrice != ''">and st.cost_price = #{costPrice}</if>
            <if test="costSum != null and costSum != ''">and st.cost_sum = #{costSum}</if>
            <if test="wholePrice != null and wholePrice != ''">and st.whole_price = #{wholePrice}</if>
            <if test="wholeSum != null and wholeSum != ''">and st.whole_sum = #{wholeSum}</if>
            <if test="positionName != null and positionName != ''">and st.position_name = #{positionName}</if>
        </where>
    </select>

    <!-- 老花镜查询 -->
    <select id="listLaohj" resultType="com.shiguang.stock.domain.StockDO">
        select
        st.`id`,st.`goods_num`,st.`goods_code`,st.`goods_name`,st.`goods_count`,st.`goods_type`,st.`mfrsid`,st.`retail_price`,st.`price_sum`,st.`cost_price`,st.`cost_sum`,st.`whole_price`,
        st.`whole_sum`,st.`position_name`,st.`unit`
        from stock st left join aa_oldlens pr on pr.produc_num = st.goods_num
        <where>
            <if test="id != null and id != ''">and st.id = #{id}</if>
            <if test="goodsNum != null and goodsNum != ''">and st.goods_num = #{goodsNum}</if>
            <if test="goodsCode != null and goodsCode != ''">and st.goods_code = #{goodsCode}</if>
            <if test="goodsName != null and goodsName != ''">and st.goods_name = #{goodsName}</if>
            <if test="goodsCount != null and goodsCount != ''">and st.goods_count = #{goodsCount}</if>
            <if test="goodsType != null and goodsType != ''">and st.goods_type = #{goodsType}</if>
            <if test="mfrsid != null and mfrsid != ''">and st.mfrsid = #{mfrsid}</if>
            <if test="retailPrice != null and retailPrice != ''">and st.retail_price = #{retailPrice}</if>
            <if test="priceSum != null and priceSum != ''">and st.price_sum = #{priceSum}</if>
            <if test="costPrice != null and costPrice != ''">and st.cost_price = #{costPrice}</if>
            <if test="costSum != null and costSum != ''">and st.cost_sum = #{costSum}</if>
            <if test="wholePrice != null and wholePrice != ''">and st.whole_price = #{wholePrice}</if>
            <if test="wholeSum != null and wholeSum != ''">and st.whole_sum = #{wholeSum}</if>
            <if test="positionName != null and positionName != ''">and st.position_name = #{positionName}</if>
        </where>
        <choose>
            <when test="sort != null and sort.trim() != ''">
                order by ${sort} ${order}
            </when>
            <otherwise>
                GROUP BY st.goods_name
                order by st.id desc
            </otherwise>
        </choose>
        <if test="offset != null and limit != null">
            limit #{offset}, #{limit}
        </if>
    </select>

    <select id="countLaohj" resultType="int">
        select count(*) from stock st left join aa_hc pr on pr.produc_num = st.goods_num
        <where>
            <if test="id != null and id != ''">and st.id = #{id}</if>
            <if test="goodsNum != null and goodsNum != ''">and st.goods_num = #{goodsNum}</if>
            <if test="goodsCode != null and goodsCode != ''">and st.goods_code = #{goodsCode}</if>
            <if test="goodsName != null and goodsName != ''">and st.goods_name = #{goodsName}</if>
            <if test="goodsCount != null and goodsCount != ''">and st.goods_count = #{goodsCount}</if>
            <if test="goodsType != null and goodsType != ''">and st.goods_type = #{goodsType}</if>
            <if test="mfrsid != null and mfrsid != ''">and st.mfrsid = #{mfrsid}</if>
            <if test="retailPrice != null and retailPrice != ''">and st.retail_price = #{retailPrice}</if>
            <if test="priceSum != null and priceSum != ''">and st.price_sum = #{priceSum}</if>
            <if test="costPrice != null and costPrice != ''">and st.cost_price = #{costPrice}</if>
            <if test="costSum != null and costSum != ''">and st.cost_sum = #{costSum}</if>
            <if test="wholePrice != null and wholePrice != ''">and st.whole_price = #{wholePrice}</if>
            <if test="wholeSum != null and wholeSum != ''">and st.whole_sum = #{wholeSum}</if>
            <if test="positionName != null and positionName != ''">and st.position_name = #{positionName}</if>
        </where>
    </select>

    <!-- 视光查询 -->
    <select id="listShiguang" resultType="com.shiguang.stock.domain.StockDO">
        select
        st.`id`,st.`goods_num`,st.`goods_code`,st.`goods_name`,st.`goods_count`,st.`goods_type`,st.`mfrsid`,st.`retail_price`,st.`price_sum`,st.`cost_price`,st.`cost_sum`,st.`whole_price`,
        st.`whole_sum`,st.`position_name`,st.`unit`,pr.`produc_factory`
        from stock st left join aa_shiguang pr on pr.produc_num = st.goods_num
        <where>
            <if test="id != null and id != ''">and st.id = #{id}</if>
            <if test="goodsNum != null and goodsNum != ''">and st.goods_num = #{goodsNum}</if>
            <if test="goodsCode != null and goodsCode != ''">and st.goods_code = #{goodsCode}</if>
            <if test="goodsName != null and goodsName != ''">and st.goods_name = #{goodsName}</if>
            <if test="goodsCount != null and goodsCount != ''">and st.goods_count = #{goodsCount}</if>
            <if test="goodsType != null and goodsType != ''">and st.goods_type = #{goodsType}</if>
            <if test="mfrsid != null and mfrsid != ''">and st.mfrsid = #{mfrsid}</if>
            <if test="retailPrice != null and retailPrice != ''">and st.retail_price = #{retailPrice}</if>
            <if test="priceSum != null and priceSum != ''">and st.price_sum = #{priceSum}</if>
            <if test="costPrice != null and costPrice != ''">and st.cost_price = #{costPrice}</if>
            <if test="costSum != null and costSum != ''">and st.cost_sum = #{costSum}</if>
            <if test="wholePrice != null and wholePrice != ''">and st.whole_price = #{wholePrice}</if>
            <if test="wholeSum != null and wholeSum != ''">and st.whole_sum = #{wholeSum}</if>
            <if test="positionName != null and positionName != ''">and st.position_name = #{positionName}</if>
        </where>
        <choose>
            <when test="sort != null and sort.trim() != ''">
                order by ${sort} ${order}
            </when>
            <otherwise>
                GROUP BY st.goods_name
                order by st.id desc
            </otherwise>
        </choose>
        <if test="offset != null and limit != null">
            limit #{offset}, #{limit}
        </if>
    </select>

    <select id="countShiguang" resultType="int">
        select count(*) from stock st left join aa_hc pr on pr.produc_num = st.goods_num
        <where>
            <if test="id != null and id != ''">and st.id = #{id}</if>
            <if test="goodsNum != null and goodsNum != ''">and st.goods_num = #{goodsNum}</if>
            <if test="goodsCode != null and goodsCode != ''">and st.goods_code = #{goodsCode}</if>
            <if test="goodsName != null and goodsName != ''">and st.goods_name = #{goodsName}</if>
            <if test="goodsCount != null and goodsCount != ''">and st.goods_count = #{goodsCount}</if>
            <if test="goodsType != null and goodsType != ''">and st.goods_type = #{goodsType}</if>
            <if test="mfrsid != null and mfrsid != ''">and st.mfrsid = #{mfrsid}</if>
            <if test="retailPrice != null and retailPrice != ''">and st.retail_price = #{retailPrice}</if>
            <if test="priceSum != null and priceSum != ''">and st.price_sum = #{priceSum}</if>
            <if test="costPrice != null and costPrice != ''">and st.cost_price = #{costPrice}</if>
            <if test="costSum != null and costSum != ''">and st.cost_sum = #{costSum}</if>
            <if test="wholePrice != null and wholePrice != ''">and st.whole_price = #{wholePrice}</if>
            <if test="wholeSum != null and wholeSum != ''">and st.whole_sum = #{wholeSum}</if>
            <if test="positionName != null and positionName != ''">and st.position_name = #{positionName}</if>
        </where>
    </select>

    <!-- 护理液查询 -->
    <select id="listHuly" resultType="com.shiguang.stock.domain.StockDO">
        select
        st.`id`,st.`goods_num`,st.`goods_code`,st.`goods_name`,st.`goods_count`,st.`goods_type`,st.`mfrsid`,st.`retail_price`,st.`price_sum`,st.`cost_price`,st.`cost_sum`,st.`whole_price`,
        st.`whole_sum`,st.`position_name`,st.`unit`,pr.`main_capacity`,pr.`second_capacity`
        from stock st left join aa_hly pr on pr.produc_num = st.goods_num
        <where>
            <if test="id != null and id != ''">and st.id = #{id}</if>
            <if test="goodsNum != null and goodsNum != ''">and st.goods_num = #{goodsNum}</if>
            <if test="goodsCode != null and goodsCode != ''">and st.goods_code = #{goodsCode}</if>
            <if test="goodsName != null and goodsName != ''">and st.goods_name = #{goodsName}</if>
            <if test="goodsCount != null and goodsCount != ''">and st.goods_count = #{goodsCount}</if>
            <if test="goodsType != null and goodsType != ''">and st.goods_type = #{goodsType}</if>
            <if test="mfrsid != null and mfrsid != ''">and st.mfrsid = #{mfrsid}</if>
            <if test="retailPrice != null and retailPrice != ''">and st.retail_price = #{retailPrice}</if>
            <if test="priceSum != null and priceSum != ''">and st.price_sum = #{priceSum}</if>
            <if test="costPrice != null and costPrice != ''">and st.cost_price = #{costPrice}</if>
            <if test="costSum != null and costSum != ''">and st.cost_sum = #{costSum}</if>
            <if test="wholePrice != null and wholePrice != ''">and st.whole_price = #{wholePrice}</if>
            <if test="wholeSum != null and wholeSum != ''">and st.whole_sum = #{wholeSum}</if>
            <if test="positionName != null and positionName != ''">and st.position_name = #{positionName}</if>
        </where>
        <choose>
            <when test="sort != null and sort.trim() != ''">
                order by ${sort} ${order}
            </when>
            <otherwise>
                GROUP BY st.goods_name
                order by st.id desc
            </otherwise>
        </choose>
        <if test="offset != null and limit != null">
            limit #{offset}, #{limit}
        </if>
    </select>

    <select id="countHuly" resultType="int">
        select count(*) from stock st left join aa_hly pr on pr.produc_num = st.goods_num
        <where>
            <if test="id != null and id != ''">and st.id = #{id}</if>
            <if test="goodsNum != null and goodsNum != ''">and st.goods_num = #{goodsNum}</if>
            <if test="goodsCode != null and goodsCode != ''">and st.goods_code = #{goodsCode}</if>
            <if test="goodsName != null and goodsName != ''">and st.goods_name = #{goodsName}</if>
            <if test="goodsCount != null and goodsCount != ''">and st.goods_count = #{goodsCount}</if>
            <if test="goodsType != null and goodsType != ''">and st.goods_type = #{goodsType}</if>
            <if test="mfrsid != null and mfrsid != ''">and st.mfrsid = #{mfrsid}</if>
            <if test="retailPrice != null and retailPrice != ''">and st.retail_price = #{retailPrice}</if>
            <if test="priceSum != null and priceSum != ''">and st.price_sum = #{priceSum}</if>
            <if test="costPrice != null and costPrice != ''">and st.cost_price = #{costPrice}</if>
            <if test="costSum != null and costSum != ''">and st.cost_sum = #{costSum}</if>
            <if test="wholePrice != null and wholePrice != ''">and st.whole_price = #{wholePrice}</if>
            <if test="wholeSum != null and wholeSum != ''">and st.whole_sum = #{wholeSum}</if>
            <if test="positionName != null and positionName != ''">and st.position_name = #{positionName}</if>
        </where>
    </select>

    <!-- 赠品查询 -->
    <select id="listZengpin" resultType="com.shiguang.stock.domain.StockDO">
        select
        st.`id`,st.`goods_num`,st.`goods_code`,st.`goods_name`,st.`goods_count`,st.`goods_type`,st.`mfrsid`,st.`retail_price`,st.`price_sum`,st.`cost_price`,st.`cost_sum`,st.`whole_price`,
        st.`whole_sum`,st.`position_name`,st.`unit`,g.`gift_name`
        from stock st left join giveaway pr on pr.give_number = st.goods_num left join gift g on g.gift_num =
        pr.give_type
        <where>
            <if test="id != null and id != ''">and st.id = #{id}</if>
            <if test="goodsNum != null and goodsNum != ''">and st.goods_num = #{goodsNum}</if>
            <if test="goodsCode != null and goodsCode != ''">and st.goods_code = #{goodsCode}</if>
            <if test="goodsName != null and goodsName != ''">and st.goods_name = #{goodsName}</if>
            <if test="goodsCount != null and goodsCount != ''">and st.goods_count = #{goodsCount}</if>
            <if test="goodsType != null and goodsType != ''">and st.goods_type = #{goodsType}</if>
            <if test="mfrsid != null and mfrsid != ''">and st.mfrsid = #{mfrsid}</if>
            <if test="retailPrice != null and retailPrice != ''">and st.retail_price = #{retailPrice}</if>
            <if test="priceSum != null and priceSum != ''">and st.price_sum = #{priceSum}</if>
            <if test="costPrice != null and costPrice != ''">and st.cost_price = #{costPrice}</if>
            <if test="costSum != null and costSum != ''">and st.cost_sum = #{costSum}</if>
            <if test="wholePrice != null and wholePrice != ''">and st.whole_price = #{wholePrice}</if>
            <if test="wholeSum != null and wholeSum != ''">and st.whole_sum = #{wholeSum}</if>
            <if test="positionName != null and positionName != ''">and st.position_name = #{positionName}</if>
            <if test="stores != null and stores != ''">and FIND_IN_SET(#{stores},pr.stores)</if>
        </where>
        <choose>
            <when test="sort != null and sort.trim() != ''">
                order by ${sort} ${order}
            </when>
            <otherwise>
                order by st.id desc
            </otherwise>
        </choose>
        <if test="offset != null and limit != null">
            limit #{offset}, #{limit}
        </if>
    </select>

    <select id="countZengpin" resultType="int">
        select count(*) from stock st left join giveaway pr on pr.give_number = st.goods_num left join gift g on
        g.gift_num = pr.give_type
        <where>
            <if test="id != null and id != ''">and st.id = #{id}</if>
            <if test="goodsNum != null and goodsNum != ''">and st.goods_num = #{goodsNum}</if>
            <if test="goodsCode != null and goodsCode != ''">and st.goods_code = #{goodsCode}</if>
            <if test="goodsName != null and goodsName != ''">and st.goods_name = #{goodsName}</if>
            <if test="goodsCount != null and goodsCount != ''">and st.goods_count = #{goodsCount}</if>
            <if test="goodsType != null and goodsType != ''">and st.goods_type = #{goodsType}</if>
            <if test="mfrsid != null and mfrsid != ''">and st.mfrsid = #{mfrsid}</if>
            <if test="retailPrice != null and retailPrice != ''">and st.retail_price = #{retailPrice}</if>
            <if test="priceSum != null and priceSum != ''">and st.price_sum = #{priceSum}</if>
            <if test="costPrice != null and costPrice != ''">and st.cost_price = #{costPrice}</if>
            <if test="costSum != null and costSum != ''">and st.cost_sum = #{costSum}</if>
            <if test="wholePrice != null and wholePrice != ''">and st.whole_price = #{wholePrice}</if>
            <if test="wholeSum != null and wholeSum != ''">and st.whole_sum = #{wholeSum}</if>
            <if test="positionName != null and positionName != ''">and st.position_name = #{positionName}</if>
            <if test="stores != null and stores != ''">and FIND_IN_SET(#{stores},pr.stores)</if>
        </where>
    </select>

    <!-- 隐形订做查询 -->
    <select id="listYxdz" resultType="com.shiguang.stock.domain.StockDO">
        select
        st.`id`,st.`goods_num`,st.`goods_code`,st.`goods_name`,st.`goods_count`,st.`goods_type`,st.`mfrsid`,st.`retail_price`,st.`price_sum`,st.`cost_price`,st.`cost_sum`,st.`whole_price`,
        st.`whole_sum`,st.`position_name`,st.`unit`,t.`type_name`,u.`usage_name`,y.`sph_up`,y.`sph_down`,y.`cyl_up`,y.`cyl_down`,
        y.`curvature_one`,y.`curvature_yi`,y.`curvature_two`,y.`curvature_er`,s.`sph`,c.`cyl`
        from stock st left join aa_yxdz y left join p_type t on t.type_id = y.type_id
        left join a_sph s on s.sph_id = y.sph_id left join a_cyl c on c.cyl_id = y.cyl_id
        left join p_usage u on u.usage_id = y.usage_id
        left join a_sph s on s.sph_id = y.sph_id left join a_cyl c on c.cyl_id = y.cyl_id
        <where>
            <if test="id != null and id != ''">and st.id = #{id}</if>
            <if test="goodsNum != null and goodsNum != ''">and st.goods_num = #{goodsNum}</if>
            <if test="goodsCode != null and goodsCode != ''">and st.goods_code = #{goodsCode}</if>
            <if test="goodsName != null and goodsName != ''">and st.goods_name = #{goodsName}</if>
            <if test="goodsCount != null and goodsCount != ''">and st.goods_count = #{goodsCount}</if>
            <if test="goodsType != null and goodsType != ''">and st.goods_type = #{goodsType}</if>
            <if test="mfrsid != null and mfrsid != ''">and st.mfrsid = #{mfrsid}</if>
            <if test="retailPrice != null and retailPrice != ''">and st.retail_price = #{retailPrice}</if>
            <if test="priceSum != null and priceSum != ''">and st.price_sum = #{priceSum}</if>
            <if test="costPrice != null and costPrice != ''">and st.cost_price = #{costPrice}</if>
            <if test="costSum != null and costSum != ''">and st.cost_sum = #{costSum}</if>
            <if test="wholePrice != null and wholePrice != ''">and st.whole_price = #{wholePrice}</if>
            <if test="wholeSum != null and wholeSum != ''">and st.whole_sum = #{wholeSum}</if>
            <if test="positionName != null and positionName != ''">and st.position_name = #{positionName}</if>
            <if test="rightYuanYongQJ != null and rightYuanYongQJ != ''">and s.sph = #{rightYuanYongQJ}</if>
            <if test="rightYuanYongZJ != null and rightYuanYongZJ != ''">and c.cyl = #{rightYuanYongZJ}</if>
            <if test="leftYuanYongQJ != null and leftYuanYongQJ != ''">and s.sph = #{leftYuanYongQJ}</if>
            <if test="leftYuanYongZJ != null and leftYuanYongZJ != ''">and c.cyl = #{leftYuanYongZJ}</if>
        </where>
        <choose>
            <when test="sort != null and sort.trim() != ''">
                order by ${sort} ${order}
            </when>
            <otherwise>
                order by st.id desc
            </otherwise>
        </choose>
        <if test="offset != null and limit != null">
            limit #{offset}, #{limit}
        </if>
    </select>

    <select id="countYxdz" resultType="int">
        select count(*)
        from stock st left join aa_yxdz y left join p_type t on t.type_id = y.type_id
        left join p_usage u on u.usage_id = y.usage_id
        left join a_sph s on s.sph_id = y.sph_id left join a_cyl c on c.cyl_id = y.cyl_id
        <where>
            <if test="id != null and id != ''">and st.id = #{id}</if>
            <if test="goodsNum != null and goodsNum != ''">and st.goods_num = #{goodsNum}</if>
            <if test="goodsCode != null and goodsCode != ''">and st.goods_code = #{goodsCode}</if>
            <if test="goodsName != null and goodsName != ''">and st.goods_name = #{goodsName}</if>
            <if test="goodsCount != null and goodsCount != ''">and st.goods_count = #{goodsCount}</if>
            <if test="goodsType != null and goodsType != ''">and st.goods_type = #{goodsType}</if>
            <if test="mfrsid != null and mfrsid != ''">and st.mfrsid = #{mfrsid}</if>
            <if test="retailPrice != null and retailPrice != ''">and st.retail_price = #{retailPrice}</if>
            <if test="priceSum != null and priceSum != ''">and st.price_sum = #{priceSum}</if>
            <if test="costPrice != null and costPrice != ''">and st.cost_price = #{costPrice}</if>
            <if test="costSum != null and costSum != ''">and st.cost_sum = #{costSum}</if>
            <if test="wholePrice != null and wholePrice != ''">and st.whole_price = #{wholePrice}</if>
            <if test="wholeSum != null and wholeSum != ''">and st.whole_sum = #{wholeSum}</if>
            <if test="positionName != null and positionName != ''">and st.position_name = #{positionName}</if>
            <if test="rightYuanYongQJ != null and rightYuanYongQJ != ''">and s.sph = #{rightYuanYongQJ}</if>
            <if test="rightYuanYongZJ != null and rightYuanYongZJ != ''">and c.cyl = #{rightYuanYongZJ}</if>
            <if test="leftYuanYongQJ != null and leftYuanYongQJ != ''">and s.sph = #{leftYuanYongQJ}</if>
            <if test="leftYuanYongZJ != null and leftYuanYongZJ != ''">and c.cyl = #{leftYuanYongZJ}</if>
        </where>
    </select>

    <!-- 查询仓位 -->
    <select id="findPosition" resultType="com.shiguang.mfrs.domain.PositionDO">
        select `position_id`,`position_num`,`depart_number`,`depart_name`,`position_name` from c_position
        <where>
            <if test="departNumber != null and departNumber != ''">and depart_number = #{departNumber}</if>
        </where>
    </select>

    <select id="getGoodsNum" resultType="com.shiguang.stock.domain.StockDO">
    select `id`,`goods_num`, count(goods_count) as goodsCount  from stock where goods_num = #{value} group by goods_num
</select>
    <!--镜架【商】【品】【查】【询】-->
    <select id="selectJingjia" resultType="com.shiguang.product.domain.ProducaDO">
        select p.produc_num,p.produc_name,p.produc_factory,u.unitname,
        p.factory,p.retail_price,p.tax_price,p.produc_factorycolor,m.materialname,p.size,p.produc_code,
        p.trade_price,p.transfer_price
        from aa_produca p join c_unit u on p.unitid=u.unitid
        join c_material m on p.materialid=m.materialid
        join a_technology t on p.technology_id=t.technology_id
        <where>
            <if test="producNum != null and producNum != ''">and p.produc_num = #{producNum}</if>
            <if test="producCode != null and producCode != ''">and p.produc_code = #{producCode}</if>
            <if test="producName != null and producName != ''">and p.produc_name = #{producName}</if>
            <if test="mfrsid != null and mfrsid != ''">and p.mfrsid = #{mfrsid}</if>
            <if test="brandid != null and brandid != ''">and p.brandid = #{brandid}</if>
            <if test="factory != null and factory != ''">and p.factory = #{factory}</if>
            <if test="producFactory != null and producFactory != ''">and p.produc_factory = #{producFactory}</if>
            <if test="producFactorycolor != null and producFactorycolor != ''">and p.produc_factorycolor =
                #{producFactorycolor}
            </if>
            <if test="sizes != null and sizes != ''">and p.size = #{sizes}</if>
            <if test="technologyId != null and technologyId != ''">and t.technology_id = #{technologyId}</if>
            <if test="materialid != null and materialid != ''">and m.materialid = #{materialid}</if>
        </where>
    </select>
    <!--配件【商】【品】【查】【询】-->
    <select id="selectPeijian" resultType="com.shiguang.product.domain.PartsDO">
        select p.produc_num,p.produc_name,p.produc_factory,u.unitname,
        p.factory,p.retail_price,p.tax_price,p.parts_style,p.produc_code,
        p.trade_price,p.transfer_price
        from aa_parts p join c_unit u on p.unitid=u.unitid
        <where>
            <if test="producNum != null and producNum != ''">and p.produc_num = #{producNum}</if>
            <if test="producCode != null and producCode != ''">and p.produc_code = #{producCode}</if>
            <if test="producName != null and producName != ''">and p.produc_name = #{producName}</if>
            <if test="mfrsid != null and mfrsid != ''">and p.mfrsid = #{mfrsid}</if>
            <if test="brandid != null and brandid != ''">and p.brandid = #{brandid}</if>
            <if test="partsStyle != null and partsStyle != ''">and p.parts_style = #{partsStyle}</if>
            <if test="producFactory != null and producFactory != ''">and p.produc_factory = #{producFactory}</if>
            <if test="factory != null and factory != ''">and p.factory = #{factory}</if>
        </where>
    </select>
    <!--镜片定做【商】【品】【查】【询】-->
    <select id="selectJpdz" resultType="com.shiguang.product.domain.JpdzDO">
    select j.produc_num,j.produc_name,u.unitname,j.factory,j.retail_price,j.tax_price,j.sph_up,j.sph_down,j.cyl_up,
    j.cyl_down,j.lightbelow_left,j.lightbelow_right,r.refractivityvalue,l.light_name,le.lens_name,g.gradual_name,f.function_name,
    j.produc_code,j.trade_price,j.transfer_price
    from aa_jpdz j join c_unit u on j.unitid=u.unitid
    join c_refractivity r on j.refractivityid=r.refractivityid
    join p_light l on j.light_id=l.light_id
    join p_lens le on j.lens_id=le.lens_id
    join p_gradual g on j.gradual_id=g.gradual_id
    join p_function f on j.function_id=f.function_id
    where j.mfrsid=#{mfrsid}
</select>
    <!--镜片成品【商】【品】【查】【询】-->
    <select id="selectJpcp" resultType="com.shiguang.product.domain.JpdzDO">
    select j.produc_num,j.produc_name,u.unitname,j.retail_price,j.tax_price,s.sph,c.cyl,
        li.lightbelow,r.refractivityvalue,l.light_name,le.lens_name,g.gradual_name,f.function_name,
        j.produc_code,j.trade_price,j.transfer_price
        from aa_jpcp j join c_unit u on j.unitid=u.unitid join a_sph s on j.sph_id=s.sph_id
        join a_cyl c on j.cyl_id=c.cyl_id join a_lightbelow li on j.lightbelow_id=li.lightbelow_id
        join c_refractivity r on j.refractivityid=r.refractivityid
        join p_light l on j.light_id=l.light_id
        join p_lens le on j.lens_id=le.lens_id
        join p_gradual g on j.gradual_id=g.gradual_id
        join p_function f on j.function_id=f.function_id
        where j.mfrsid=#{mfrsid}
</select>
    <!--护理液【商】【品】【查】【询】-->
    <select id="selectHly" resultType="com.shiguang.product.domain.HlyDO">
        select
        h.produc_num,h.produc_name,h.produc_factory,h.factory,u.unitname,h.retail_price,h.tax_price,h.main_capacity,h.second_capacity,h.produc_code,
        h.trade_price,h.transfer_price
        from aa_hly h join c_unit u on h.unitid = u.unitid
        <where>
            <if test="producNum != null and producNum != ''">and h.produc_num = #{producNum}</if>
            <if test="producCode != null and producCode != ''">and h.produc_code = #{producCode}</if>
            <if test="producName != null and producName != ''">and h.produc_name = #{producName}</if>
            <if test="mfrsid != null and mfrsid != ''">and h.mfrsid = #{mfrsid}</if>
            <if test="brandid != null and brandid != ''">and h.brandid = #{brandid}</if>
            <if test="mainCapacity != null and mainCapacity != ''">and h.main_capacity = #{mainCapacity}</if>
            <if test="secondCapacity != null and secondCapacity != ''">and h.second_capacity = #{secondCapacity}</if>
            <if test="producFactory != null and producFactory != ''">and h.produc_factory = #{producFactory}</if>
            <if test="factory != null and factory != ''">and h.factory = #{factory}</if>
        </where>
    </select>
    <!--太阳镜【商】【品】【查】【询】-->
    <select id="selectTyj" resultType="com.shiguang.product.domain.TyjDO">
        select t.produc_num,t.produc_name,t.produc_code,t.produc_factory,t.factory,u.unitname,
        t.retail_price,t.tax_price,t.produc_factorycolor,t.size,t.trade_price,t.transfer_price
        from aa_tyj t join c_unit u on t.unitid=u.unitid
        <where>
            <if test="producNum != null and producNum != ''">and t.produc_num = #{producNum}</if>
            <if test="producCode != null and producCode != ''">and t.produc_code = #{producCode}</if>
            <if test="producName != null and producName != ''">and t.produc_name = #{producName}</if>
            <if test="mfrsid != null and mfrsid != ''">and t.mfrsid = #{mfrsid}</if>
            <if test="brandid != null and brandid != ''">and t.brandid = #{brandid}</if>
            <if test="producFactorycolor != null and producFactorycolor != ''">and t.produc_factorycolor =
                #{producFactorycolor}
            </if>
            <if test="size != null and size != ''">and t.size = #{size}</if>
            <if test="producFactory != null and producFactory != ''">and t.produc_factory = #{producFactory}</if>
            <if test="factory != null and factory != ''">and t.factory = #{factory}</if>
        </where>
    </select>
    <!--老花镜【商】【品】【查】【询】-->
    <select id="selectLhj" resultType="com.shiguang.product.domain.OldlensDO">
        select
        o.produc_num,o.produc_name,o.produc_code,o.produc_factory,o.factory,o.retail_price,o.tax_price,u.unitname,
        old.degrees,o.size,o.produc_factorycolor,o.trade_price,o.transfer_price
        from aa_oldlens o join c_unit u on o.unitid=u.unitid join a_olddegrees old on o.old_id=old.old_id
        <where>
            <if test="producNum != null and producNum != ''">and o.produc_num = #{producNum}</if>
            <if test="producCode != null and producCode != ''">and o.produc_code = #{producCode}</if>
            <if test="producName != null and producName != ''">and o.produc_name = #{producName}</if>
            <if test="mfrsid != null and mfrsid != ''">and o.mfrsid = #{mfrsid}</if>
            <if test="brandid != null and brandid != ''">and o.brandid = #{brandid}</if>
            <if test="producFactorycolor != null and producFactorycolor != ''">and o.produc_factorycolor =
                #{producFactorycolor}
            </if>
            <if test="size != null and size != ''">and o.size = #{size}</if>
            <if test="producFactory != null and producFactory != ''">and o.produc_factory = #{producFactory}</if>
            <if test="factory != null and factory != ''">and o.factory = #{factory}</if>
        </where>
    </select>
    <!--耗材【商】【品】【查】【询】-->
    <select id="selectHc" resultType="com.shiguang.product.domain.HcDO">
        select h.produc_num,h.produc_name,h.produc_code,u.unitname,h.retail_price,h.tax_price,h.produc_factory,
        h.trade_price,h.transfer_price from aa_hc h join c_unit u on h.unitid=u.unitid
        <where>
            <if test="producNum != null and producNum != ''">and h.produc_num = #{producNum}</if>
            <if test="producCode != null and producCode != ''">and h.produc_code = #{producCode}</if>
            <if test="producName != null and producName != ''">and h.produc_name = #{producName}</if>
            <if test="mfrsid != null and mfrsid != ''">and h.mfrsid = #{mfrsid}</if>
            <if test="brandid != null and brandid != ''">and h.brandid = #{brandid}</if>
            <if test="producFactory != null and producFactory != ''">and h.produc_factory = #{producFactory}</if>
            <if test="factory != null and factory != ''">and h.factory = #{factory}</if>
        </where>
    </select>
    <!--视光【商】【品】【查】【询】-->
    <select id="selectSg" resultType="com.shiguang.product.domain.ShiguangDO">
        select
        s.produc_num,s.produc_name,s.produc_code,s.factory,s.produc_factory,u.unitname,s.retail_price,s.tax_price,
        s.trade_price,s.transfer_price
        from aa_shiguang s join c_unit u on s.unitid=u.unitid
        <where>
            <if test="producNum != null and producNum != ''">and s.produc_num = #{producNum}</if>
            <if test="producCode != null and producCode != ''">and s.produc_code = #{producCode}</if>
            <if test="producName != null and producName != ''">and s.produc_name = #{producName}</if>
            <if test="mfrsid != null and mfrsid != ''">and s.mfrsid = #{mfrsid}</if>
            <if test="brandid != null and brandid != ''">and s.brandid = #{brandid}</if>
            <if test="producFactory != null and producFactory != ''">and s.produc_factory = #{producFactory}</if>
            <if test="factory != null and factory != ''">and s.factory = #{factory}</if>
        </where>
    </select>

    <!--【是否已存在商品信息】-->
    <select id="haveNum" resultType="com.shiguang.stock.domain.StockDO">
        select  goods_count from stock where goods_num=#{goodsNum} order by id
    </select>
    <!--【库存查询】-->
    <select id="kccxList" resultType="com.shiguang.stock.domain.StockDO">
        select s.goods_num,s.goods_code,s.goods_name,s.goods_count,g.goodsname
        'gdname',m.mfrsname,s.retail_price,s.price_sum,
        s.cost_price,s.cost_sum,s.whole_price,s.whole_sum,s.position_name
        from stock s join c_goods g on s.goods_type=g.goodsid join c_mfrs m on s.mfrsid=m.mfrsid
        <where>
            <if test="goodsNum != null and goodsNum != ''">and s.goods_num = #{goodsNum}</if>
            <if test="goodsCode != null and goodsCode != ''">and s.goods_code = #{goodsCode}</if>
            <if test="goodsName != null and goodsName != ''">and s.goods_name = #{goodsName}</if>
            <if test="goodsType != null and goodsType != ''">and s.goods_type = #{goodsType}</if>
        </where>
    </select>
</mapper>