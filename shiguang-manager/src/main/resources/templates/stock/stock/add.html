<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="keywords" content="" />
    <meta name="description" content="" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <title>采购收货新增</title>
    <link rel="stylesheet" href="/css/css.css" type="text/css">
    <!--<link rel="stylesheet" href="/css/date.css" type="text/css">-->



</head>

<body>
    <form class="form-horizontal m-t" id="signupForm">
        <div class="new_h3">采购收货新增</div>
        <div class="m40 tabS PHGL">
            <h3>检查条件</h3>
            <table border="0" cellspacing="0" cellpadding="0">
                <tbody>
                    <tr>
                        <td>单据编号：</td>
                        <td>
                            <input id="danjuNumber" name="danjuNumber" th:value="${uuidstr}" type="text"
                                style="background-color: #e4e4e4" readonly />
                        </td>
                        <td>入库人：</td>
                        <td><input id="zhidanPeople" name="zhidanPeople" th:value="${optometryName}" type="text"
                                style="background-color: #e4e4e4" readonly /></td>
                        <td>采购类型：</td>
                        <td width="25%">
                            <select id="goodsType" name="goodsType" onchange="goodsidstr()">
                                <option></option>
                                <option th:each="ls:${goodsDOList}" th:text="${ls.goodsname}" th:value="${ls.goodsid}">
                                </option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td>制造商：</td>
                        <td>
                            <input id="mfrsid" name="mfrsid" type="hidden" />
                            <input id="mfrsName" name="mfrsName" type="text" readonly />
                            <input type="button" class="XZ-btn" value="选择" onclick="choiceMfrs()" />
                        </td>
                        <td>供应商：</td>
                        <td>
                            <input id="mfrsNames" name="mfrsNames" type="text" readonly />
                        </td>
                        <td>收入仓位：</td>
                        <td>
                            <select id="positionId" name="positionId">
                                <option th:each="ls:${positionDOList}" th:text="${ls.positionName}"
                                    th:value="${ls.positionId}"></option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td>运单号：</td>
                        <td><input id="yundanNumber" name="yundanNumber" type="text" /></td>
                        <td>单据日期：</td>
                        <td><input id="danjuDay" name="danjuDay" th:value="${createTime}" type="text"
                                style="background-color: #e4e4e4" readonly /></td>
                        <!--<td>厂家订单号：</td>-->
                        <!--<td><input id="factoryNumber" name="factoryNumber" type="text"/><em>*</em></td>-->
                    </tr>
                    <tr>
                        <td>备注：</td>
                        <td colspan="5"><textarea id="beizhu" name="beizhu" rows="3"></textarea></td>
                    </tr>
                </tbody>
            </table>

            <div class="HH_btns">
                <div class="Xbtn">
                    <input type="button" value="单品添加商品" onclick="choiceGoods()" />
                    <!--<input type="button" value="已核销订单添加商品"/>-->
                    <!--<input type="button" value="二维表添加商品"/>-->
                    <!--<input class="HgreenBG" type="button" value="打印条码"/>-->
                </div>
                <div class="Cbtn buyBtns">
                    <input id="status" name="status" value="1" type="hidden" />
                    <input id="returnzt" name="returnzt" value="1" type="hidden" />
                    <input id="username" name="username" value="未收货" type="hidden" />
                    <input type="button" class="H_bc" value="保存并审核" onclick="save()" />
                </div>
            </div>

        </div>

        <!--商品信息-->
        <div class="m40 tabS SPmsg">
            <h3>商品信息&nbsp;&nbsp;&nbsp;&nbsp;
                <span style="color: red">当前页数量：</span>
                <input style="color: red;font-size: 15px;" id="newcount" name="newcount" readonly/>
            </h3>

            <table border="0" cellspacing="0" cellpadding="0" class="buyBtns">
                <tbody>
                    <tr id="tab1" style="display:none">
                        <td style="width: 100%;" class="Choose">
                            <table >
                                <tr class="thead">
                                    <td style="display: none">商品代码</td>
                                    <td>商品名称</td>
                                    <td>型号</td>
                                    <td>色号</td>
                                    <td>框架材质</td>
                                    <td>框架尺寸</td>
                                    <td style="display: none">入库时间</td>
                                    <td>商品条码</td>
                                    <td style="display: none">标准零售价</td>
                                    <td style="display: none">含税单价</td>
                                    <td style="display: none">批发价格</td>
                                    <td style="display: none">调货成本</td>
                                    <td style="display: none">单位</td>
                                    <td style="display: none">商品品种</td>
                                    <td style="display: none">商品id</td>
                                    <td>效期</td>
                                    <td>批号</td>
                                    <td>注册证号</td>
                                    <td>生产日期</td>
                                    <td>数量</td>
                                    <td style="color: #ff0000 ; display: none">当前页数量</td>
                                    <td>操作</td>


                                </tr>

                                <tr style="font-weight:bold;font-size: 15px;" class="heji1">
                                    <!--<td colspan="10" style="text-align:right;">合计</td>-->
                                    <!--<td value="0"></td>-->
                                    <!--<input id="heji" name="heji" value="0" type="text"/>-->
                                </tr>
                            </table>
                        </td>
                    </tr>
                    <tr id="tab2" style="display:none">
                        <td style="width: 100%;" class="Choose">
                            <table >
                                <tr class="thead">
                                    <td style='display: none'>商品代码</td>
                                    <td>商品名称</td>
                                    <td>型号</td>
                                    <td>配件型</td>
                                    <td style='display: none'>入库时间</td>
                                    <td>商品条码</td>
                                    <td style="display: none">标准零售价</td>
                                    <td style="display: none">含税单价</td>
                                    <td style="display: none">批发价格</td>
                                    <td style="display: none">调货成本</td>
                                    <td style="display: none">单位</td>
                                    <td style="display: none">商品品种</td>
                                    <td style="display: none">商品id</td>
                                    <td>效期</td>
                                    <td>批号</td>
                                    <td>注册证号</td>
                                    <td>生产日期</td>
                                    <td>数量</td>
                                    <td style="color: #ff0000 ; display: none">当前页数量</td>
                                    <td>操作</td>
                                </tr>
                                <tr style="font-weight:bold;font-size: 15px;" class="heji2">
                                    <!--<td colspan="12" style="text-align:right;">合计：</td>-->
                                    <!--<td>0</td>-->
                                </tr>
                            </table>
                        </td>
                    </tr>
                    <tr id="tab3" style="display:none" >
                        <td style="width: 100%;"class="Choose">
                            <table>
                                <tr class="thead">
                                    <td style='display: none'>商品代码</td>
                                    <td>商品名称</td>
                                    <td style='display: none'>型号</td>
                                    <td>球镜</td>
                                    <td>柱镜</td>
                                    <td>下加光</td>
                                    <td>折射率</td>
                                    <td style='display: none'>光度分类</td>
                                    <td style='display: none'>材料分类</td>
                                    <td style='display: none'>入库时间</td>
                                    <td>商品条码</td>
                                    <td style="display: none">标准零售价</td>
                                    <td style="display: none">含税单价</td>
                                    <td style="display: none">批发价格</td>
                                    <td style="display: none">调货成本</td>
                                    <td style="display: none">单位</td>
                                    <td style="display: none">商品品种</td>
                                    <td style="display: none">镜片类型</td>
                                    <td style="display: none">商品id</td>
                                    <td>效期</td>
                                    <td>批号</td>
                                    <td>注册证号</td>
                                    <td>生产日期</td>
                                    <td>数量</td>
                                    <td style="color: #ff0000 ; display: none">当前页数量</td>
                                    <td>操作</td>
                                </tr>
                                <tr style="font-weight:bold;font-size: 15px;" class="heji3">
                                    <!--<td colspan="12" style="text-align:right;">合计：</td>-->
                                    <!--<td>0</td>-->
                                </tr>
                            </table>
                        </td>
                    </tr>
                    <tr id="tab4" style="display:none" >
                        <td style="width: 100%;" class="Choose">
                            <table>
                                <tr class="thead">
                                    <td style='display: none'>商品代码</td>
                                    <td>商品名称</td>
                                    <td style='display: none'>型号</td>
                                    <td>球镜</td>
                                    <td>柱镜</td>
                                    <td>曲率</td>
                                    <td>直径</td>
                                    <td>使用类型</td>
                                    <td style='display: none'>抛弃型分类</td>
                                    <td style='display: none'>入库时间</td>
                                    <td style='display: none'>商品条码</td>
                                    <td style="display: none">标准零售价</td>
                                    <td style="display: none">含税单价</td>
                                    <td style="display: none">批发价格</td>
                                    <td style="display: none">调货成本</td>
                                    <td style="display: none">单位</td>
                                    <td style="display: none">商品品种</td>
                                    <td style="display: none">镜片类型</td>
                                    <td style="display: none">商品id</td>
                                    <td>效期</td>
                                    <td>批号</td>
                                    <td>注册证号</td>
                                    <td>生产日期</td>
                                    <td>数量</td>
                                    <td style="color: #ff0000 ; display: none">当前页数量</td>
                                    <td>操作</td>
                                </tr>
                                <tr style="font-weight:bold;font-size: 15px;" class="heji4">
                                    <!--<td colspan="12" style="text-align:right;">合计：</td>-->
                                    <!--<td>0</td>-->
                                </tr>
                            </table>
                        </td>
                    </tr>

                    <tr id="tab5" style="display:none">
                        <td style="width: 100%;" class="Choose">
                            <table>
                                <tr class="thead">
                                    <td style='display: none'>商品代码</td>
                                    <td>商品名称</td>
                                    <td>型号</td>
                                    <td>主容量</td>
                                    <td>次容量</td>
                                    <td style='display: none'>入库时间</td>
                                    <td>商品条码</td>
                                    <td style="display: none">标准零售价</td>
                                    <td style="display: none">含税单价</td>
                                    <td style="display: none">批发价格</td>
                                    <td style="display: none">调货成本</td>
                                    <td style="display: none">单位</td>
                                    <td style="display: none">商品品种</td>
                                    <td style="display: none">商品id</td>
                                    <td>效期</td>
                                    <td>批号</td>
                                    <td>注册证号</td>
                                    <td>生产日期</td>
                                    <td>数量</td>
                                    <td style="color: #ff0000 ; display: none">当前页数量</td>
                                    <td>操作</td>
                                </tr>
                                <tr style="font-weight:bold;font-size: 15px;" class="heji5">
                                    <!--<td colspan="12" style="text-align:right;">合计：</td>-->
                                    <!--<td>0</td>-->
                                </tr>
                            </table>
                        </td>
                    </tr>
                    <tr id="tab6" style="display:none">
                        <td style="width: 100%;" class="Choose">
                            <table>
                                <tr class="thead">
                                    <td style='display: none'>商品代码</td>
                                    <td>商品名称</td>
                                    <td>型号</td>
                                    <td>色号</td>
                                    <td>框架尺寸</td>
                                    <td style='display: none'>入库时间</td>
                                    <td>商品条码</td>
                                    <td style="display: none">标准零售价</td>
                                    <td style="display: none">含税单价</td>
                                    <td style="display: none">批发价格</td>
                                    <td style="display: none">调货成本</td>
                                    <td style="display: none">单位</td>
                                    <td style="display: none">商品品种</td>
                                    <td style="display: none">商品id</td>
                                    <td>效期</td>
                                    <td>批号</td>
                                    <td>注册证号</td>
                                    <td>生产日期</td>
                                    <td>数量</td>
                                    <td style="color: #ff0000 ; display: none">当前页数量</td>
                                    <td>操作</td>
                                </tr>
                                <tr style="font-weight:bold;font-size: 15px;" class="heji6">
                                    <!--<td colspan="12" style="text-align:right;">合计：</td>-->
                                    <!--<td>0</td>-->
                                </tr>
                            </table>
                        </td>
                    </tr>
                    <tr id="tab7" style="display:none">
                        <td style="width: 100%;" class="Choose">
                            <table>
                                <tr class="thead">
                                    <td style='display: none'>商品代码</td>
                                    <td>商品名称</td>
                                    <td>型号</td>
                                    <td>框架尺寸</td>
                                    <td>老花镜度数</td>
                                    <td>厂家色号</td>
                                    <td style='display: none'>入库时间</td>
                                    <td>商品条码</td>
                                    <td style="display: none">标准零售价</td>
                                    <td style="display: none">含税单价</td>
                                    <td style="display: none">批发价格</td>
                                    <td style="display: none">调货成本</td>
                                    <td style="display: none">单位</td>
                                    <td style="display: none">商品品种</td>
                                    <td style="display: none">商品id</td>
                                    <td>效期</td>
                                    <td>批号</td>
                                    <td>注册证号</td>
                                    <td>生产日期</td>
                                    <td>数量</td>
                                    <td style="color: #ff0000 ; display: none">当前页数量</td>
                                    <td>操作</td>
                                </tr>
                                <tr style="font-weight:bold;font-size: 15px;" class="heji7">
                                    <!--<td colspan="12" style="text-align:right;">合计：</td>-->
                                    <!--<td>0</td>-->
                                </tr>
                            </table>
                        </td>
                    </tr>
                    <tr id="tab8" style="display:none">
                        <td style="width: 100%;" class="Choose">
                            <table>
                                <tr class="thead">
                                    <td style='display: none'>商品代码</td>
                                    <td>商品名称</td>
                                    <td>型号</td>
                                    <td style='display: none'>入库时间</td>
                                    <td>商品条码</td>
                                    <td style="display: none">标准零售价</td>
                                    <td style="display: none">含税单价</td>
                                    <td style="display: none">批发价格</td>
                                    <td style="display: none">调货成本</td>
                                    <td style="display: none">单位</td>
                                    <td style="display: none">商品品种</td>
                                    <td style="display: none">商品id</td>
                                    <td>效期</td>
                                    <td>批号</td>
                                    <td>注册证号</td>
                                    <td>生产日期</td>
                                    <td>数量</td>
                                    <td style="color: #ff0000 ; display: none">当前页数量</td>
                                    <td>操作</td>
                                </tr>
                                <tr style="font-weight:bold;font-size: 15px;" class="heji8">
                                    <!--<td colspan="12" style="text-align:right;">合计：</td>-->
                                    <!--<td>0</td>-->
                                </tr>
                            </table>
                        </td>
                    </tr>
                    <tr id="tab9" style="display:none" >
                        <td style="width: 100%;" class="Choose">
                            <table>
                                <tr class="thead">
                                    <td style='display: none'>商品代码</td>
                                    <td>商品名称</td>
                                    <td>型号</td>
                                    <td style='display: none'>入库时间</td>
                                    <td>商品条码</td>
                                    <td style="display: none">标准零售价</td>
                                    <td style="display: none">含税单价</td>
                                    <td style="display: none">批发价格</td>
                                    <td style="display: none">调货成本</td>
                                    <td style="display: none">单位</td>
                                    <td style="display: none">商品品种</td>
                                    <td style="display: none">商品id</td>
                                    <td>效期</td>
                                    <td>批号</td>
                                    <td>注册证号</td>
                                    <td>生产日期</td>
                                    <td>数量</td>
                                    <td style="color: #ff0000 ; display: none">当前页数量</td>
                                    <td>操作</td>
                                </tr>
                                <tr style="font-weight:bold;font-size: 15px;" class="heji9">
                                    <!--<td colspan="12" style="text-align:right;">合计：</td>-->
                                    <!--<td>0</td>-->
                                </tr>
                            </table>
                        </td>
                    </tr>
                </tbody>
            </table>
            <div class="Cbtn buyBtns">
                <input type="button" class="H_bc" value="保存并审核" onclick="save()" />
                <span style="color: red">当前页数量：</span>
                <input style="color: red;font-size: 15px;" id="newcounts" name="newcount" readonly/>
            </div>
        </div>
    </form>
    <div th:include="include::footer"></div>
    <script type="text/javascript" src="/js/appjs/stock/stock/stock.js"></script>
    <script type="text/javascript" src="/js/appjs/stock/stock/showdate.js"></script>
    <!--<script type="text/javascript" src="/js/appjs/stock/stock/date.js"></script>-->
    <script type="text/javascript">
        $(document).ready(function () {
           hejiadd();
        });
        var a = 0;
        var b = 0;
        var barHtml="";
        var flag="";
        var flags="";
        var arr = new Array();
        var countarr = new Array();
        // var addcount = 0;

        function dingdanNum() {
            var goodsid = document.getElementById('goodsType').value;
            var mfrsid = document.getElementById('mfrsid').value;
            // layer.alert(goodsid);
            if (goodsid == "") {
                layer.alert("请选择采购类型！");
            } else if (goodsid != "" && mfrsid == "") {
                layer.alert("请选择所属制造商！");
            }
        }

        function tuihuiNum() {
            var goodsid = document.getElementById('goodsType').value;
            var mfrsid = document.getElementById('mfrsid').value;
            // layer.alert(goodsid);
            if (goodsid == "") {
                layer.alert("请选择采购类型！");
            } else if (goodsid != "" && mfrsid == "") {
                layer.alert("请选择所属制造商！");
            }
        }

        function goodsidstr() {
            var value = $("#goodsType option:selected").text();
            if (value == '镜架') {
                arr = new Array();
                $("#mfrsid").val("");
                $("#mfrsName").val("");
                $("#mfrsNames").val("");
                $("input[name='newcount']").val("");
                addcount=0;
                $(".val2").remove();
                $(".val3").remove();
                $(".val4").remove();
                $(".val5").remove();
                $(".val6").remove();
                $(".val7").remove();
                $(".val8").remove();
                $(".val9").remove();
                tab1.style = "display: block";
                tab2.style = "display: none";
                tab3.style = "display: none";
                tab4.style = "display: none";
                tab5.style = "display: none";
                tab6.style = "display: none";
                tab7.style = "display: none";
                tab8.style = "display: none";
                tab9.style = "display: none";
                hejiadd();
            } else if (value == '配件') {
                arr = new Array();
                $("#mfrsid").val("");
                $("#mfrsName").val("");
                $("#mfrsNames").val("");
                $("input[name='newcount']").val("");
                addcount=0;
                $(".val1").remove();
                $(".val3").remove();
                $(".val4").remove();
                $(".val5").remove();
                $(".val6").remove();
                $(".val7").remove();
                $(".val8").remove();
                $(".val9").remove();
                tab1.style = "display: none";
                tab2.style = "display: block";
                tab3.style = "display: none";
                tab4.style = "display: none";
                tab5.style = "display: none";
                tab6.style = "display: none";
                tab7.style = "display: none";
                tab8.style = "display: none";
                tab9.style = "display: none";
                hejiadd();
            } else if (value == '镜片') {
                arr = new Array();
                $("#mfrsid").val("");
                $("#mfrsName").val("");
                $("#mfrsNames").val("");
                $("input[name='newcount']").val("");
                addcount=0;
                $(".val1").remove();
                $(".val2").remove();
                $(".val4").remove();
                $(".val5").remove();
                $(".val6").remove();
                $(".val7").remove();
                $(".val8").remove();
                $(".val9").remove();
                tab1.style = "display: none";
                tab2.style = "display: none";
                tab3.style = "display: block";
                tab4.style = "display: none";
                tab5.style = "display: none";
                tab6.style = "display: none";
                tab7.style = "display: none";
                tab8.style = "display: none";
                tab9.style = "display: none";
                hejiadd();
            } else if (value == '隐形') {
                arr = new Array();
                $("#mfrsid").val("");
                $("#mfrsName").val("");
                $("#mfrsNames").val("");
                $("input[name='newcount']").val("");
                addcount=0;
                $(".val1").remove();
                $(".val2").remove();
                $(".val3").remove();
                $(".val5").remove();
                $(".val6").remove();
                $(".val7").remove();
                $(".val8").remove();
                $(".val9").remove();
                tab1.style = "display: none";
                tab2.style = "display: none";
                tab3.style = "display: none";
                tab4.style = "display: block";
                tab5.style = "display: none";
                tab6.style = "display: none";
                tab7.style = "display: none";
                tab8.style = "display: none";
                tab9.style = "display: none";
                hejiadd();
            } else if (value == '护理液') {
                arr = new Array();
                $("#mfrsid").val("");
                $("#mfrsName").val("");
                $("#mfrsNames").val("");
                $("input[name='newcount']").val("");
                addcount=0;
                $(".val1").remove();
                $(".val2").remove();
                $(".val3").remove();
                $(".val4").remove();
                $(".val6").remove();
                $(".val7").remove();
                $(".val8").remove();
                $(".val9").remove();
                tab1.style = "display: none";
                tab2.style = "display: none";
                tab3.style = "display: none";
                tab4.style = "display: none";
                tab5.style = "display: block";
                tab6.style = "display: none";
                tab7.style = "display: none";
                tab8.style = "display: none";
                tab9.style = "display: none";
                hejiadd();
            } else if (value == '太阳镜') {
                arr = new Array();
                $("#mfrsid").val("");
                $("#mfrsName").val("");
                $("#mfrsNames").val("");
                $("input[name='newcount']").val("");
                addcount=0;
                $(".val1").remove();
                $(".val2").remove();
                $(".val3").remove();
                $(".val4").remove();
                $(".val5").remove();
                $(".val7").remove();
                $(".val8").remove();
                $(".val9").remove();
                tab1.style = "display: none";
                tab2.style = "display: none";
                tab3.style = "display: none";
                tab4.style = "display: none";
                tab5.style = "display: none";
                tab6.style = "display: block";
                tab7.style = "display: none";
                tab8.style = "display: none";
                tab9.style = "display: none";
                hejiadd();
            } else if (value == '老花镜') {
                arr = new Array();
                $("#mfrsid").val("");
                $("#mfrsName").val("");
                $("#mfrsNames").val("");
                $("input[name='newcount']").val("");
                addcount=0;
                $(".val1").remove();
                $(".val2").remove();
                $(".val3").remove();
                $(".val4").remove();
                $(".val5").remove();
                $(".val6").remove();
                $(".val8").remove();
                $(".val9").remove();
                tab1.style = "display: none";
                tab2.style = "display: none";
                tab3.style = "display: none";
                tab4.style = "display: none";
                tab5.style = "display: none";
                tab6.style = "display: none";
                tab7.style = "display: block";
                tab8.style = "display: none";
                tab9.style = "display: none";
                hejiadd();
            } else if (value == '耗材') {
                arr = new Array();
                $("#mfrsid").val("");
                $("#mfrsName").val("");
                $("#mfrsNames").val("");
                $("input[name='newcount']").val("");
                addcount=0;
                $(".val1").remove();
                $(".val2").remove();
                $(".val3").remove();
                $(".val4").remove();
                $(".val5").remove();
                $(".val6").remove();
                $(".val7").remove();
                $(".val9").remove();
                tab1.style = "display: none";
                tab2.style = "display: none";
                tab3.style = "display: none";
                tab4.style = "display: none";
                tab5.style = "display: none";
                tab6.style = "display: none";
                tab7.style = "display: none";
                tab8.style = "display: block";
                tab9.style = "display: none";
                hejiadd();
            } else if (value == '视光') {
                arr = new Array();
                $("#mfrsid").val("");
                $("#mfrsName").val("");
                $("#mfrsNames").val("");
                $("input[name='newcount']").val("");
                addcount=0;
                $(".val1").remove();
                $(".val2").remove();
                $(".val3").remove();
                $(".val4").remove();
                $(".val5").remove();
                $(".val6").remove();
                $(".val7").remove();
                $(".val8").remove();
                tab1.style = "display: none";
                tab2.style = "display: none";
                tab3.style = "display: none";
                tab4.style = "display: none";
                tab5.style = "display: none";
                tab6.style = "display: none";
                tab7.style = "display: none";
                tab8.style = "display: none";
                tab9.style = "display: block";
                hejiadd();
            } else {
                arr = new Array();
                $("#mfrsid").val("");
                $("#mfrsName").val("");
                $("#mfrsNames").val("");
                $("input[name='newcount']").val("");
                addcount=0;
                $(".val1").remove();
                $(".val2").remove();
                $(".val3").remove();
                $(".val4").remove();
                $(".val5").remove();
                $(".val6").remove();
                $(".val7").remove();
                $(".val8").remove();
                $(".val9").remove();
                tab1.style = "display: none";
                tab2.style = "display: none";
                tab3.style = "display: none";
                tab4.style = "display: none";
                tab5.style = "display: none";
                tab6.style = "display: none";
                tab7.style = "display: none";
                tab8.style = "display: none";
                tab9.style = "display: none";
                hejiadd();
            }
        }

        // <!--选择制造商-->
        function choiceMfrs() {
            var goodsid = document.getElementById('goodsType').value;
            // layer.alert(goodsid);
            if (goodsid == "") {
                layer.alert("请选择采购类型！");
            } else {
                //选择镜架
                var toIndex = layer.open({
                    type: 2,
                    title: '制造商',
                    maxmin: true,
                    shadeClose: false, // 点击遮罩关闭层
                    area: ['800px', '520px'],
                    content: "/stock/stock/findmfrs/" + goodsid,// iframe的url
                    cancel: function (index, layero) {
                        var rows = $(layero).find("iframe")[0].contentWindow.batchSelect();
                        for (var i = 0; i < rows.length; i++) {
                            $("#mfrsName").val(rows[i].mfrsname);
                            $("#mfrsid").val(rows[i].mfrsnum);
                            // alert(rows[i].mfrsnum);

                            $("#mfrsNames").val(rows[i].mfrsname);
                        }
                    }
                });
                layer.full(toIndex);
            }
        }

        // <!--单品添加商品-->
        function choiceGoods() {
            var goodsid = document.getElementById('goodsType').value;
            var mfrsid = document.getElementById('mfrsid').value;
            var goodVal = $("#goodsType option:selected").text();
            var mfrsname = document.getElementById('mfrsName').value;
            if (goodsid == "") {
                layer.alert("请选择采购类型！");
            } else if (goodsid != "" && mfrsid == "") {
                layer.alert("请选择所属制造商！");
            } else if (goodVal == "镜架") {
                // alert(arr);
                // $(".val1").remove();
                var toIndex = layer.open({
                    type: 2,
                    title: '商品查询',
                    maxmin: true,
                    shadeClose: false, // 点击遮罩关闭层
                    area: ['800px', '520px'],
                    content: "/stock/stock/jingjia/" + mfrsid + "/" + mfrsname,// iframe的url
                    cancel: function (index, layero) {
                        var rows = window[layero.find('iframe')[0]['name']].showCol();
                        lable:
                        {
                            for (var i = 0; i < rows.length; i++) {
                                barHtml += "<tr class='val1'>";
                                barHtml += "<td style='display: none'>" + rows[i].producNum + "</td>";//0
                                barHtml += "<input name='goodsNum' type='hidden' value='" + rows[i].producNum + "'>";//1
                                barHtml += "<td>" + rows[i].viewGoodName+"-型号:"+rows[i].factory+"-色号:"+rows[i].producFactorycolor+"-标价:"+rows[i].retailPrice + "</td>";//2
                                barHtml += "<input name='goodsName' type='hidden' value='" + rows[i].viewGoodName+"-型号:"+rows[i].factory+"-色号:"+rows[i].producFactorycolor+"-标价:"+rows[i].retailPrice + "'>";//3
                                barHtml += "<td>" + rows[i].producFactory + "</td>";//4
                                barHtml += "<input name='factory' type='hidden' value='" + rows[i].producFactory + "'>";//5
                                barHtml += "<td>" + rows[i].producFactorycolor + "</td>";//6
                                barHtml += "<td>" + rows[i].materialName + "</td>";//7
                                barHtml += "<td>" + rows[i].size + "</td>";//8
                                barHtml += "<td style='display: none'>" + rows[i].createTime + "</td>";//9
                                barHtml += "<input name='createTime' type='hidden' value='" + rows[i].createTime + "'>";//10
                                barHtml += "<td >" + rows[i].producCode + "</td>";
                                barHtml += "<input id='goodsCode' name='goodsCode' type='hidden' value='" + rows[i].producCode + "'>";
                                barHtml += "<td style='display: none' >" + rows[i].retailPrice + "</td>";
                                barHtml += "<input name='retailPrice' type='hidden' value='" + rows[i].retailPrice + "'>";//标准零售价---标准
                                barHtml += "<td style='display: none'>" + rows[i].taxPrice + "</td>";
                                barHtml += "<input name='costPrice' type='hidden' value='" + rows[i].taxPrice + "'>";//含税单价----成本
                                barHtml += "<td style='display: none'>" + rows[i].tradePrice + "</td>";
                                barHtml += "<input  name='wholePrice' type='hidden' value='" + rows[i].tradePrice + "'>";//批发价格--批发
                                barHtml += "<td style='display: none'>" + rows[i].transferPrice + "</td>";
                                barHtml += "<input name='transferPrice' type='hidden' value='" + rows[i].transferPrice + "'>";//调货成本
                                barHtml += "<td style='display: none' >" + rows[i].unitname + "</td>";
                                barHtml += "<input name='unit' type='hidden' value='" + rows[i].unitname + "'>";
                                barHtml += "<td  style='display: none'>" + rows[i].brandname + "</td>";
                                barHtml += "<input name='brandname' type='hidden' value='" + rows[i].brandname + "'>";

                                barHtml += "<td  style='display: none'>" + rows[i].classtype + "</td>";
                                barHtml += "<input name='classtype' type='hidden' value='" + rows[i].classtype + "'>";

                                // barHtml += "<td  style='display: none'>" + rows[i].goodsxinxiid + "</td>";
                                // barHtml += "<input name='goodsxinxiid' type='hidden' value='" + rows[i].goodsxinxiid + "'>";

                                // "<td >"+"<input readonly id='useday"+ a +"' name='useday' onClick=\"return Calendar('useday"+ a +"');\" class=\"text_time\" type='text'/>"+ "</td>\n"+
                                barHtml += "<td >" + "<input readonly   name='useday'  type=\"text\" onclick='clickDate1()' class='useday'/>" + "</td>";
                                barHtml += "<td >" + "<input  name='batch' type='text'/>" + "</td>";
                                barHtml += "<td >" + rows[i].medicinecode + "</td>";
                                barHtml += "<input name='zhuceNumber' type='hidden' value='" + rows[i].medicinecode + "'>";
                                // "<td >"+"<input readonly id='produceDay"+ b +"'  name='produceDay' onClick=\"return Calendar('produceDay"+ b +"');\" class=\"text_time\" type='text'/>"+ "</td>\n"+
                                barHtml += "<td >" + "<input readonly   name='produceDay'  type=\"text\" onclick='clickproduceDay1()' class='produceDay'/>" + "</td>";
                                barHtml += "<td  >" + "<input  id='goodsCount' name='goodsCount' oninput=\"value=value.replace(/[^\\d]/g,'')\" type='text'  onchange='hejiadd(this.value)' value='" + rows[i].goodsCount + "' />" + "</td>";
                                barHtml += "<td  style='display: none'>" + "<input  id='allcount' name='allcount' readonly type='text'/>" + "</td>";
                                barHtml += "<td><em  onclick='delertTr(this)'></em></td>";
                                barHtml += "</tr>";
                                // alert($("input[name=goodsCode]").length+"长度");
                                if ($("input[name=goodsCode]").length == 0) {
                                    $(".heji1").before(barHtml);
                                    barHtml = "";
                                } else if ($("input[name=goodsCode]").length != 0) {
                                    // alert($("input[name=danjuNumber]").html())
                                    for (var as = 0; as < $("input[name=goodsCode]").length; as++) {
                                        var goodsCode = $("input[name=goodsCode]").eq(as).val();
                                        var useCount = $("input[name=goodsCount]").eq(as).val();
                                        arr[as] = goodsCode;
                                        countarr[as] = useCount;
                                    }
                                    // alert(arr);
                                    for (var index = 0; index < arr.length; index++) {
                                        // alert(arr[index]+"循环的条码");
                                        // alert(rows[i].producCode+"选中的条码");
                                        if (arr[index] == rows[i].producCode) {
                                            flag = "1";
                                            flags = "修改";
                                            // alert("扫码和原来的一样数量加1");
                                            var count = countarr[index];
                                            $("input[name=goodsCount]").eq(index).val(parseInt(count) + parseInt(1));
                                            barHtml = "";
                                            // break lable;
                                        } else if (arr[index] != rows[i].producCode) {
                                            // alert("新增111");
                                            flag = "0";
                                            flags = "新增";
                                        }
                                    }
                                }
                                if (flags == "新增" && flag == "0") {
                                    // alert("条码没有过新增");
                                    $(".heji1").before(barHtml);
                                    barHtml = "";
                                }
                            }
                        }
                        hejiadd();
                    }
                });
                layer.full(toIndex);
            } else if (goodVal == "配件") {
                // $(".val2").remove();
                var toIndex = layer.open({
                    type: 2,
                    title: '商品查询',
                    maxmin: true,
                    shadeClose: false, // 点击遮罩关闭层
                    area: ['800px', '520px'],
                    content: "/stock/stock/peijian/" + mfrsid + "/" + mfrsname,// iframe的url
                    cancel: function (index, layero) {
                        var rows = window[layero.find('iframe')[0]['name']].showCol();
                        lable:
                        {
                            for (var i = 0; i < rows.length; i++) {
                                barHtml += "<tr class='val2'>";
                                barHtml += "<td style='display: none'>" + rows[i].producNum + "</td>";
                                barHtml += "<input name='goodsNum' type='hidden' value='" + rows[i].producNum + "'>";
                                barHtml += "<td>" + rows[i].viewGoodName+"-型号:"+rows[i].factory+"-标价:"+rows[i].retailPrice + "</td>";
                                barHtml += "<input name='goodsName' type='hidden' value='" + rows[i].viewGoodName +"-型号:"+rows[i].factory+"-标价:"+rows[i].retailPrice+ "'>";
                                barHtml += "<td  >" + rows[i].producFactory + "</td>";
                                barHtml += "<input name='factory' type='hidden' value='" + rows[i].producFactory + "'>";
                                barHtml += "<td  >" + rows[i].partsStyle + "</td>";
                                barHtml += "<td style='display: none'>" + rows[i].createTime + "</td>";
                                barHtml += "<input name='createTime' type='hidden' value='" + rows[i].createTime + "'>";
                                barHtml += "<td  >" + rows[i].producCode + "</td>";
                                barHtml += "<input name='goodsCode' type='hidden' value='" + rows[i].producCode + "'>";
                                barHtml += "<td style='display:none;' >" + rows[i].retailPrice + "</td>";
                                barHtml += "<input name='retailPrice' type='hidden' value='" + rows[i].retailPrice + "'>";
                                barHtml += "<td style='display: none' >" + rows[i].taxPrice + "</td>";
                                barHtml += "<input name='costPrice' type='hidden' value='" + rows[i].taxPrice + "'>";
                                barHtml += "<td  style='display: none'>" + rows[i].tradePrice + "</td>";
                                barHtml += "<input  name='wholePrice' type='hidden' value='" + rows[i].tradePrice + "'>";
                                barHtml += "<td style='display: none' >" + rows[i].transferPrice + "</td>";
                                barHtml += "<input name='transferPrice' type='hidden' value='" + rows[i].transferPrice + "'>";
                                barHtml += "<td style='display: none' >" + rows[i].unitname + "</td>";
                                barHtml += "<input name='unit' type='hidden' value='" + rows[i].unitname + "'>";
                                barHtml += "<td  style='display: none'>" + rows[i].brandname + "</td>";
                                barHtml += "<input name='brandname' type='hidden' value='" + rows[i].brandname + "'>";

                                barHtml += "<td  style='display: none'>" + rows[i].classtype + "</td>";
                                barHtml += "<input name='classtype' type='hidden' value='" + rows[i].classtype + "'>";
                                // barHtml += "<td  style='display: none'>" + rows[i].goodsxinxiid + "</td>";
                                // barHtml += "<input name='goodsxinxiid' type='hidden' value='" + rows[i].goodsxinxiid + "'>";

                                // "<td >"+"<input readonly id='useday"+ a +"' name='useday' onClick=\"return Calendar('useday"+ a +"');\" class=\"text_time\" type='text'/>"+ "</td>\n"+
                                barHtml += "<td >" + "<input readonly   name='useday'  type=\"text\" onclick='clickDate2()' class='useday'/>" + "</td>";
                                barHtml += "<td >" + "<input  name='batch' type='text'/>" + "</td>";
                                barHtml += "<td >" + rows[i].medicinecode + "</td>";
                                barHtml += "<input name='zhuceNumber' type='hidden' value='" + rows[i].medicinecode + "'>";
                                // "<td >"+"<input readonly id='produceDay"+ b +"'  name='produceDay' onClick=\"return Calendar('produceDay"+ b +"');\" class=\"text_time\" type='text'/>"+ "</td>\n"+
                                barHtml += "<td >" + "<input readonly   name='produceDay'  type=\"text\" onclick='clickproduceDay2()' class='produceDay'/>" + "</td>";
                                barHtml += "<td  >" + "<input  id='goodsCount' name='goodsCount' oninput=\"value=value.replace(/[^\\d]/g,'')\" type='text'    onchange='hejiadd(this.value)' value='" + rows[i].goodsCount + "'/>" + "</td>";
                                barHtml += "<td  style='display: none'>" + "<input  id='allcount' name='allcount' readonly type='text'/>" + "</td>";
                                barHtml += "<td><em  onclick='delertTr(this)'></em></td>";
                                barHtml += "</tr>"
                                if ($("input[name=goodsCode]").length == 0) {
                                    $(".heji2").before(barHtml);
                                    barHtml = "";
                                } else if ($("input[name=goodsCode]").length != 0) {
                                    // alert($("input[name=danjuNumber]").html())
                                    for (var as = 0; as < $("input[name=goodsCode]").length; as++) {
                                        var goodsCode = $("input[name=goodsCode]").eq(as).val();
                                        var useCount = $("input[name=goodsCount]").eq(as).val();
                                        arr[as] = goodsCode;
                                        countarr[as] = useCount;
                                    }
                                    for (var index = 0; index < arr.length; index++) {
                                        // alert(arr[index]+"循环的条码");
                                        // alert(rows[i].producCode+"选中的条码");
                                        if (arr[index] == rows[i].producCode) {
                                            flag = "1";
                                            flags = "修改";
                                            // alert("扫码和原来的一样数量加1");
                                            var count = countarr[index];
                                            $("input[name=goodsCount]").eq(index).val(parseInt(count) + parseInt(1));
                                            barHtml = "";
                                            // break lable;
                                        } else if (arr[index] != rows[i].producCode) {
                                            // alert("新增111");
                                            flag = "0";
                                            flags = "新增";
                                        }
                                    }
                                }
                                if (flags == "新增" && flag == "0") {
                                    // alert("条码没有过新增");
                                    $(".heji2").before(barHtml);
                                    barHtml = "";
                                }
                            }
                        }
                        hejiadd();
                    }
                });
                layer.full(toIndex);
            } else if (goodVal == "镜片") {
                // $(".val3").remove();
                var toIndex = layer.open({
                    type: 2,
                    title: '商品查询',
                    maxmin: true,
                    shadeClose: false, // 点击遮罩关闭层
                    area: ['800px', '520px'],
                    content: "/stock/stock/jingpian/" + mfrsid + "/" + mfrsname,// iframe的url
                    cancel: function (index, layero) {
                        var rows = window[layero.find('iframe')[0]['name']].showCol();
                        lable:
                        {
                            for (var i = 0; i < rows.length; i++) {
                                barHtml += "<tr class='val3'>";
                                barHtml += "<td style='display: none'>" + rows[i].producNum + "</td>";
                                barHtml += "<input name='goodsNum' type='hidden' value='" + rows[i].producNum + "'>";
                                barHtml += "<td>" + rows[i].viewGoodName+"-球镜:"+rows[i].sph+"-柱镜:"+rows[i].cyl+"-标价:"+rows[i].retailPrice + "</td>";
                                barHtml += "<input name='goodsName' type='hidden' value='" + rows[i].viewGoodName+"-球镜:"+rows[i].sph+"-柱镜:"+rows[i].cyl+"-标价:"+rows[i].retailPrice + "'>";
                                barHtml += "<td style='display: none'>" + rows[i].factory + "</td>";
                                barHtml += "<input name='factory' type='hidden' value='" + rows[i].factory + "'>";
                                barHtml += "<td>" + rows[i].sph + "</td>";
                                barHtml += "<td>" + rows[i].cyl + "</td>";
                                barHtml += "<td>" + rows[i].lightbelow + "</td>";
                                barHtml += "<td>" + rows[i].refractivityvalue + "</td>";
                                barHtml += "<td style='display: none'>" + rows[i].lightName + "</td>";
                                barHtml += "<td style='display: none'>" + rows[i].lensName + "</td>";
                                barHtml += "<td style='display: none'>" + rows[i].createTime + "</td>";
                                barHtml += "<input name='createTime' type='hidden' value='" + rows[i].createTime + "'>";
                                barHtml += "<td  >" + rows[i].producCode + "</td>";
                                barHtml += "<input name='goodsCode' type='hidden' value='" + rows[i].producCode + "'>";
                                barHtml += "<td style='display: none' >" + rows[i].retailPrice + "</td>";
                                barHtml += "<input name='retailPrice' type='hidden' value='" + rows[i].retailPrice + "'>";
                                barHtml += "<td style='display: none' >" + rows[i].taxPrice + "</td>";
                                barHtml += "<input name='costPrice' type='hidden' value='" + rows[i].taxPrice + "'>";
                                barHtml += "<td style='display: none' >" + rows[i].tradePrice + "</td>";
                                barHtml += "<input  name='wholePrice' type='hidden' value='" + rows[i].tradePrice + "'>";
                                barHtml += "<td style='display: none' >" + rows[i].transferPrice + "</td>";
                                barHtml += "<input name='transferPrice' type='hidden' value='" + rows[i].transferPrice + "'>";
                                barHtml += "<td style='display: none' >" + rows[i].unitname + "</td>";
                                barHtml += "<input name='unit' type='hidden' value='" + rows[i].unitname + "'>";
                                barHtml += "<td  style='display: none'>" + rows[i].brandname + "</td>";
                                barHtml += "<input name='brandname' type='hidden' value='" + rows[i].brandname + "'>";

                                barHtml += "<td  style='display: none'>" + rows[i].classtype + "</td>";
                                barHtml += "<input name='classtype' type='hidden' value='" + rows[i].classtype + "'>";
                                // barHtml += "<td  style='display: none'>" + rows[i].goodsxinxiid + "</td>";
                                // barHtml += "<input name='goodsxinxiid' type='hidden' value='" + rows[i].goodsxinxiid + "'>";
                                // "<td >"+"<input readonly id='useday"+ a +"' name='useday' onClick=\"return Calendar('useday"+ a +"');\" class=\"text_time\" type='text'/>"+ "</td>\n"+
                                barHtml += "<td >" + "<input readonly   name='useday'  type=\"text\" onclick='clickDate3()' class='useday'/>" + "</td>";
                                barHtml += "<td >" + "<input  name='batch' type='text'/>" + "</td>";
                                barHtml += "<td >" + rows[i].medicinecode + "</td>";
                                barHtml += "<input name='zhuceNumber' type='hidden' value='" + rows[i].medicinecode + "'>";
                                // "<td >"+"<input readonly id='produceDay"+ b +"'  name='produceDay' onClick=\"return Calendar('produceDay"+ b +"');\" class=\"text_time\" type='text'/>"+ "</td>\n"+
                                barHtml += "<td >" + "<input readonly   name='produceDay'  type=\"text\" onclick='clickproduceDay3()' class='produceDay'/>" + "</td>";
                                barHtml += "<td  >" + "<input  id='goodsCount' name='goodsCount' oninput=\"value=value.replace(/[^\\d]/g,'')\" type='text'    onchange='hejiadd(this.value)' value='" + rows[i].goodsCount + "'/>" + "</td>";
                                barHtml += "<td  style='display: none'>" + "<input  id='allcount' name='allcount' readonly type='text'/>" + "</td>";
                                barHtml += "<td><em  onclick='delertTr(this)'></em></td>";
                                barHtml += "</tr>"
                                if ($("input[name=goodsCode]").length == 0) {
                                    $(".heji3").before(barHtml);
                                    barHtml = "";
                                } else if ($("input[name=goodsCode]").length != 0) {
                                    // alert($("input[name=danjuNumber]").html())
                                    for (var as = 0; as < $("input[name=goodsCode]").length; as++) {
                                        var goodsCode = $("input[name=goodsCode]").eq(as).val();
                                        var useCount = $("input[name=goodsCount]").eq(as).val();
                                        arr[as] = goodsCode;
                                        countarr[as] = useCount;
                                    }
                                    for (var index = 0; index < arr.length; index++) {
                                        // alert(arr[index]+"循环的条码");
                                        // alert(rows[i].producCode+"选中的条码");
                                        if (arr[index] == rows[i].producCode) {
                                            flag = "1";
                                            flags = "修改";
                                            // alert("扫码和原来的一样数量加1");
                                            var count = countarr[index];
                                            $("input[name=goodsCount]").eq(index).val(parseInt(count) + parseInt(1));
                                            barHtml = "";
                                            // break lable;
                                        } else if (arr[index] != rows[i].producCode) {
                                            // alert("新增111");
                                            flag = "0";
                                            flags = "新增";
                                        }
                                    }
                                }
                                if (flags == "新增" && flag == "0") {
                                    // alert("条码没有过新增");
                                    $(".heji3").before(barHtml);
                                    barHtml = "";
                                }
                            }
                        }
                        hejiadd();
                    }
                });
                layer.full(toIndex);
            } else if (goodVal == "隐形") {
                // $(".val4").remove();
                var toIndex = layer.open({
                    type: 2,
                    title: '商品查询',
                    maxmin: true,
                    shadeClose: false, // 点击遮罩关闭层
                    area: ['800px', '520px'],
                    content: "/stock/stock/yinxing/" + mfrsid + "/" + mfrsname,// iframe的url
                    cancel: function (index, layero) {
                        var rows = window[layero.find('iframe')[0]['name']].showCol();
                        lable:
                        {
                            for (var i = 0; i < rows.length; i++) {

                                barHtml += "<tr class='val4'>";
                                barHtml += "<td style='display: none'>" + rows[i].producNum + "</td>";
                                barHtml += "<input name='goodsNum' type='hidden' value='" + rows[i].producNum + "'>";
                                barHtml += "<td>" + rows[i].viewGoodName+"-球镜:"+rows[i].sph+"-柱镜:"+rows[i].cyl+"-标价:"+rows[i].retailPrice + "</td>";
                                barHtml += "<input name='goodsName' type='hidden' value='" + rows[i].viewGoodName+"-球镜:"+rows[i].sph+"-柱镜:"+rows[i].cyl+"-标价:"+rows[i].retailPrice + "'>";
                                barHtml += "<td style='display: none'>" + rows[i].factory + "</td>";
                                barHtml += "<input name='factory' type='hidden' value='" + rows[i].factory + "'>";
                                barHtml += "<td>" + rows[i].sph + "</td>";
                                barHtml += "<td>" + rows[i].cyl + "</td>";
                                barHtml += "<td>" + rows[i].curvature + "</td>";
                                barHtml += "<td>" + rows[i].diameter + "</td>";
                                barHtml += "<td style='display: none'>" + rows[i].usageName + "</td>";
                                barHtml += "<td style='display: none'>" + rows[i].typeName + "</td>";
                                barHtml += "<td style='display: none'>" + rows[i].createTime + "</td>";
                                barHtml += "<input name='createTime' type='hidden' value='" + rows[i].createTime + "'>";
                                barHtml += "<td  >" + rows[i].producCode + "</td>";
                                barHtml += "<input name='goodsCode' type='hidden' value='" + rows[i].producCode + "'>";
                                barHtml += "<td style='display: none' >" + rows[i].retailPrice + "</td>";
                                barHtml += "<input name='retailPrice' type='hidden' value='" + rows[i].retailPrice + "'>";
                                barHtml += "<td style='display: none' >" + rows[i].taxPrice + "</td>";
                                barHtml += "<input name='costPrice' type='hidden' value='" + rows[i].taxPrice + "'>";
                                barHtml += "<td style='display: none' >" + rows[i].tradePrice + "</td>";
                                barHtml += "<input  name='wholePrice' type='hidden' value='" + rows[i].tradePrice + "'>";
                                barHtml += "<td style='display: none' >" + rows[i].transferPrice + "</td>";
                                barHtml += "<input name='transferPrice' type='hidden' value='" + rows[i].transferPrice + "'>";
                                barHtml += "<td style='display: none' >" + rows[i].unitname + "</td>";
                                barHtml += "<input name='unit' type='hidden' value='" + rows[i].unitname + "'>";
                                barHtml += "<td  style='display: none'>" + rows[i].brandname + "</td>";
                                barHtml += "<input name='brandname' type='hidden' value='" + rows[i].brandname + "'>";

                                barHtml += "<td  style='display: none'>" + rows[i].classtype + "</td>";
                                barHtml += "<input name='classtype' type='hidden' value='" + rows[i].classtype + "'>";
                                // barHtml += "<td  style='display: none'>" + rows[i].goodsxinxiid + "</td>";
                                // barHtml += "<input name='goodsxinxiid' type='hidden' value='" + rows[i].goodsxinxiid + "'>";

                                // "<td >"+"<input readonly id='useday"+ a +"' name='useday' onClick=\"return Calendar('useday"+ a +"');\" class=\"text_time\" type='text'/>"+ "</td>\n"+
                                barHtml += "<td >" + "<input readonly   name='useday'  type=\"text\" onclick='clickDate4()' class='useday'/>" + "</td>";
                                barHtml += "<td >" + "<input  name='batch' type='text'/>" + "</td>";
                                barHtml += "<td >" + rows[i].medicinecode + "</td>";
                                barHtml += "<input name='zhuceNumber' type='hidden' value='" + rows[i].medicinecode + "'>";
                                // "<td >"+"<input readonly id='produceDay"+ b +"'  name='produceDay' onClick=\"return Calendar('produceDay"+ b +"');\" class=\"text_time\" type='text'/>"+ "</td>\n"+
                                barHtml += "<td >" + "<input readonly   name='produceDay'  type=\"text\" onclick='clickproduceDay4()' class='produceDay'/>" + "</td>";
                                barHtml += "<td  >" + "<input  id='goodsCount' name='goodsCount' oninput=\"value=value.replace(/[^\\d]/g,'')\" type='text'    onchange='hejiadd(this.value)' value='" + rows[i].goodsCount + "'/>" + "</td>";
                                barHtml += "<td  style='display: none'>" + "<input  id='allcount' name='allcount' readonly type='text'/>" + "</td>";
                                barHtml += "<td><em  onclick='delertTr(this)'></em></td>";
                                barHtml += "</tr>";
                                if ($("input[name=goodsCode]").length == 0) {
                                    $(".heji4").before(barHtml);
                                    barHtml = "";
                                } else if ($("input[name=goodsCode]").length != 0) {
                                    // alert($("input[name=danjuNumber]").html())
                                    for (var as = 0; as < $("input[name=goodsCode]").length; as++) {
                                        var goodsCode = $("input[name=goodsCode]").eq(as).val();
                                        var useCount = $("input[name=goodsCount]").eq(as).val();
                                        arr[as] = goodsCode;
                                        countarr[as] = useCount;
                                    }
                                    for (var index = 0; index < arr.length; index++) {
                                        // alert(arr[index]+"循环的条码");
                                        // alert(rows[i].producCode+"选中的条码");
                                        if (arr[index] == rows[i].producCode) {
                                            flag = "1";
                                            flags = "修改";
                                            // alert("扫码和原来的一样数量加1");
                                            var count = countarr[index];
                                            $("input[name=goodsCount]").eq(index).val(parseInt(count) + parseInt(1));
                                            barHtml = "";
                                            // break lable;
                                        } else if (arr[index] != rows[i].producCode) {
                                            // alert("新增111");
                                            flag = "0";
                                            flags = "新增";
                                        }
                                    }
                                }
                                if (flags == "新增" && flag == "0") {
                                    // alert("条码没有过新增");
                                    $(".heji4").before(barHtml);
                                    barHtml = "";
                                }
                            }
                        }
                        hejiadd();
                    }
                });
                layer.full(toIndex);
            } else if (goodVal == "护理液") {
                // $(".val5").remove();
                var toIndex = layer.open({
                    type: 2,
                    title: '商品查询',
                    maxmin: true,
                    shadeClose: false, // 点击遮罩关闭层
                    area: ['800px', '520px'],
                    content: "/stock/stock/hly/" + mfrsid + "/" + mfrsname,// iframe的url
                    cancel: function (index, layero) {
                        var rows = window[layero.find('iframe')[0]['name']].showCol();
                        lable:
                        {
                            for (var i = 0; i < rows.length; i++) {
                                barHtml += "<tr class='val5'>";
                                barHtml += "<td style='display: none'>" + rows[i].producNum + "</td>";
                                barHtml += "<input name='goodsNum' type='hidden' value='" + rows[i].producNum + "'>";
                                barHtml += "<td>" + rows[i].viewGoodName+"-型号:"+rows[i].factory+"-标价:"+rows[i].retailPrice + "</td>";
                                barHtml += "<input name='goodsName' type='hidden' value='" + rows[i].viewGoodName+"-型号:"+rows[i].factory+"-标价:"+rows[i].retailPrice + "'>";
                                barHtml += "<td  >" + rows[i].producFactory + "</td>";
                                barHtml += "<input name='factory' type='hidden' value='" + rows[i].producFactory + "'>";
                                barHtml += "<td  >" + rows[i].mainCapacity + "</td>";
                                barHtml += "<td  >" + rows[i].secondCapacity + "</td>";
                                barHtml += "<td style='display: none'>" + rows[i].createTime + "</td>";
                                barHtml += "<input name='createTime' type='hidden' value='" + rows[i].createTime + "'>";
                                barHtml += "<td  >" + rows[i].producCode + "</td>";
                                barHtml += "<input name='goodsCode' type='hidden' value='" + rows[i].producCode + "'>";
                                barHtml += "<td style='display: none'>" + rows[i].retailPrice + "</td>";
                                barHtml += "<input name='retailPrice' type='hidden' value='" + rows[i].retailPrice + "'>";
                                barHtml += "<td style='display: none' >" + rows[i].taxPrice + "</td>";
                                barHtml += "<input name='costPrice' type='hidden' value='" + rows[i].taxPrice + "'>";
                                barHtml += "<td  style='display: none'>" + rows[i].tradePrice + "</td>";
                                barHtml += "<input  name='wholePrice' type='hidden' value='" + rows[i].tradePrice + "'>";
                                barHtml += "<td  style='display: none' >" + rows[i].transferPrice + "</td>";
                                barHtml += "<input name='transferPrice' type='hidden' value='" + rows[i].transferPrice + "'>";
                                barHtml += "<td style='display: none' >" + rows[i].unitname + "</td>";
                                barHtml += "<input name='unit' type='hidden' value='" + rows[i].unitname + "'>";
                                barHtml += "<td style='display: none' >" + rows[i].brandname + "</td>";
                                barHtml += "<input name='brandname' type='hidden' value='" + rows[i].brandname + "'>";

                                barHtml += "<td  style='display: none'>" + rows[i].classtype + "</td>";
                                barHtml += "<input name='classtype' type='hidden' value='" + rows[i].classtype + "'>";
                                // barHtml += "<td  style='display: none'>" + rows[i].goodsxinxiid + "</td>";
                                // barHtml += "<input name='goodsxinxiid' type='hidden' value='" + rows[i].goodsxinxiid + "'>";

                                // "<td >"+"<input readonly id='useday"+ a +"' name='useday' onClick=\"return Calendar('useday"+ a +"');\" class=\"text_time\" type='text'/>"+ "</td>\n"+
                                barHtml += "<td >" + "<input readonly   name='useday'  type=\"text\" onclick='clickDate5()' class='useday'/>" + "</td>";
                                barHtml += "<td >" + "<input  name='batch' type='text'/>" + "</td>";
                                barHtml += "<td >" + rows[i].medicinecode + "</td>";
                                barHtml += "<input name='zhuceNumber' type='hidden' value='" + rows[i].medicinecode + "'>";
                                // "<td >"+"<input readonly id='produceDay"+ b +"'  name='produceDay' onClick=\"return Calendar('produceDay"+ b +"');\" class=\"text_time\" type='text'/>"+ "</td>\n"+
                                barHtml += "<td >" + "<input readonly   name='produceDay'  type=\"text\" onclick='clickproduceDay5()' class='produceDay'/>" + "</td>";
                                barHtml += "<td  >" + "<input  id='goodsCount' name='goodsCount' oninput=\"value=value.replace(/[^\\d]/g,'')\" type='text'    onchange='hejiadd(this.value)' value='" + rows[i].goodsCount + "'/>" + "</td>";
                                barHtml += "<td  style='display: none'>" + "<input  id='allcount' name='allcount' readonly type='text'/>" + "</td>";
                                barHtml += "<td><em  onclick='delertTr(this)'></em></td>";
                                barHtml += "</tr>"

                                if ($("input[name=goodsCode]").length == 0) {
                                    $(".heji5").before(barHtml);
                                    barHtml = "";
                                } else if ($("input[name=goodsCode]").length != 0) {
                                    // alert($("input[name=danjuNumber]").html())
                                    for (var as = 0; as < $("input[name=goodsCode]").length; as++) {
                                        var goodsCode = $("input[name=goodsCode]").eq(as).val();
                                        var useCount = $("input[name=goodsCount]").eq(as).val();
                                        arr[as] = goodsCode;
                                        countarr[as] = useCount;
                                    }
                                    for (var index = 0; index < arr.length; index++) {
                                        // alert(arr[index]+"循环的条码");
                                        // alert(rows[i].producCode+"选中的条码");
                                        if (arr[index] == rows[i].producCode) {
                                            flag = "1";
                                            flags = "修改";
                                            // alert("扫码和原来的一样数量加1");
                                            var count = countarr[index];
                                            $("input[name=goodsCount]").eq(index).val(parseInt(count) + parseInt(1));
                                            barHtml = "";
                                            // break lable;
                                        } else if (arr[index] != rows[i].producCode) {
                                            // alert("新增111");
                                            flag = "0";
                                            flags = "新增";
                                        }
                                    }
                                }
                                if (flags == "新增" && flag == "0") {
                                    // alert("条码没有过新增");
                                    $(".heji5").before(barHtml);
                                    barHtml = "";
                                }
                            }
                        }
                        hejiadd();
                    }
                });
                layer.full(toIndex);
            } else if (goodVal == "太阳镜") {
                // $(".val6").remove();
                var toIndex = layer.open({
                    type: 2,
                    title: '商品查询',
                    maxmin: true,
                    shadeClose: false, // 点击遮罩关闭层
                    area: ['800px', '520px'],
                    content: "/stock/stock/tyj/" + mfrsid + "/" + mfrsname,// iframe的url
                    cancel: function (index, layero) {
                        var rows = window[layero.find('iframe')[0]['name']].showCol();
                        lable:
                        {
                            for (var i = 0; i < rows.length; i++) {
                                barHtml += "<tr class='val6'>";
                                barHtml += "<td style='display: none'>" + rows[i].producNum + "</td>";
                                barHtml += "<input name='goodsNum' type='hidden' value='" + rows[i].producNum + "'>";
                                barHtml += "<td>" + rows[i].viewGoodName+"-型号:"+rows[i].factory+"-颜色:"+rows[i].producFactorycolor+"-标价:"+rows[i].retailPrice + "</td>";
                                barHtml += "<input name='goodsName' type='hidden' value='" + rows[i].viewGoodName+"-型号:"+rows[i].factory+"-颜色:"+rows[i].producFactorycolor+"-标价:"+rows[i].retailPrice + "'>";
                                barHtml += "<td  >" + rows[i].producFactory + "</td>";
                                barHtml += "<input name='factory' type='hidden' value='" + rows[i].producFactory + "'>";
                                barHtml += "<td  >" + rows[i].producFactorycolor + "</td>";
                                barHtml += "<td  >" + rows[i].size + "</td>";
                                barHtml += "<td style='display: none'>" + rows[i].createTime + "</td>";
                                barHtml += "<input name='createTime' type='hidden' value='" + rows[i].createTime + "'>";
                                barHtml += "<td  >" + rows[i].producCode + "</td>";
                                barHtml += "<input name='goodsCode' type='hidden' value='" + rows[i].producCode + "'>";
                                barHtml += "<td style='display: none' >" + rows[i].retailPrice + "</td>";
                                barHtml += "<input name='retailPrice' type='hidden' value='" + rows[i].retailPrice + "'>";
                                barHtml += "<td style='display: none' >" + rows[i].taxPrice + "</td>";
                                barHtml += "<input name='costPrice' type='hidden' value='" + rows[i].taxPrice + "'>";
                                barHtml += "<td style='display: none' >" + rows[i].tradePrice + "</td>";
                                barHtml += "<input  name='wholePrice' type='hidden' value='" + rows[i].tradePrice + "'>";
                                barHtml += "<td style='display: none'  >" + rows[i].transferPrice + "</td>";
                                barHtml += "<input name='transferPrice' type='hidden' value='" + rows[i].transferPrice + "'>";
                                barHtml += "<td style='display: none' >" + rows[i].unitname + "</td>";
                                barHtml += "<input name='unit' type='hidden' value='" + rows[i].unitname + "'>";
                                barHtml += "<td  style='display: none'>" + rows[i].brandname + "</td>";
                                barHtml += "<input name='brandname' type='hidden' value='" + rows[i].brandname + "'>";

                                barHtml += "<td  style='display: none'>" + rows[i].classtype + "</td>";
                                barHtml += "<input name='classtype' type='hidden' value='" + rows[i].classtype + "'>";
                                // barHtml += "<td  style='display: none'>" + rows[i].goodsxinxiid + "</td>";
                                // barHtml += "<input name='goodsxinxiid' type='hidden' value='" + rows[i].goodsxinxiid + "'>";
                                // "<td >"+"<input readonly id='useday"+ a +"' name='useday' onClick=\"return Calendar('useday"+ a +"');\" class=\"text_time\" type='text'/>"+ "</td>\n"+
                                barHtml += "<td >" + "<input readonly   name='useday'  type=\"text\" onclick='clickDate6()' class='useday'/>" + "</td>";
                                barHtml += "<td >" + "<input  name='batch' type='text'/>" + "</td>";
                                barHtml += "<td >" + rows[i].medicinecode + "</td>";
                                barHtml += "<input name='zhuceNumber' type='hidden' value='" + rows[i].medicinecode + "'>";
                                // "<td >"+"<input readonly id='produceDay"+ b +"'  name='produceDay' onClick=\"return Calendar('produceDay"+ b +"');\" class=\"text_time\" type='text'/>"+ "</td>\n"+
                                barHtml += "<td >" + "<input readonly   name='produceDay'  type=\"text\" onclick='clickproduceDay6()' class='produceDay'/>" + "</td>";
                                barHtml += "<td  >" + "<input  id='goodsCount' name='goodsCount' oninput=\"value=value.replace(/[^\\d]/g,'')\" type='text'    onchange='hejiadd(this.value)' value='" + rows[i].goodsCount + "'/>" + "</td>";
                                barHtml += "<td  style='display: none'>" + "<input  id='allcount' name='allcount' readonly type='text'/>" + "</td>";
                                barHtml += "<td><em  onclick='delertTr(this)'></em></td>";
                                barHtml += "</tr>";
                                if ($("input[name=goodsCode]").length == 0) {
                                    $(".heji6").before(barHtml);
                                    barHtml = "";
                                } else if ($("input[name=goodsCode]").length != 0) {
                                    // alert($("input[name=danjuNumber]").html())
                                    for (var as = 0; as < $("input[name=goodsCode]").length; as++) {
                                        var goodsCode = $("input[name=goodsCode]").eq(as).val();
                                        var useCount = $("input[name=goodsCount]").eq(as).val();
                                        arr[as] = goodsCode;
                                        countarr[as] = useCount;
                                    }
                                    for (var index = 0; index < arr.length; index++) {
                                        // alert(arr[index]+"循环的条码");
                                        // alert(rows[i].producCode+"选中的条码");
                                        if (arr[index] == rows[i].producCode) {
                                            flag = "1";
                                            flags = "修改";
                                            // alert("扫码和原来的一样数量加1");
                                            var count = countarr[index];
                                            $("input[name=goodsCount]").eq(index).val(parseInt(count) + parseInt(1));
                                            barHtml = "";
                                            // break lable;
                                        } else if (arr[index] != rows[i].producCode) {
                                            // alert("新增111");
                                            flag = "0";
                                            flags = "新增";
                                        }
                                    }
                                }
                                if (flags == "新增" && flag == "0") {
                                    // alert("条码没有过新增");
                                    $(".heji6").before(barHtml);
                                    barHtml = "";
                                }
                            }
                        }
                        hejiadd();
                    }
                });
                layer.full(toIndex);
            } else if (goodVal == "老花镜") {
                // $(".val7").remove();
                var toIndex = layer.open({
                    type: 2,
                    title: '商品查询',
                    maxmin: true,
                    shadeClose: false, // 点击遮罩关闭层
                    area: ['800px', '520px'],
                    content: "/stock/stock/lhj/" + mfrsid + "/" + mfrsname,// iframe的url
                    cancel: function (index, layero) {
                        var rows = window[layero.find('iframe')[0]['name']].showCol();
                        lable:
                        {
                            for (var i = 0; i < rows.length; i++) {

                                barHtml += "<tr class='val7'>";
                                barHtml += "<td style='display: none'>" + rows[i].producNum + "</td>";
                                barHtml += "<input name='goodsNum' type='hidden' value='" + rows[i].producNum + "'>";
                                barHtml += "<td>" + rows[i].viewGoodName+"-球镜:"+rows[i].oldId+"-型号:"+rows[i].factory+"-标价:"+rows[i].retailPrice + "</td>";
                                barHtml += "<input name='goodsName' type='hidden' value='" + rows[i].viewGoodName+"-球镜:"+rows[i].oldId+"-型号:"+rows[i].factory+"-标价:"+rows[i].retailPrice  + "'>";
                                barHtml += "<td  >" + rows[i].producFactory + "</td>";
                                barHtml += "<input name='factory' type='hidden' value='" + rows[i].producFactory + "'>";
                                barHtml += "<td  >" + rows[i].size + "</td>";
                                barHtml += "<td  >" + rows[i].oldId + "</td>";
                                barHtml += "<td  >" + rows[i].producFactorycolor + "</td>";
                                barHtml += "<td style='display: none'>" + rows[i].createTime + "</td>";
                                barHtml += "<input name='createTime' type='hidden' value='" + rows[i].createTime + "'>";
                                barHtml += "<td  >" + rows[i].producCode + "</td>";
                                barHtml += "<input name='goodsCode' type='hidden' value='" + rows[i].producCode + "'>";
                                barHtml += "<td style='display: none' >" + rows[i].retailPrice + "</td>";
                                barHtml += "<input name='retailPrice' type='hidden' value='" + rows[i].retailPrice + "'>";
                                barHtml += "<td style='display: none' >" + rows[i].taxPrice + "</td>";
                                barHtml += "<input name='costPrice' type='hidden' value='" + rows[i].taxPrice + "'>";
                                barHtml += "<td  style='display: none'>" + rows[i].tradePrice + "</td>";
                                barHtml += "<input  name='wholePrice' type='hidden' value='" + rows[i].tradePrice + "'>";
                                barHtml += "<td  style='display: none' >" + rows[i].transferPrice + "</td>";
                                barHtml += "<input name='transferPrice' type='hidden' value='" + rows[i].transferPrice + "'>";
                                barHtml += "<td style='display: none' >" + rows[i].unitname + "</td>";
                                barHtml += "<input name='unit' type='hidden' value='" + rows[i].unitname + "'>";
                                barHtml += "<td  style='display: none'>" + rows[i].brandname + "</td>";
                                barHtml += "<input name='brandname' type='hidden' value='" + rows[i].brandname + "'>";

                                barHtml += "<td  style='display: none'>" + rows[i].classtype + "</td>";
                                barHtml += "<input name='classtype' type='hidden' value='" + rows[i].classtype + "'>";
                                // barHtml += "<td  style='display: none'>" + rows[i].goodsxinxiid + "</td>";
                                // barHtml += "<input name='goodsxinxiid' type='hidden' value='" + rows[i].goodsxinxiid + "'>";

                                // "<td >"+"<input readonly id='useday"+ a +"' name='useday' onClick=\"return Calendar('useday"+ a +"');\" class=\"text_time\" type='text'/>"+ "</td>\n"+
                                barHtml += "<td >" + "<input readonly   name='useday'  type=\"text\" onclick='clickDate7()' class='useday'/>" + "</td>";
                                barHtml += "<td >" + "<input  name='batch' type='text'/>" + "</td>";
                                barHtml += "<td >" + rows[i].medicinecode + "</td>";
                                barHtml += "<input name='zhuceNumber' type='hidden' value='" + rows[i].medicinecode + "'>";
                                // "<td >"+"<input readonly id='produceDay"+ b +"'  name='produceDay' onClick=\"return Calendar('produceDay"+ b +"');\" class=\"text_time\" type='text'/>"+ "</td>\n"+
                                barHtml += "<td >" + "<input readonly   name='produceDay'  type=\"text\" onclick='clickproduceDay7()' class='produceDay'/>" + "</td>";
                                barHtml += "<td  >" + "<input  id='goodsCount' name='goodsCount' oninput=\"value=value.replace(/[^\\d]/g,'')\" type='text'    onchange='hejiadd(this.value)' value='" + rows[i].goodsCount + "'/>" + "</td>";
                                barHtml += "<td  style='display: none'>" + "<input  id='allcount' name='allcount' readonly type='text'/>" + "</td>";
                                barHtml += "<td><em  onclick='delertTr(this)'></em></td>";
                                barHtml += "</tr>";
                                if ($("input[name=goodsCode]").length == 0) {
                                    $(".heji7").before(barHtml);
                                    barHtml = "";
                                } else if ($("input[name=goodsCode]").length != 0) {
                                    // alert($("input[name=danjuNumber]").html())
                                    for (var as = 0; as < $("input[name=goodsCode]").length; as++) {
                                        var goodsCode = $("input[name=goodsCode]").eq(as).val();
                                        var useCount = $("input[name=goodsCount]").eq(as).val();
                                        arr[as] = goodsCode;
                                        countarr[as] = useCount;
                                    }
                                    for (var index = 0; index < arr.length; index++) {
                                        // alert(arr[index]+"循环的条码");
                                        // alert(rows[i].producCode+"选中的条码");
                                        if (arr[index] == rows[i].producCode) {
                                            flag = "1";
                                            flags = "修改";
                                            // alert("扫码和原来的一样数量加1");
                                            var count = countarr[index];
                                            $("input[name=goodsCount]").eq(index).val(parseInt(count) + parseInt(1));
                                            barHtml = "";
                                            // break lable;
                                        } else if (arr[index] != rows[i].producCode) {
                                            // alert("新增111");
                                            flag = "0";
                                            flags = "新增";
                                        }
                                    }
                                }
                                if (flags == "新增" && flag == "0") {
                                    // alert("条码没有过新增");
                                    $(".heji7").before(barHtml);
                                    barHtml = "";
                                }
                            }
                        }
                        hejiadd();
                    }
                });
                layer.full(toIndex);
            } else if (goodVal == "耗材") {
                // $(".val8").remove();
                var toIndex = layer.open({
                    type: 2,
                    title: '商品查询',
                    maxmin: true,
                    shadeClose: false, // 点击遮罩关闭层
                    area: ['800px', '520px'],
                    content: "/stock/stock/hc/" + mfrsid + "/" + mfrsname,// iframe的url
                    cancel: function (index, layero) {
                        var rows = window[layero.find('iframe')[0]['name']].showCol();
                        lable:
                        {
                            for (var i = 0; i < rows.length; i++) {

                                barHtml += "<tr class='val8'>";
                                barHtml += "<td style='display: none'>" + rows[i].producNum + "</td>";
                                barHtml += "<input name='goodsNum' type='hidden' value='" + rows[i].producNum + "'>";
                                barHtml += "<td>" + rows[i].viewGoodName+"-型号:"+rows[i].producFactory+"-标价:"+rows[i].retailPrice + "</td>";
                                barHtml += "<input name='goodsName' type='hidden' value='" + rows[i].viewGoodName+"-型号:"+rows[i].producFactory+"-标价:"+rows[i].retailPrice + "'>";
                                barHtml += "<td  >" + rows[i].producFactory + "</td>";
                                barHtml += "<input name='factory' type='hidden' value='" + rows[i].producFactory + "'>";
                                barHtml += "<td style='display: none'>" + rows[i].createTime + "</td>";
                                barHtml += "<input name='createTime' type='hidden' value='" + rows[i].createTime + "'>";
                                barHtml += "<td  >" + rows[i].producCode + "</td>";
                                barHtml += "<input name='goodsCode' type='hidden' value='" + rows[i].producCode + "'>";
                                barHtml += "<td style='display: none' >" + rows[i].retailPrice + "</td>";
                                barHtml += "<input name='retailPrice' type='hidden' value='" + rows[i].retailPrice + "'>";
                                barHtml += "<td style='display: none' >" + rows[i].taxPrice + "</td>";
                                barHtml += "<input name='costPrice' type='hidden' value='" + rows[i].taxPrice + "'>";
                                barHtml += "<td  style='display: none'>" + rows[i].tradePrice + "</td>";
                                barHtml += "<input  name='wholePrice' type='hidden' value='" + rows[i].tradePrice + "'>";
                                barHtml += "<td  style='display: none' >" + rows[i].transferPrice + "</td>";
                                barHtml += "<input name='transferPrice' type='hidden' value='" + rows[i].transferPrice + "'>";
                                barHtml += "<td style='display: none' >" + rows[i].unitname + "</td>";
                                barHtml += "<input name='unit' type='hidden' value='" + rows[i].unitname + "'>";
                                barHtml += "<td  style='display: none'>" + rows[i].brandname + "</td>";
                                barHtml += "<input name='brandname' type='hidden' value='" + rows[i].brandname + "'>";

                                barHtml += "<td  style='display: none'>" + rows[i].classtype + "</td>";
                                barHtml += "<input name='classtype' type='hidden' value='" + rows[i].classtype + "'>";
                                // barHtml += "<td  style='display: none'>" + rows[i].goodsxinxiid + "</td>";
                                // barHtml += "<input name='goodsxinxiid' type='hidden' value='" + rows[i].goodsxinxiid + "'>";

                                // "<td >"+"<input readonly id='useday"+ a +"' name='useday' onClick=\"return Calendar('useday"+ a +"');\" class=\"text_time\" type='text'/>"+ "</td>\n"+
                                barHtml += "<td >" + "<input readonly   name='useday'  type=\"text\" onclick='clickDate8()' class='useday'/>" + "</td>";
                                barHtml += "<td >" + "<input  name='batch' type='text'/>" + "</td>";
                                barHtml += "<td >" + rows[i].medicinecode + "</td>";
                                barHtml += "<input name='zhuceNumber' type='hidden' value='" + rows[i].medicinecode + "'>";
                                // "<td >"+"<input readonly id='produceDay"+ b +"'  name='produceDay' onClick=\"return Calendar('produceDay"+ b +"');\" class=\"text_time\" type='text'/>"+ "</td>\n"+
                                barHtml += "<td >" + "<input readonly   name='produceDay'  type=\"text\" onclick='clickproduceDay8()' class='produceDay'/>" + "</td>";
                                barHtml += "<td  >" + "<input  id='goodsCount' name='goodsCount' oninput=\"value=value.replace(/[^\\d]/g,'')\" type='text'    onchange='hejiadd(this.value)' value='" + rows[i].goodsCount + "'/>" + "</td>";
                                barHtml += "<td  style='display: none'>" + "<input  id='allcount' name='allcount' readonly type='text'/>" + "</td>";
                                barHtml += "<td><em  onclick='delertTr(this)'></em></td>";
                                barHtml += "</tr>";
                                if ($("input[name=goodsCode]").length == 0) {
                                    $(".heji8").before(barHtml);
                                    barHtml = "";
                                } else if ($("input[name=goodsCode]").length != 0) {
                                    // alert($("input[name=danjuNumber]").html())
                                    for (var as = 0; as < $("input[name=goodsCode]").length; as++) {
                                        var goodsCode = $("input[name=goodsCode]").eq(as).val();
                                        var useCount = $("input[name=goodsCount]").eq(as).val();
                                        arr[as] = goodsCode;
                                        countarr[as] = useCount;
                                    }
                                    for (var index = 0; index < arr.length; index++) {
                                        // alert(arr[index]+"循环的条码");
                                        // alert(rows[i].producCode+"选中的条码");
                                        if (arr[index] == rows[i].producCode) {
                                            flag = "1";
                                            flags = "修改";
                                            // alert("扫码和原来的一样数量加1");
                                            var count = countarr[index];
                                            $("input[name=goodsCount]").eq(index).val(parseInt(count) + parseInt(1));
                                            barHtml = "";
                                            // break lable;
                                        } else if (arr[index] != rows[i].producCode) {
                                            // alert("新增111");
                                            flag = "0";
                                            flags = "新增";
                                        }
                                    }
                                }
                                if (flags == "新增" && flag == "0") {
                                    // alert("条码没有过新增");
                                    $(".heji8").before(barHtml);
                                    barHtml = "";
                                }
                            }
                        }
                        hejiadd();
                    }
                });
                layer.full(toIndex);
            } else if (goodVal == "视光") {
                // $(".val9").remove();
                var toIndex = layer.open({
                    type: 2,
                    title: '商品查询',
                    maxmin: true,
                    shadeClose: false, // 点击遮罩关闭层
                    area: ['800px', '520px'],
                    content: "/stock/stock/sg/" + mfrsid + "/" + mfrsname,// iframe的url
                    cancel: function (index, layero) {
                        var rows = window[layero.find('iframe')[0]['name']].showCol();
                        lable:
                        {
                            for (var i = 0; i < rows.length; i++) {

                                barHtml += "<tr class='val9'>";
                                barHtml += "<td style='display: none'>" + rows[i].producNum + "</td>";
                                barHtml += "<input name='goodsNum' type='hidden' value='" + rows[i].producNum + "'>";
                                barHtml += "<td>" + rows[i].viewGoodName+"-型号:"+rows[i].factory+"-标价:"+rows[i].retailPrice+ "</td>";
                                barHtml += "<input name='goodsName' type='hidden' value='" + rows[i].viewGoodName+"-型号:"+rows[i].factory+"-标价:"+rows[i].retailPrice + "'>";
                                barHtml += "<td  >" + rows[i].producFactory + "</td>";
                                barHtml += "<input name='factory' type='hidden' value='" + rows[i].producFactory + "'>";
                                barHtml += "<td style='display: none'>" + rows[i].createTime + "</td>";
                                barHtml += "<input name='createTime' type='hidden' value='" + rows[i].createTime + "'>";
                                barHtml += "<td  >" + rows[i].producCode + "</td>";
                                barHtml += "<input name='goodsCode' type='hidden' value='" + rows[i].producCode + "'>";
                                barHtml += "<td style='display: none' >" + rows[i].retailPrice + "</td>";
                                barHtml += "<input name='retailPrice' type='hidden' value='" + rows[i].retailPrice + "'>";
                                barHtml += "<td style='display: none' >" + rows[i].taxPrice + "</td>";
                                barHtml += "<input name='costPrice' type='hidden' value='" + rows[i].taxPrice + "'>";
                                barHtml += "<td  style='display: none'>" + rows[i].tradePrice + "</td>";
                                barHtml += "<input  name='wholePrice' type='hidden' value='" + rows[i].tradePrice + "'>";
                                barHtml += "<td  style='display: none' >" + rows[i].transferPrice + "</td>";
                                barHtml += "<input name='transferPrice' type='hidden' value='" + rows[i].transferPrice + "'>";
                                barHtml += "<td style='display: none' >" + rows[i].unitname + "</td>";
                                barHtml += "<input name='unit' type='hidden' value='" + rows[i].unitname + "'>";
                                barHtml += "<td style='display: none' >" + rows[i].brandname + "</td>";
                                barHtml += "<input name='brandname' type='hidden' value='" + rows[i].brandname + "'>";

                                barHtml += "<td  style='display: none'>" + rows[i].classtype + "</td>";
                                barHtml += "<input name='classtype' type='hidden' value='" + rows[i].classtype + "'>";
                                // barHtml += "<td  style='display: none'>" + rows[i].goodsxinxiid + "</td>";
                                // barHtml += "<input name='goodsxinxiid' type='hidden' value='" + rows[i].goodsxinxiid + "'>";

                                // "<td >"+"<input readonly id='useday"+ a +"' name='useday' onClick=\"return Calendar('useday"+ a +"');\" class=\"text_time\" type='text'/>"+ "</td>\n"+
                                barHtml += "<td >" + "<input readonly   name='useday'  type=\"text\" onclick='clickDate9()' class='useday'/>" + "</td>";
                                barHtml += "<td >" + "<input  name='batch' type='text'/>" + "</td>";
                                barHtml += "<td >" + rows[i].medicinecode + "</td>";
                                barHtml += "<input name='zhuceNumber' type='hidden' value='" + rows[i].medicinecode + "'>";
                                // "<td >"+"<input readonly id='produceDay"+ b +"'  name='produceDay' onClick=\"return Calendar('produceDay"+ b +"');\" class=\"text_time\" type='text'/>"+ "</td>\n"+
                                barHtml += "<td >" + "<input readonly   name='produceDay'  type=\"text\" onclick='clickproduceDay9()' class='produceDay'/>" + "</td>";
                                barHtml += "<td  >" + "<input  id='goodsCount' name='goodsCount' oninput=\"value=value.replace(/[^\\d]/g,'')\" type='text'    onchange='hejiadd(this.value)' value='" + rows[i].goodsCount + "'/>" + "</td>";
                                barHtml += "<td  style='display: none'>" + "<input  id='allcount' name='allcount' readonly type='text'/>" + "</td>";
                                barHtml += "<td><em  onclick='delertTr(this)'></em></td>";
                                barHtml += "</tr>";
                                if ($("input[name=goodsCode]").length == 0) {
                                    $(".heji9").before(barHtml);
                                    barHtml = "";
                                } else if ($("input[name=goodsCode]").length != 0) {
                                    // alert($("input[name=danjuNumber]").html())
                                    for (var as = 0; as < $("input[name=goodsCode]").length; as++) {
                                        var goodsCode = $("input[name=goodsCode]").eq(as).val();
                                        var useCount = $("input[name=goodsCount]").eq(as).val();
                                        arr[as] = goodsCode;
                                        countarr[as] = useCount;
                                    }
                                    for (var index = 0; index < arr.length; index++) {
                                        // alert(arr[index]+"循环的条码");
                                        // alert(rows[i].producCode+"选中的条码");
                                        if (arr[index] == rows[i].producCode) {
                                            flag = "1";
                                            flags = "修改";
                                            // alert("扫码和原来的一样数量加1");
                                            var count = countarr[index];
                                            $("input[name=goodsCount]").eq(index).val(parseInt(count) + parseInt(1));
                                            barHtml = "";
                                            // break lable;
                                        } else if (arr[index] != rows[i].producCode) {
                                            // alert("新增111");
                                            flag = "0";
                                            flags = "新增";
                                        }
                                    }
                                }
                                if (flags == "新增" && flag == "0") {
                                    // alert("条码没有过新增");
                                    $(".heji9").before(barHtml);
                                    barHtml = "";
                                }
                            }
                        }
                        hejiadd();
                    }
                });
                layer.full(toIndex);
            }
        }




        function hejiadd(object) {
            addcount=0;
            var size=$("input[name='goodsCount']").length;
            // alert(size+"数量");
            if (size!=0){
                $("input[name='goodsCount']").each(
                    function(){
                        var goodsCount=$(this).val();
                        addcount +=Number(goodsCount);
                        $("input[name='allcount']").val(addcount);
                        $("input[name='newcount']").val(addcount);
                        // alert(addcount)
                    }
                )
            }else if (size==0){
                $("input[name='allcount']").val(addcount);
                $("input[name='newcount']").val(addcount);
            }

        }


        function delertTr(obj) {
            var x;
            var r=confirm("是否删除该的商品!");
            if (r==true){
                x="确定";
            }
            else{
                x="取消";
            }
            if(x=="确定"){
                var tr=obj.parentNode.parentNode;//得到按钮[obj]的父元素[td]的父元素[tr]
                tr.parentNode.removeChild(tr);//从tr的父元素[tbody]移除tr
                arr = new Array();
            }
            hejiadd();
        }

        $("body").on("dblclick","input[name=goodsCount]",function(){

            var x;
            var r=confirm("是否向下复制数量!");
            if (r==true){
                x="确定";
            }
            else{
                x="取消";
            }
            if(x=="确定"){
                var index = $("input[name=goodsCount]").index($(this));
                for (var i = index; i < $("input[name=goodsCount]").length; i++) {
                    $("input[name=goodsCount]").eq(i).val($(this).val())
                }
                hejiadd();
            }

        })



        function clickDate1(){
            //日期
            lay('.useday').each(function () {
                laydate.render({
                    elem: this,
                    type: 'date',
                    trigger: 'click',	  // 事件类型
                    done: function (value, date, endDate) {
                        var data_val = $(this)[0].elem[0].parentElement.parentNode.children[11].innerText.slice(0, 18)
                        if (value == "") {
                            console.log(123);
                            $(this)[0].elem[0].parentElement.parentNode.children[11].innerText = data_val + "00000000"
                            $(this)[0].elem[0].parentElement.parentNode.children[12].value = data_val + "00000000"
                            console.log($(this)[0].elem[0].parentElement.parentNode.children[12]);
                            // $('#goodsCode').val(data_val + "00000000")
                        } else {
                            $(this)[0].elem[0].parentElement.parentNode.children[11].innerText = data_val + value.replace("-", "").replace("-", "")
                            $(this)[0].elem[0].parentElement.parentNode.children[12].value = data_val + value.replace("-", "").replace("-", "")
                            console.log($(this)[0].elem[0].parentElement.parentNode.children[12]);
                            // $('#goodsCode').val(data_val + value.replace("-", "").replace("-", ""))
                        }
                        $(this).focus();

                    }
                });

            });
        }
        function clickproduceDay1(){
            lay('.produceDay').each(function () {
                //日期
                laydate.render({
                    elem: this,
                    type: 'date'
                });
            });

        }

        function clickDate2(){
            //日期
            lay('.useday').each(function () {
                laydate.render({
                    elem: this,
                    type: 'date',
                    trigger: 'click',	  // 事件类型
                    done: function (value, date, endDate) {
                        var data_val = $(this)[0].elem[0].parentElement.parentNode.children[9].innerText.slice(0, 18)
                        if (value == "") {
                            console.log(123);
                            $(this)[0].elem[0].parentElement.parentNode.children[9].innerText = data_val + "00000000"
                            $(this)[0].elem[0].parentElement.parentNode.children[10].value = data_val + "00000000"
                            console.log($(this)[0].elem[0].parentElement.parentNode.children[10]);
                            // $('#goodsCode').val(data_val + "00000000")
                        } else {
                            $(this)[0].elem[0].parentElement.parentNode.children[9].innerText = data_val + value.replace("-", "").replace("-", "")
                            $(this)[0].elem[0].parentElement.parentNode.children[10].value = data_val + value.replace("-", "").replace("-", "")
                            console.log($(this)[0].elem[0].parentElement.parentNode.children[10]);
                            // $('#goodsCode').val(data_val + value.replace("-", "").replace("-", ""))
                        }
                        $(this).focus();

                    }
                });

            });
        }
        function clickproduceDay2(){
            lay('.produceDay').each(function () {
                //日期
                laydate.render({
                    elem: this,
                    type: 'date'
                });
            });

        }

        function clickDate3(){
            //日期
            lay('.useday').each(function () {
                laydate.render({
                    elem: this,
                    type: 'date',
                    trigger: 'click',	  // 事件类型
                    done: function (value, date, endDate) {
                        var data_val = $(this)[0].elem[0].parentElement.parentNode.children[14].innerText.slice(0, 18)
                        if (value == "") {
                            console.log(123);
                            $(this)[0].elem[0].parentElement.parentNode.children[14].innerText = data_val + "00000000"
                            $(this)[0].elem[0].parentElement.parentNode.children[15].value = data_val + "00000000"
                            console.log($(this)[0].elem[0].parentElement.parentNode.children[15]);
                            // $('#goodsCode').val(data_val + "00000000")
                        } else {
                            $(this)[0].elem[0].parentElement.parentNode.children[14].innerText = data_val + value.replace("-", "").replace("-", "")
                            $(this)[0].elem[0].parentElement.parentNode.children[15].value = data_val + value.replace("-", "").replace("-", "")
                            console.log($(this)[0].elem[0].parentElement.parentNode.children[15]);
                            // $('#goodsCode').val(data_val + value.replace("-", "").replace("-", ""))
                        }
                        $(this).focus();

                    }
                });

            });
        }
        function clickproduceDay3(){
            lay('.produceDay').each(function () {
                //日期
                laydate.render({
                    elem: this,
                    type: 'date'
                });
            });

        }

        function clickDate4(){
            //日期
            lay('.useday').each(function () {
                laydate.render({
                    elem: this,
                    type: 'date',
                    trigger: 'click',	  // 事件类型
                    done: function (value, date, endDate) {
                        var data_val = $(this)[0].elem[0].parentElement.parentNode.children[14].innerText.slice(0, 18)
                        if (value == "") {
                            console.log(123);
                            $(this)[0].elem[0].parentElement.parentNode.children[14].innerText = data_val + "00000000"
                            $(this)[0].elem[0].parentElement.parentNode.children[15].value = data_val + "00000000"
                            console.log($(this)[0].elem[0].parentElement.parentNode.children[15]);
                            // $('#goodsCode').val(data_val + "00000000")
                        } else {
                            $(this)[0].elem[0].parentElement.parentNode.children[14].innerText = data_val + value.replace("-", "").replace("-", "")
                            $(this)[0].elem[0].parentElement.parentNode.children[15].value = data_val + value.replace("-", "").replace("-", "")
                            console.log($(this)[0].elem[0].parentElement.parentNode.children[15]);
                            // $('#goodsCode').val(data_val + value.replace("-", "").replace("-", ""))
                        }
                        $(this).focus();

                    }
                });

            });
        }
        function clickproduceDay4(){
            lay('.produceDay').each(function () {
                //日期
                laydate.render({
                    elem: this,
                    type: 'date'
                });
            });

        }

        function clickDate5(){
            //日期
            lay('.useday').each(function () {
                laydate.render({
                    elem: this,
                    type: 'date',
                    trigger: 'click',	  // 事件类型
                    done: function (value, date, endDate) {
                        var data_val = $(this)[0].elem[0].parentElement.parentNode.children[10].innerText.slice(0, 18)
                        if (value == "") {
                            console.log(123);
                            $(this)[0].elem[0].parentElement.parentNode.children[10].innerText = data_val + "00000000"
                            $(this)[0].elem[0].parentElement.parentNode.children[11].value = data_val + "00000000"
                            console.log($(this)[0].elem[0].parentElement.parentNode.children[11]);
                            // $('#goodsCode').val(data_val + "00000000")
                        } else {
                            $(this)[0].elem[0].parentElement.parentNode.children[10].innerText = data_val + value.replace("-", "").replace("-", "")
                            $(this)[0].elem[0].parentElement.parentNode.children[11].value = data_val + value.replace("-", "").replace("-", "")
                            console.log($(this)[0].elem[0].parentElement.parentNode.children[11]);
                            // $('#goodsCode').val(data_val + value.replace("-", "").replace("-", ""))
                        }
                        $(this).focus();

                    }
                });

            });
        }
        function clickproduceDay5(){
            lay('.produceDay').each(function () {
                //日期
                laydate.render({
                    elem: this,
                    type: 'date'
                });
            });

        }

        function clickDate6(){
            //日期
            lay('.useday').each(function () {
                laydate.render({
                    elem: this,
                    type: 'date',
                    trigger: 'click',	  // 事件类型
                    done: function (value, date, endDate) {
                        var data_val = $(this)[0].elem[0].parentElement.parentNode.children[10].innerText.slice(0, 18)
                        if (value == "") {
                            console.log(123);
                            $(this)[0].elem[0].parentElement.parentNode.children[10].innerText = data_val + "00000000"
                            $(this)[0].elem[0].parentElement.parentNode.children[11].value = data_val + "00000000"
                            console.log($(this)[0].elem[0].parentElement.parentNode.children[11]);
                            // $('#goodsCode').val(data_val + "00000000")
                        } else {
                            $(this)[0].elem[0].parentElement.parentNode.children[10].innerText = data_val + value.replace("-", "").replace("-", "")
                            $(this)[0].elem[0].parentElement.parentNode.children[11].value = data_val + value.replace("-", "").replace("-", "")
                            console.log($(this)[0].elem[0].parentElement.parentNode.children[11]);
                            // $('#goodsCode').val(data_val + value.replace("-", "").replace("-", ""))
                        }
                        $(this).focus();

                    }
                });

            });
        }
        function clickproduceDay6(){
            lay('.produceDay').each(function () {
                //日期
                laydate.render({
                    elem: this,
                    type: 'date'
                });
            });

        }

        function clickDate7(){
            //日期
            lay('.useday').each(function () {
                laydate.render({
                    elem: this,
                    type: 'date',
                    trigger: 'click',	  // 事件类型
                    done: function (value, date, endDate) {
                        var data_val = $(this)[0].elem[0].parentElement.parentNode.children[11].innerText.slice(0, 18)
                        if (value == "") {
                            console.log(123);
                            $(this)[0].elem[0].parentElement.parentNode.children[11].innerText = data_val + "00000000"
                            $(this)[0].elem[0].parentElement.parentNode.children[12].value = data_val + "00000000"
                            console.log($(this)[0].elem[0].parentElement.parentNode.children[12]);
                            // $('#goodsCode').val(data_val + "00000000")
                        } else {
                            $(this)[0].elem[0].parentElement.parentNode.children[11].innerText = data_val + value.replace("-", "").replace("-", "")
                            $(this)[0].elem[0].parentElement.parentNode.children[12].value = data_val + value.replace("-", "").replace("-", "")
                            console.log($(this)[0].elem[0].parentElement.parentNode.children[12]);
                            // $('#goodsCode').val(data_val + value.replace("-", "").replace("-", ""))
                        }
                        $(this).focus();

                    }
                });

            });
        }
        function clickproduceDay7(){
            lay('.produceDay').each(function () {
                //日期
                laydate.render({
                    elem: this,
                    type: 'date'
                });
            });

        }

        function clickDate8(){
            //日期
            lay('.useday').each(function () {
                laydate.render({
                    elem: this,
                    type: 'date',
                    trigger: 'click',	  // 事件类型
                    done: function (value, date, endDate) {
                        var data_val = $(this)[0].elem[0].parentElement.parentNode.children[8].innerText.slice(0, 18)
                        if (value == "") {
                            console.log(123);
                            $(this)[0].elem[0].parentElement.parentNode.children[8].innerText = data_val + "00000000"
                            $(this)[0].elem[0].parentElement.parentNode.children[9].value = data_val + "00000000"
                            console.log($(this)[0].elem[0].parentElement.parentNode.children[9]);
                            // $('#goodsCode').val(data_val + "00000000")
                        } else {
                            $(this)[0].elem[0].parentElement.parentNode.children[8].innerText = data_val + value.replace("-", "").replace("-", "")
                            $(this)[0].elem[0].parentElement.parentNode.children[9].value = data_val + value.replace("-", "").replace("-", "")
                            console.log($(this)[0].elem[0].parentElement.parentNode.children[9]);
                            // $('#goodsCode').val(data_val + value.replace("-", "").replace("-", ""))
                        }
                        $(this).focus();

                    }
                });

            });
        }
        function clickproduceDay8(){
            lay('.produceDay').each(function () {
                //日期
                laydate.render({
                    elem: this,
                    type: 'date'
                });
            });

        }

        function clickDate9(){
            //日期
            lay('.useday').each(function () {
                laydate.render({
                    elem: this,
                    type: 'date',
                    trigger: 'click',	  // 事件类型
                    done: function (value, date, endDate) {
                        var data_val = $(this)[0].elem[0].parentElement.parentNode.children[8].innerText.slice(0, 18)
                        if (value == "") {
                            console.log(123);
                            $(this)[0].elem[0].parentElement.parentNode.children[8].innerText = data_val + "00000000"
                            $(this)[0].elem[0].parentElement.parentNode.children[9].value = data_val + "00000000"
                            console.log($(this)[0].elem[0].parentElement.parentNode.children[9]);
                            // $('#goodsCode').val(data_val + "00000000")
                        } else {
                            $(this)[0].elem[0].parentElement.parentNode.children[8].innerText = data_val + value.replace("-", "").replace("-", "")
                            $(this)[0].elem[0].parentElement.parentNode.children[9].value = data_val + value.replace("-", "").replace("-", "")
                            console.log($(this)[0].elem[0].parentElement.parentNode.children[9]);
                            // $('#goodsCode').val(data_val + value.replace("-", "").replace("-", ""))
                        }
                        $(this).focus();

                    }
                });

            });
        }
        function clickproduceDay9(){
            lay('.produceDay').each(function () {
                //日期
                laydate.render({
                    elem: this,
                    type: 'date'
                });
            });

        }


    </script>
</body>

</html>