<!doctype html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="keywords" content="" />
	<meta name="description" content="" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
	<title>商品退货单新增</title>
	<link rel="stylesheet" href="/css/css.css" type="text/css">
</head>
<body>
<div class="new_h3">商品退货单新增</div>

<!--检查条件-->
<div class="m40 tabS PHGL">
	<h3>单据信息</h3>
	<table border="0" cellspacing="0" cellpadding="0">
		<tr>
			<td>单据编号：</td>
			<td><input id="tuihuoNum" name="tuihuoNum" th:value="${uuidstr}" type="text" readonly style="width: 49%"></td>
			<td>制单人：</td>
			<td>
				<input id="zhidanPeople" name="zhidanPeople" th:value="${zhidanPeople}" readonly type="text" style="width: 49%"/>
			</td>
			<td>单据日期：</td>
			<td>
				<input id="danjuDay" name="danjuDay" th:value="${danjuDay}" type="text" readonly style="width: 49%"/>
			</td>
		</tr>
		<tr>
			<td>制造商：</td>
			<td>
				<input id="mfrsid" name="mfrsid" type="hidden" style="width: 49%"/>
				<input id="mfrsName" name="mfrsName" type="text" readonly style="width:49%"/>
				<input id="goodsids" name="goodsids" value="0" type="hidden"/>

				<input type="button" class="XZ-btn" value="选择" onclick="getZhizaoshang()" />
			</td>
			<td>供应商：</td>
			<td>
				<input id="msname" name="mfrsname" type="text" readonly style="width: 49%"/>

			</td>
			<td>发出仓位：</td>
			<td>
				<select id="positionId" name="positionId" style="width:49%">
					<option th:each="ls:${outPositiion}"
							th:text="${ls.positionName}"
							th:value="${ls.positionId}"
					></option>
				</select>
			</td>

		</tr>
		<tr>
			<td>备注：</td>
			<td colspan="5"><textarea id="beizhu" name="beizhu" rows="3"></textarea></td>
		</tr>
		</tbody>
	</table>

	<div class="HH_btns">
		<div class="Xbtn">
			<input type="button" value="单品添加商品" onclick="getGood()" />
			<input class="HgreenBG" type="button" value="条码扫描" />
		</div>
		<div class="Cbtn buyBtns">
			<input type="button" class="H_bc" value="保存并审核" />
			<!--<input type="checkbox" id="Hbc" /> <label for="Hbc">保存并审核</label>-->
		</div>
	</div>

</div>

<!--商品信息-->
<div class="m40 tabS SPmsg">
	<h3>商品信息</h3>
	<table border="0" cellspacing="0" cellpadding="0" class="buyBtns">
		<tbody>
		<tr class="thead">
			<td>多选</td>
			<td>商品代码</td>
			<td>商品名称</td>
			<td>型号</td>
			<td>计量单位</td>
			<td>可用库存</td>
			<td>数量</td>
			<td>商品条码</td>
		</tr>
		<tr>
			<td><input type="checkbox" /></td>
			<td>123569875425</td>
			<td>名称名称每次</td>
			<td>SD90</td>
			<td>148</td>
			<td>148</td>
			<td>148</td>
			<td>148</td>
		</tr>

		</tbody>
	</table>
	<div class="Cbtn buyBtns">
		<input type="button" class="H_bc" value="保存并审核" />
		<!--<input type="checkbox" id="HHbc" /> <label for="HHbc">保存并审核</label>-->
	</div>
</div>

<div th:include="include::footer"></div>
<script type="text/javascript" src="/js/appjs/stock/tuihuo/findmfrs.js"></script>
<script type="text/javascript" src="/js/appjs/stock/tuihuo/add.js"></script>
<script type="text/javascript">
    // <!--单品添加商品-->
    function getGood() {
        var mfrsid = $('#mfrsid').val();
        var mfrsName = $('#mfrsName').val();
        var positionId = $('#positionId').val();
        var positionName = $('#positionId').find("option:selected").text();
        if (mfrsid == "") {
            layer.alert("请选择制造商！");
        } else if (mfrsName == "") {
            layer.alert("请选择制造商！");
        }else if (positionId == ""){
            layer.alert("请选择发出仓位！");
        } else {
            // $(".val").remove();
            var toIndex = layer.open({
                type: 2,
                title: '库存查询',
                maxmin: true,
                shadeClose: false, // 点击遮罩关闭层
                area: ['800px', '520px'],
                content: "/stock/tuihuo/getGood/"+ positionId +"/" + positionName +"/"+ mfrsid +"/"+mfrsName,// iframe的url
                cancel: function (index, layero) {
                    var rows = window[layero.find('iframe')[0]['name']].showCol();
                    for (var i = 0; i < rows.length; i++) {
                        // alert( rows[i].goodsid);

                        $(".liebiao").after("<tr class='val'> " +
                            // "<td><input name='one'  type=\"checkbox\"/></td>\n" +
                            "<td name='goodsNum'>" + rows[i].goodsNum + "</td>\n" +
                            "<input name='goodsNum' type='hidden' value='" + rows[i].goodsNum + "'>\n" +
                            "<td name='goodsName'>" + rows[i].goodsName + "</td>\n" +
                            "<input name='goodsName' type='hidden' value='" + rows[i].goodsName + "'>\n" +
                            "<td name='factory'>" + rows[i].factory + "</td>\n" +
                            "<input name='factory' type='hidden' value='" + rows[i].factory + "'>\n" +
                            // "<td name='needCount'>" + rows[i].needCount + "</td>\n" +
                            "<td name='goodsCount'>" + rows[i].goodsCount + "</td>\n" +
                            "<input name='goodsCount' type='hidden' value='" + rows[i].goodsCount + "'>\n" +
                            "<td >" + "<input name='useCount' oninput=\"value=value.replace(/[^\\d]/g,'')\" type='text'/>" + "</td>" +
                            "<td name='goodsCode'>" + rows[i].goodsCode + "</td>\n" +
                            "<input name='goodsCode' type='hidden' value='" + rows[i].goodsCode + "'>\n" +
                            "<td name='useday'>" + rows[i].useday + "</td>\n" +
                            "<input name='useday' type='hidden' value='" + rows[i].useday + "'>\n" +
                            "<td name='batch'>" + rows[i].batch + "</td>\n" +
                            "<input name='batch' type='hidden' value='" + rows[i].batch + "'>\n" +
                            "<td name='zhuceNumber'>" + rows[i].zhuceNumber + "</td>\n" +
                            "<input name='zhuceNumber' type='hidden' value='" + rows[i].zhuceNumber + "'>\n" +
                            "<td name='produceDay'>" + rows[i].produceDay + "</td>\n" +
                            "<input name='produceDay' type='hidden' value='" + rows[i].produceDay + "'>\n" +


                            "<td name='classtype' style='display: none'>" + rows[i].classtype + "</td>\n" +
                            "<input name='classtype' type='hidden' value='" + rows[i].classtype + "'>\n" +
                            "<td name='goodsid' style='display: none'>" + rows[i].goodsid + "</td>\n" +
                            "<input name='goods' type='hidden' value='" + rows[i].goodsid + "'>\n" +

                            "<td name='mfrsid' style='display: none'>" + rows[i].mfrsid + "</td>\n" +
                            "<input name='mfrsid' type='hidden' value='" + rows[i].mfrsid + "'>\n" +
                            "<td name='brandname' style='display: none'>" + rows[i].brandname + "</td>\n" +
                            "<input name='brandname' type='hidden' value='" + rows[i].brandname + "'>\n" +
                            "<td name='unit' style='display: none'>" + rows[i].unit + "</td>\n" +
                            "<input name='unit' type='hidden' value='" + rows[i].unit + "'>\n" +

                            "<td name='money' style='display: none'>" + rows[i].retailPrice + "</td>\n" +
                            "<input name='money' type='hidden' value='" + rows[i].retailPrice + "'>\n" +

                            "<td name='goodsxinxiid' style='display: none'>" + rows[i].goodsxinxiid + "</td>\n" +
                            "<input name='goodsxinxiid' type='hidden' value='" + rows[i].goodsxinxiid + "'>\n" +


                            "</tr>");
                    }
                }
            });
            layer.full(toIndex)
        }
    }
</script>
</body>
</html>
